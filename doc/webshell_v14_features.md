# WebShell v14 特性说明

## 1. 基础架构

### 1.1 命名空间和类结构
- 使用随机生成的三层命名空间
- 主类使用随机生成的类名
- 方法名使用随机生成的小写字母组合

### 1.2 文件结构
- 主WebShell文件
- 伪装的缓存管理器类文件
- 使用include_once包含伪装文件

## 2. 安全特性

### 2.1 请求验证
- 仅允许POST请求方法
- 返回标准405错误页面（Method Not Allowed）
- Content-Type设置为text/html

### 2.2 User-Agent检查
- 验证是否包含常见浏览器标识
  - Mozilla
  - Chrome
  - Safari
- 不符合条件返回404错误页面

### 2.3 时间控制
- 执行时间限制（30秒）

## 3. 代码特性

### 3.1 错误处理
- 禁用错误显示
- 标准HTTP错误响应
- 美化的错误页面

### 3.2 命令执行
- 使用exec函数执行命令
- 捕获标准输出和错误输出
- 返回合并后的输出结果

### 3.3 数据加密
- 多层加密处理
  - ROT13编码
  - Base64编码
  - XOR加密
- 随机密钥生成

### 3.4 类方法
- __construct：初始化对象和时间戳
- __destruct：清理数据
- __wakeup：重置时间戳
- getInstance：单例模式实现
- checkExecutionTime：执行时间验证

## 4. 伪装特性

### 4.1 缓存管理器
- 模拟正常的缓存类
- 实现基本的缓存操作
- 单例模式实现

### 4.2 垃圾代码
- 随机变量名生成
- 随机字符串赋值
- 保持代码结构自然

## 5. 使用方法

### 5.1 基本调用
```bash
curl -X POST http://your-domain/webshell.php -d "qaxniubi=command" -A "Mozilla/5.0"
```

### 5.2 注意事项
- 必须使用POST方法
- 需要正确的User-Agent
- 只在工作时间内可用
- 命令执行时间不能超过30秒 